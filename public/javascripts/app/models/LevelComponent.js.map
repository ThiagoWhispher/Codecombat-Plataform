{"version":3,"sources":["app/models/LevelComponent.coffee"],"names":[],"mappings":";AAAA;EAAA;;;;AAAA,YAAY,QAAQ,aAAR;;AAEZ,MAAM,CAAC,OAAP,GAAuB;;;;;;;EACrB,cAAC,UAAD,GAAY;;EACZ,cAAC,OAAD,GAAS,QAAQ,gCAAR;;EAET,cAAC,SAAD,GAAW;;EACX,cAAC,OAAD,GAAS;;EACT,cAAC,UAAD,GAAY;;EACZ,cAAC,WAAD,GAAa;;EACb,cAAC,SAAD,GAAW;;EACX,cAAC,OAAD,GAAS;;EACT,cAAC,WAAD,GAAa;;EACb,cAAC,QAAD,GAAU;;EACV,cAAC,eAAD,GAAiB;;EACjB,cAAC,QAAD,GAAU;;EACV,cAAC,UAAD,GAAY;;EACZ,cAAC,aAAD,GAAe;;EACf,cAAC,aAAD,GAAe;;2BACf,UAAS;;2BACT,qBAAoB;;2BAEpB,MAAK,SAAC,GAAD,EAAM,GAAN,EAAW,OAAX;AACH;IAAA,IAAG,CAAC,CAAC,QAAF,CAAW,GAAX,CAAH;MACE,MAAmB,CAAC,GAAD,EAAM,GAAN,CAAnB,EAAC,cAAD,EAAQ,iBADV;KAAA;MAGE,CAAC,QAAQ,EAAT,CAAa,KAAb,GAAoB,IAHtB;;IAIA,IAAG,UAAU,KAAV,IAAoB,CAAI,CAAC,QAAQ,KAAT,CAA3B;MACE,KAAK,CAAC,EAAN,GAAW,IAAC,QAAD,CAAS,KAAK,CAAC,IAAf,EADb;;WAEA,wCAAM,KAAN,EAAa,OAAb;EAPG;;2BASL,WAAU;IACR;IACA,KAAwC,IAAC,IAAD,CAAK,IAAL,CAAxC;aAAA,IAAC,IAAD,CAAK,IAAL,EAAW,IAAC,QAAD,CAAS,IAAC,IAAD,CAAK,MAAL,CAAT,CAAX;;EAFQ;;2BAIV,UAAS,SAAC,IAAD;AACP;IAAA,IAAG,IAAC,IAAD,CAAK,cAAL,KAAyB,IAAC,IAAD,CAAK,cAAL,MAA0B,cAAtD;AACE,aAAO,OAAO,CAAC,KAAR,CAAc,gBAAd,EAAgC,IAAC,IAAD,CAAK,cAAL,CAAhC,EAAsD,uBAAtD,EAA+E,IAA/E,EADT;;AAEA;MACE,KAAK,YAAY,CAAC,OAAb,CAAqB,IAArB,EAA2B;QAAA,MAAM,IAAN;OAA3B,EADP;KAAA;MAEM;MAEJ,KAAK,IAAC,IAAD,CAAK,IAAL,EAJP;;WAKA;EARO;;2BAUT,kBAAiB,SAAC,aAAD;AACf;IAAA,UAAU;AACV;AAAA;;MACE,OAAO,CAAC,CAAC,IAAF,CAAO,aAAP,EAAsB,SAAC,CAAD;eAC3B,CAAC,CAAC,GAAF,CAAM,UAAN,MAAqB,GAAG,CAAC,QAAzB,IAAsC,CAAC,CAAC,GAAF,CAAM,SAAN,CAAgB,CAAC,KAAjB,KAA0B,GAAG,CAAC;MADzC,CAAtB;AAEP;AAAA;;QACE,IAA2B,aAAU,OAAV,aAA3B;UAAA,OAAO,CAAC,IAAR,CAAa,MAAb;;AADF;AAHF;WAKA;EAPe;;;;GA3C2B","file":"public/javascripts/app/models/LevelComponent.js","sourcesContent":["CocoModel = require './CocoModel'\r\n\r\nmodule.exports = class LevelComponent extends CocoModel\r\n  @className: 'LevelComponent'\r\n  @schema: require 'schemas/models/level_component'\r\n\r\n  @EquipsID: '53e217d253457600003e3ebb'\r\n  @ItemID: '53e12043b82921000051cdf9'\r\n  @AttacksID: '524b7ba57fc0f6d519000016'\r\n  @PhysicalID: '524b75ad7fc0f6d519000001'\r\n  @ExistsID: '524b4150ff92f1f4f8000024'\r\n  @LandID: '524b7aff7fc0f6d519000006'\r\n  @CollidesID: '524b7b857fc0f6d519000012'\r\n  @PlansID: '524b7b517fc0f6d51900000d'\r\n  @ProgrammableID: '524b7b5a7fc0f6d51900000e'\r\n  @MovesID: '524b7b8c7fc0f6d519000013'\r\n  @MissileID: '524cc2593ea855e0ab000142'\r\n  @FindsPathsID: '52872b0ead92b98561000002'\r\n  @AttackableID: '524b7bab7fc0f6d519000017'\r\n  urlRoot: '/db/level.component'\r\n  editableByArtisans: true\r\n\r\n  set: (key, val, options) ->\r\n    if _.isObject key\r\n      [attrs, options] = [key, val]\r\n    else\r\n      (attrs = {})[key] = val\r\n    if 'code' of attrs and not ('js' of attrs)\r\n      attrs.js = @compile attrs.code\r\n    super attrs, options\r\n\r\n  onLoaded: ->\r\n    super()\r\n    @set 'js', @compile(@get 'code') unless @get 'js'\r\n\r\n  compile: (code) ->\r\n    if @get('codeLanguage') and @get('codeLanguage') isnt 'coffeescript'\r\n      return console.error('Can\\'t compile', @get('codeLanguage'), '-- only CoffeeScript.', @)\r\n    try\r\n      js = CoffeeScript.compile(code, bare: true)\r\n    catch e\r\n      #console.log 'couldn\\'t compile', code, 'for', @get('name'), 'because', e\r\n      js = @get 'js'\r\n    js\r\n\r\n  getDependencies: (allComponents) ->\r\n    results = []\r\n    for dep in @get('dependencies') or []\r\n      comp = _.find allComponents, (c) ->\r\n        c.get('original') is dep.original and c.get('version').major is dep.majorVersion\r\n      for result in comp.getDependencies(allComponents).concat [comp]\r\n        results.push result unless result in results\r\n    results\r\n"]}