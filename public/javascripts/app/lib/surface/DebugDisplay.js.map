{"version":3,"sources":["app/lib/surface/DebugDisplay.coffee"],"names":[],"mappings":";AAAA;EAAA;;;AAAA,MAAM,CAAC,OAAP,GAAuB;;;yBACrB,gBAAe;;yBACf,gBACE;IAAA,mBAAmB,YAAnB;;;EAEW,sBAAC,OAAD;AACX;IAAA;IACA,IAAC,WAAD;IACA,IAAC,YAAD,GAAe,OAAO,CAAC;IACvB,IAAC,aAAD,GAAgB,OAAO,CAAC;IACxB,MAA8D,IAAC,YAAD,IAAiB,IAAC,aAAhF;MAAA,OAAO,CAAC,KAAR,CAAc,wCAAd;;IACA,IAAC,MAAD;IACA,IAAC,WAAD,CAAY;MAAA,OAAO,IAAP;KAAZ;AACA;AAAA;;MAAA,QAAQ,CAAC,QAAQ,CAAC,SAAlB,CAA4B,OAA5B,EAAqC,IAAE,MAAvC,EAA8C,IAA9C;AAAA;EARW;;yBAUb,UAAS;AACP;AAAA;AAAA;SAAA;;mBAAA,QAAQ,CAAC,QAAQ,CAAC,WAAlB,CAA8B,OAA9B,EAAuC,IAAE,MAAzC,EAAgD,IAAhD;AAAA;;EADO;;yBAGT,aAAY,SAAC,CAAD;IACV,IAAU,CAAC,CAAC,KAAF,KAAW,IAAC,GAAtB;AAAA;;IACA,IAAC,QAAD,GAAW,IAAC,GAAD,GAAM,CAAC,CAAC;IACnB,IAAC,IAAD,GAAO;IACP,IAAC,yBAAD,GAA4B;WAC5B,IAAC,qBAAD,GAAwB,IAAI,CAAC,GAAL;EALd;;yBAOZ,QAAO;IACL,IAAC,aAAD,GAAgB,IAAC,cAAD,GAAiB;IACjC,IAAC,SAAD,CAAU,IAAC,UAAD,GAAiB,YAAQ,CAAC,IAAT,CAAc,KAAd,EAAqB,YAArB,EAAmC,MAAnC,CAA3B;IACA,IAAC,UAAS,CAAC,IAAX,GAAkB;IAClB,IAAC,UAAS,CAAC,CAAX,GAAe,IAAC,YAAD,GAAe;IAC9B,IAAC,UAAS,CAAC,CAAX,GAAe,IAAC,aAAD,GAAgB;WAC/B,IAAC,UAAS,CAAC,KAAX,GAAmB;EANd;;yBAQP,cAAa,SAAC,YAAD;AACX;IAAA,KAAc,IAAC,GAAf;AAAA;;IACA,EAAE,IAAC;IACH,OAAO,IAAI,CAAC,GAAL;IACP,OAAO,CAAC,OAAO,IAAC,qBAAT,IAAiC;IACxC,IAAG,OAAO,CAAV;MACE,IAAC,IAAD,GAAO,IAAI,CAAC,KAAL,CAAW,IAAC,yBAAD,GAA4B,IAAvC;MACP,IAAC,qBAAD,GAAwB;MACxB,IAAC,yBAAD,GAA4B,EAH9B;;IAKA,IAAC,UAAS,CAAC,IAAX,GAAkB,IAAI,CAAC,KAAL,CAAW,YAAX,IAA2B,CAAI,gBAAH,GAAc,QAAQ,IAAC,IAAT,GAAe,MAA7B,GAAyC,EAA1C;WAC7C,IAAC,UAAS,CAAC,CAAX,GAAe,IAAC,YAAD,GAAe,IAAC,UAAS,CAAC,gBAAX,EAAf,GAA+C;EAXnD;;;;GAjC6B,QAAQ,CAAC","file":"public/javascripts/app/lib/surface/DebugDisplay.js","sourcesContent":["module.exports = class DebugDisplay extends createjs.Container\r\n  layerPriority: 20\r\n  subscriptions:\r\n    'level:set-debug': 'onSetDebug'\r\n\r\n  constructor: (options) ->\r\n    super()\r\n    @initialize()\r\n    @canvasWidth = options.canvasWidth\r\n    @canvasHeight = options.canvasHeight\r\n    console.error 'DebugDisplay needs canvasWidth/Height.' unless @canvasWidth and @canvasHeight\r\n    @build()\r\n    @onSetDebug debug: true\r\n    Backbone.Mediator.subscribe(channel, @[func], @) for channel, func of @subscriptions\r\n\r\n  destroy: ->\r\n    Backbone.Mediator.unsubscribe(channel, @[func], @) for channel, func of @subscriptions\r\n\r\n  onSetDebug: (e) ->\r\n    return if e.debug is @on\r\n    @visible = @on = e.debug\r\n    @fps = null\r\n    @framesRenderedThisSecond = 0\r\n    @lastFrameSecondStart = Date.now()\r\n\r\n  build: ->\r\n    @mouseEnabled = @mouseChildren = false\r\n    @addChild @frameText = new createjs.Text '...', '20px Arial', '#FFF'\r\n    @frameText.name = 'frame text'\r\n    @frameText.x = @canvasWidth - 50\r\n    @frameText.y = @canvasHeight - 25\r\n    @frameText.alpha = 0.5\r\n\r\n  updateFrame: (currentFrame) ->\r\n    return unless @on\r\n    ++@framesRenderedThisSecond\r\n    time = Date.now()\r\n    diff = (time - @lastFrameSecondStart) / 1000\r\n    if diff > 1\r\n      @fps = Math.round @framesRenderedThisSecond / diff\r\n      @lastFrameSecondStart = time\r\n      @framesRenderedThisSecond = 0\r\n\r\n    @frameText.text = Math.round(currentFrame) + (if @fps? then ' - ' + @fps + ' fps' else '')\r\n    @frameText.x = @canvasWidth - @frameText.getMeasuredWidth() - 10\r\n"]}