{"version":3,"sources":["app/lib/surface/PointChooser.coffee"],"names":[],"mappings":";AAAA;EAAA;;;;AAAA,YAAY,QAAQ,gBAAR;;AAEZ,MAAM,CAAC,OAAP,GAAuB;;;EACR,sBAAC,OAAD;IAAC,IAAC,WAAD;;IACZ;IACA,IAAC,WAAD;IACA,IAAC,QAAO,CAAC,KAAK,CAAC,gBAAf,CAAgC,gBAAhC,EAAkD,IAAC,YAAnD;IACA,IAAC,QAAO,CAAC,MAAM,CAAC,YAAhB,GAA+B;EAJpB;;yBAMb,UAAS;IACP,IAAC,QAAO,CAAC,KAAK,CAAC,mBAAf,CAAmC,gBAAnC,EAAqD,IAAC,YAAtD;WACA;EAFO;;yBAKT,WAAU,SAAC,KAAD;IAAC,IAAC,SAAD;WACT,IAAC,YAAD;EADQ;;yBAGV,aAAY;IACV,IAAC,MAAD,GAAa,YAAQ,CAAC,KAAT;IACb,IAAC,MAAK,CAAC,KAAP,GAAe;IACf,IAAC,MAAK,CAAC,YAAP,GAAsB;IACtB,IAAC,MAAK,CAAC,QAAQ,CAAC,cAAhB,CAA+B,CAA/B,EAAkC,OAAlC,CAA0C,CAAC,WAA3C,CAAuD,SAAvD,CAAiE,CAAC,SAAlE,CAA4E,SAA5E;WACA,IAAC,MAAK,CAAC,QAAQ,CAAC,UAAhB,CAA2B,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC,CAAmC,CAAC,OAApC;EALU;;yBAOZ,cAAa,SAAC,CAAD;IACX,KAAc,GAAG,CAAC,KAAlB;AAAA;;IACA,IAAC,SAAD,CAAU,IAAC,QAAO,CAAC,MAAM,CAAC,aAAhB,CAA8B;MAAC,GAAG,CAAC,CAAC,MAAN;MAAc,GAAG,CAAC,CAAC,MAAnB;KAA9B,CAAV;WACA,QAAQ,CAAC,QAAQ,CAAC,OAAlB,CAA0B,sBAA1B,EAAkD;MAAA,OAAO,IAAC,MAAR;KAAlD;EAHW;;yBAKb,cAAa;AACX;IAAA,MAAM,IAAC,QAAO,CAAC,MAAM,CAAC,cAAhB,CAA+B,IAAC,MAAhC;IACN,KAA6C,IAAC,MAAK,CAAC,MAApD;MAAA,IAAC,QAAO,CAAC,YAAY,CAAC,QAAtB,CAA+B,IAAC,MAAhC;;IACA,IAAC,MAAK,CAAC,CAAP,GAAW,GAAG,CAAC;WACf,IAAC,MAAK,CAAC,CAAP,GAAW,GAAG,CAAC;EAJJ;;;;GA3B6B","file":"public/javascripts/app/lib/surface/PointChooser.js","sourcesContent":["CocoClass = require 'core/CocoClass'\r\n\r\nmodule.exports = class PointChooser extends CocoClass\r\n  constructor: (@options) ->\r\n    super()\r\n    @buildShape()\r\n    @options.stage.addEventListener 'stagemousedown', @onMouseDown\r\n    @options.camera.dragDisabled = true\r\n\r\n  destroy: ->\r\n    @options.stage.removeEventListener 'stagemousedown', @onMouseDown\r\n    super()\r\n\r\n  # Called also from WorldSelectModal\r\n  setPoint: (@point) ->\r\n    @updateShape()\r\n\r\n  buildShape: ->\r\n    @shape = new createjs.Shape()\r\n    @shape.alpha = 0.9\r\n    @shape.mouseEnabled = false\r\n    @shape.graphics.setStrokeStyle(1, 'round').beginStroke('#000000').beginFill('#fedcba')\r\n    @shape.graphics.drawCircle(0, 0, 4).endFill()\r\n\r\n  onMouseDown: (e) =>\r\n    return unless key.shift\r\n    @setPoint @options.camera.screenToWorld {x: e.stageX, y: e.stageY}\r\n    Backbone.Mediator.publish 'surface:choose-point', point: @point\r\n\r\n  updateShape: ->\r\n    sup = @options.camera.worldToSurface @point\r\n    @options.surfaceLayer.addChild @shape unless @shape.parent\r\n    @shape.x = sup.x\r\n    @shape.y = sup.y\r\n"]}