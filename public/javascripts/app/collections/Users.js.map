{"version":3,"sources":["app/collections/Users.coffee"],"names":[],"mappings":";AAAA;EAAA;;;AAAA,OAAO,QAAQ,aAAR;;AACP,iBAAiB,QAAQ,4BAAR;;AAEjB,MAAM,CAAC,OAAP,GAAuB;;;;;;;kBACrB,QAAO;;kBACP,MAAK;;kBAEL,oBAAmB,SAAC,SAAD,EAAY,OAAZ;AACjB;;MAD6B,UAAQ;;IACrC,IAAG,OAAO,CAAC,aAAX;MACE,OAAO,OAAO,CAAC;MACf,IAAC,SAAD,CAAU,IAAV,EAAa,MAAb,EAAqB,IAAC,mBAAtB,EAFF;;IAGA,cAAc,SAAS,CAAC,EAAV,IAAgB;IAC9B,QAAQ;IACR,OAAO;IACP,OAAO,CAAC,CAAC,IAAF,CAAO,SAAS,CAAC,GAAV,CAAc,SAAd,CAAP;IACP,OAAO,CAAC,GAAR,GAAc,mBAAiB,WAAjB,GAA6B;;MAC3C,OAAO,CAAC,OAAQ;;IAChB,OAAO,CAAC,IAAI,CAAC,WAAb,GAA2B;IAC3B,OAAO,CAAC,MAAR,GAAiB;IACjB,SAAS;AACT,WAAM,OAAO,IAAb;MACE,UAAU,CAAC,CAAC,SAAF,CAAY,OAAZ;MACV,OAAO,CAAC,IAAI,CAAC,UAAb,GAA0B;MAC1B,MAAM,CAAC,IAAP,CAAY,IAAC,MAAD,CAAO,OAAP,CAAZ;MACA,QAAQ;IAJV;AAKA,WAAO;EAlBU;;kBAoBnB,qBAAoB;IAClB,IAAC,OAAD,CAAQ,IAAC,OAAD,CAAQ,SAAC,IAAD;aACd,IAAI,CAAC,GAAL,CAAS,SAAT;IADc,CAAR,CAAR;WAEA;EAHkB;;kBAKpB,SAAQ,SAAC,IAAD;IACN,KAAuB,IAAvB;AAAA,aAAO,IAAC,MAAD,GAAP;;IACA,OAAO,IAAI,CAAC,WAAL;AACP,WAAO,IAAC,OAAD,CAAQ,SAAC,IAAD;AACb;aAAA,IAAI,CAAC,SAAL,EAAgB,CAAC,WAAjB,EAA8B,CAAC,OAA/B,CAAuC,IAAvC,IAA+C,CAAC,CAAhD,IAAqD,2CAAqB,EAArB,CAAwB,CAAC,OAAzB,CAAiC,IAAjC,IAAyC,CAAC;IADlF,CAAR;EAHD;;;;GA7B2B","file":"public/javascripts/app/collections/Users.js","sourcesContent":["User = require 'models/User'\r\nCocoCollection = require 'collections/CocoCollection'\r\n\r\nmodule.exports = class Users extends CocoCollection\r\n  model: User\r\n  url: '/db/user'\r\n    \r\n  fetchForClassroom: (classroom, options={}) ->\r\n    if options.removeDeleted\r\n      delete options.removeDeleted\r\n      @listenTo @, 'sync', @removeDeletedUsers\r\n    classroomID = classroom.id or classroom\r\n    limit = 10\r\n    skip = 0\r\n    size = _.size(classroom.get('members'))\r\n    options.url = \"/db/classroom/#{classroomID}/members\"\r\n    options.data ?= {}\r\n    options.data.memberLimit = limit\r\n    options.remove = false\r\n    jqxhrs = []\r\n    while skip < size\r\n      options = _.cloneDeep(options)\r\n      options.data.memberSkip = skip\r\n      jqxhrs.push(@fetch(options))\r\n      skip += limit\r\n    return jqxhrs\r\n\r\n  removeDeletedUsers: ->\r\n    @remove @filter (user) ->\r\n      user.get('deleted')\r\n    true\r\n\r\n  search: (term) ->\r\n    return @slice() unless term\r\n    term = term.toLowerCase()\r\n    return @filter (user) ->\r\n      user.broadName().toLowerCase().indexOf(term) > -1 or (user.get('email') ? '').indexOf(term) > -1 \r\n"]}