{"version":3,"sources":["app/templates/teachers/edit-student-modal.jade","app/views/teachers/EditStudentModal.coffee"],"names":[],"mappings":"AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/EA;AAAA;;ACAA;EAAA;;;AAAA,YAAY,QAAQ,sBAAR;;AACZ,QAAQ,QAAQ,cAAR;;AACR,WAAW,QAAQ,uCAAR;;AACX,OAAO,QAAQ,WAAR;;AAEP,MAAM,CAAC,OAAP,GAAuB;;;;;;;6BACrB,KAAI;;6BACJ,WAAU;;6BAEV,SACE;IAAA,iDAAiD,0BAAjD;IACA,6CAA6C,uBAD7C;IAEA,6BAA6B,0BAF7B;;;6BAIF,aAAY,SAAC,GAAD;IAAG,IAAC,kBAAM,IAAC;IACrB,IAAC,WAAU,CAAC,YAAZ,CAAyB,IAAC,KAAI,CAAC,KAAN,EAAzB;IACA,IAAC,MAAD,GAAS,QAAQ,YAAR;IACT,IAAC,MAAD,GAAa,UAAM;MACjB,WAAW,KADM;MAEjB,iBAAiB,KAFA;MAGjB,aAAa,EAHI;MAIjB,cAAc,EAJG;KAAN;IAMb,IAAC,SAAD,CAAU,IAAC,MAAX,EAAkB,QAAlB,EAA4B,IAAC,OAA7B;IACA,IAAC,SAAD,CAAU,IAAC,UAAX,EAAsB,uBAAtB,EAA+C;aAC7C,IAAC,MAAK,CAAC,GAAP,CAAW;QAAE,iBAAiB,IAAnB;QAAyB,cAAc,EAAvC;OAAX;IAD6C,CAA/C;WAEA,IAAC,SAAD,CAAU,IAAC,UAAX,EAAsB,qBAAtB,EAA6C,SAAC,KAAD;aAC3C,IAAC,MAAK,CAAC,GAAP,CAAW;QAAE,cAAc,KAAK,CAAC,OAAtB;OAAX;IAD2C,CAA7C;EAZU;;6BAgBZ,2BAA0B;AACxB;IAAA,QAAQ,IAAC,KAAI,CAAC,GAAN,CAAU,OAAV;WACR,IAAI,CAAC,iBAAL,CAAuB,KAAvB,CAA6B,CAAC,IAA9B,CAAmC;aAAA;eACjC,KAAC,MAAK,CAAC,GAAP,CAAW;UAAE,WAAW,IAAb;SAAX;MADiC;IAAA,QAAnC;EAFwB;;6BAK1B,wBAAuB;WACrB,IAAC,UAAS,CAAC,kBAAX,CAA8B,IAAC,KAA/B,EAAqC,IAAC,MAAK,CAAC,GAAP,CAAW,aAAX,CAArC;EADqB;;6BAGvB,2BAA0B,SAAC,CAAD;IACxB,IAAC,MAAK,CAAC,GAAP,CAAW;MACT,aAAa,EAAE,CAAC,CAAC,aAAJ,CAAkB,CAAC,GAAnB,EADJ;MAET,WAAW,KAFF;MAGT,iBAAiB,KAHR;KAAX,EAIG;MAAE,QAAQ,IAAV;KAJH;WAKA,IAAC,gBAAD,CAAiB,sBAAjB;EANwB;;;;GAjCoB","file":"public/javascripts/app/views/teachers/EditStudentModal.js","sourcesContent":["var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,state = locals_.state;buf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content style-flat\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<h3><span data-i18n=\\\"teacher.edit_2\\\" class=\\\"spr\\\"></span><span>\" + (jade.escape(null == (jade.interp = view.user.broadName()) ? \"\" : jade.interp)) + \"</span></h3></div><div class=\\\"modal-body\\\"><div class=\\\"text-center\\\"><div class=\\\"edit-student-details\\\"><strong data-i18n=\\\"teacher.student_details\\\"></strong><span class=\\\"spr\\\">:</span><div class=\\\"small-details\\\"> <span data-i18n=\\\"teacher.student_name\\\"></span><span class=\\\"spr\\\">:</span>\");\nif ( (view.user.get('firstName') && view.user.get('lastName')))\n{\nbuf.push(\"<span>\" + (jade.escape(null == (jade.interp = view.user.get('firstName')) ? \"\" : jade.interp)) + \"</span><span class=\\\"spl\\\">\" + (jade.escape(null == (jade.interp = view.user.get('lastName')) ? \"\" : jade.interp)) + \"</span>\");\n}\nelse\n{\nbuf.push(\"<i data-i18n=\\\"teacher.no_name\\\"></i>\");\n}\nbuf.push(\"</div><div class=\\\"small-details\\\"> <span data-i18n=\\\"general.username\\\"></span><span class=\\\"spr\\\">:</span>\");\nif ( (view.user.get('name')))\n{\nbuf.push(\"<span>\" + (jade.escape(null == (jade.interp = view.user.get('name')) ? \"\" : jade.interp)) + \"</span>\");\n}\nelse\n{\nbuf.push(\"<i data-i18n=\\\"teacher.no_username\\\"></i>\");\n}\nbuf.push(\"</div><div class=\\\"small-details\\\"> <span data-i18n=\\\"general.email\\\"></span><span class=\\\"spr\\\">:</span>\");\nif ( (view.user.get('email')))\n{\nbuf.push(\"<a\" + (jade.attrs({ 'href':(\"mailto:\"+view.user.get('email')) }, {\"href\":true})) + \"><span>\" + (jade.escape(null == (jade.interp = view.user.get('email')) ? \"\" : jade.interp)) + \"</span></a>\");\n}\nelse\n{\nbuf.push(\"<i data-i18n=\\\"teacher.no_email\\\"></i>\");\n}\nbuf.push(\"</div></div>\");\nif ( view.user.get('emailVerified'))\n{\nbuf.push(\"<p><span data-i18n=\\\"teacher.send_email_to\\\"></span></p><p class=\\\"m-b-3\\\">\" + (jade.escape(null == (jade.interp = view.user.get('email')) ? \"\" : jade.interp)) + \"</p>\");\nif ( state.get('emailSent'))\n{\nbuf.push(\"<div class=\\\"send-recovery-email-btn btn btn-lg btn-primary uppercase disabled\\\"><span data-i18n=\\\"teacher.email_sent\\\"></span></div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"send-recovery-email-btn btn btn-lg btn-primary uppercase\\\"><span data-i18n=\\\"teacher.send_recovery_email\\\"></span></div>\");\n}\n}\nelse\n{\nbuf.push(\"<div class=\\\"m-b-1\\\"><strong data-i18n=\\\"teacher.enter_new_password_below\\\"></strong></div><div\" + (jade.attrs({ \"class\": [('m-b-2'),('form-group'),((state.get('errorMessage') ? 'has-error' : ''))] }, {\"class\":true})) + \"><input\" + (jade.attrs({ 'placeholder':(\"type a new password here\"), 'value':(state.get('newPassword')), \"class\": [('new-password-input')] }, {\"placeholder\":true,\"value\":true})) + \"/><div class=\\\"help-block error-help-block m-t-1 small\\\"><span>\" + (jade.escape(null == (jade.interp = state.get('errorMessage')) ? \"\" : jade.interp)) + \"</span></div></div>\");\nif ( state.get('passwordChanged'))\n{\nbuf.push(\"<button class=\\\"change-password-btn btn btn-lg btn-primary uppercase disabled\\\"><span data-i18n=\\\"teacher.changed\\\"></span></button>\");\n}\nelse\n{\nbuf.push(\"<button class=\\\"change-password-btn btn btn-lg btn-primary uppercase\\\"><span data-i18n=\\\"teacher.change_password\\\"></span></button>\");\n}\n}\nbuf.push(\"</div></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><button type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"btn btn-primary\\\">\");\nif ( state.get('passwordChanged') || state.get('emailSent'))\n{\nbuf.push(\"<span data-i18n=\\\"modal.close\\\"></span>\");\n}\nelse\n{\nbuf.push(\"<span data-i18n=\\\"common.cancel\\\"></span>\");\n}\nbuf.push(\"</button></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","ModalView = require 'views/core/ModalView'\r\nState = require 'models/State'\r\ntemplate = require 'templates/teachers/edit-student-modal'\r\nauth = require 'core/auth'\r\n\r\nmodule.exports = class EditStudentModal extends ModalView\r\n  id: 'edit-student-modal'\r\n  template: template\r\n\r\n  events:\r\n    'click .send-recovery-email-btn:not(.disabled)': 'onClickSendRecoveryEmail'\r\n    'click .change-password-btn:not(.disabled)': 'onClickChangePassword'\r\n    'input .new-password-input': 'onChangeNewPasswordInput'\r\n\r\n  initialize: ({ @user, @classroom }) ->\r\n    @supermodel.trackRequest @user.fetch()\r\n    @utils = require 'core/utils'\r\n    @state = new State({\r\n      emailSent: false\r\n      passwordChanged: false\r\n      newPassword: \"\"\r\n      errorMessage: \"\"\r\n    })\r\n    @listenTo @state, 'change', @render\r\n    @listenTo @classroom, 'save-password:success', ->\r\n      @state.set { passwordChanged: true, errorMessage: \"\" }\r\n    @listenTo @classroom, 'save-password:error', (error) ->\r\n      @state.set({ errorMessage: error.message })\r\n      # TODO: Show an error. (password too short)\r\n\r\n  onClickSendRecoveryEmail: ->\r\n    email = @user.get('email')\r\n    auth.sendRecoveryEmail(email).then =>\r\n      @state.set { emailSent: true }\r\n\r\n  onClickChangePassword: ->\r\n    @classroom.setStudentPassword(@user, @state.get('newPassword'))\r\n\r\n  onChangeNewPasswordInput: (e) ->\r\n    @state.set { \r\n      newPassword: $(e.currentTarget).val()\r\n      emailSent: false\r\n      passwordChanged: false\r\n    }, { silent: true }\r\n    @renderSelectors('.change-password-btn')\r\n"]}