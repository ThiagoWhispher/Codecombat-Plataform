{"version":3,"sources":["app/views/clans/ClanDetailsView.coffee"],"names":[],"mappings":";AAAA;EAAA;;;;AAAA,WAAW,QAAQ,qBAAR;;AACX,WAAW,QAAQ,8BAAR;;AACX,MAAM,QAAQ,kBAAR;;AACN,qBAAqB,QAAQ,+BAAR;;AACrB,iBAAiB,QAAQ,4BAAR;;AACjB,WAAW,QAAQ,iBAAR;;AACX,OAAO,QAAQ,aAAR;;AACP,oBAAoB,QAAQ,0BAAR;;AACpB,eAAe,QAAQ,qBAAR;;AACf,iBAAiB,QAAQ,2BAAR;;AACjB,YAAY,QAAQ,kBAAR;;AACZ,OAAO,QAAQ,aAAR;;AACP,QAAQ,QAAQ,YAAR;;AAOR,MAAM,CAAC,OAAP,GAAuB;;;4BACrB,KAAI;;4BACJ,WAAU;;4BAEV,SACE;IAAA,oCAAoC,4BAApC;IACA,0BAA0B,cAD1B;IAEA,oCAAoC,uBAFpC;IAGA,6BAA6B,gBAH7B;IAIA,wBAAwB,YAJxB;IAKA,yBAAyB,aALzB;IAMA,wBAAwB,qBANxB;IAOA,0BAA0B,uBAP1B;IAQA,8BAA8B,cAR9B;IASA,4BAA4B,gBAT5B;IAUA,mCAAmC,mBAVnC;IAWA,mCAAmC,mBAXnC;;;EAaW,yBAAC,OAAD,EAAU,MAAV;IAAU,IAAC,UAAD;IACrB,iDAAM,OAAN;IACA,IAAC,SAAD;EAFW;;4BAIb,UAAS;sDACP,IAAC;EADM;;4BAGT,WAAU;IACR,IAAC,qBAAD,GAAwB;IACxB,IAAC,WAAD,GAAc;IACd,IAAC,MAAD,GAAS;IAET,IAAC,UAAD,GAAiB,mBAAe,EAAf,EAAmB;MAAE,KAAK,cAAP;MAAuB,OAAO,QAA9B;MAAwC,YAAW,KAAnD;KAAnB;IACjB,IAAC,KAAD,GAAY,SAAK;MAAA,KAAK,IAAC,OAAN;KAAL;IACZ,IAAC,QAAD,GAAe,mBAAe,EAAf,EAAmB;MAAE,KAAK,cAAY,IAAC,OAAb,GAAoB,UAA3B;MAAsC,OAAO,IAA7C;MAAmD,YAAY,WAA/D;KAAnB;IACf,IAAC,mBAAD,GAA0B,mBAAe,EAAf,EAAmB;MAAE,KAAK,cAAY,IAAC,OAAb,GAAoB,sBAA3B;MAAkD,OAAO,iBAAzD;MAA4E,YAAW,KAAvF;KAAnB;IAC1B,IAAC,eAAD,GAAsB,mBAAe,EAAf,EAAmB;MAAE,KAAK,cAAY,IAAC,OAAb,GAAoB,kBAA3B;MAA8C,OAAO,YAArD;MAAmE,YAAW,KAA9E;KAAnB;IAEtB,IAAC,SAAD,CAAU,EAAV,EAAc,MAAd,EAAsB;aAAA;oDAAG,KAAC;MAAJ;IAAA,QAAtB;IACA,IAAC,SAAD,CAAU,IAAC,UAAX,EAAsB,MAAtB,EAA8B,IAAC,eAA/B;IACA,IAAC,SAAD,CAAU,IAAC,KAAX,EAAiB,MAAjB,EAAyB,IAAC,WAA1B;IACA,IAAC,SAAD,CAAU,IAAC,QAAX,EAAoB,MAApB,EAA4B,IAAC,cAA7B;IACA,IAAC,SAAD,CAAU,IAAC,mBAAX,EAA+B,MAA/B,EAAuC,IAAC,yBAAxC;IACA,IAAC,SAAD,CAAU,IAAC,eAAX,EAA2B,MAA3B,EAAmC,IAAC,qBAApC;IAEA,IAAC,WAAU,CAAC,SAAZ,CAAsB,IAAC,UAAvB,EAAkC;MAAA,OAAO,KAAP;KAAlC;IACA,IAAC,WAAU,CAAC,SAAZ,CAAsB,IAAC,KAAvB,EAA6B;MAAA,OAAO,KAAP;KAA7B;IACA,IAAC,WAAU,CAAC,cAAZ,CAA2B,IAAC,QAA5B,EAAqC,SAArC,EAAgD;MAAC,OAAO,KAAR;KAAhD;WACA,IAAC,WAAU,CAAC,cAAZ,CAA2B,IAAC,mBAA5B,EAAgD,qBAAhD,EAAuE;MAAC,OAAO,KAAR;KAAvE;EArBQ;;4BAuBV,gBAAe;AACb;IAAA,UAAU;IACV,OAAO,CAAC,yBAAR,0DAAiE;IACjE,OAAO,CAAC,IAAR,GAAe,IAAC;IAChB,OAAO,CAAC,mBAAR,sDAAqD;IACrD,IAAG,WAAW,CAAC,YAAZ,EAAH;MACE,OAAO,CAAC,YAAR,GAAuB,kCAAgC,IAAC,QAD1D;KAAA;MAGE,OAAO,CAAC,YAAR,GAAuB,iCAA+B,IAAC,QAHzD;;IAIA,OAAO,CAAC,KAAR,GAAgB,IAAC;IACjB,OAAO,CAAC,qBAAR,GAAgC,IAAC;IACjC,OAAO,CAAC,iBAAR,GAA4B,IAAC;IAC7B,OAAO,CAAC,mBAAR,iDAAgD;IAChD,OAAO,CAAC,mBAAR,GAA8B,IAAC;IAC/B,OAAO,CAAC,UAAR,GAAqB,IAAC;IACtB,OAAO,CAAC,OAAR,GAAkB,IAAC,KAAI,CAAC,GAAN,CAAU,SAAV,MAAwB,EAAE,CAAC;IAC7C,OAAO,CAAC,QAAR,GAAmB,YAAC,OAAD,yDAA8B,EAA9B;IACnB,OAAO,CAAC,KAAR,GAAgB,IAAC;IAIjB,2BAA2B;IAC3B,2BAA2B;IAC3B,2BAA2B;IAC3B,kBAAkB;IAClB,IAAG,IAAC,UAAS,CAAC,MAAd;MACE,aAAa;AACb;AAAA;;cAAuC,QAAQ,CAAC,GAAT,CAAa,MAAb,MAAwB;;;QAC7D,aAAa,QAAQ,CAAC;QACtB,iBAAiB;AACjB;AAAA;;UACE,YAAY,KAAK,CAAC;AAClB;AAAA;;YACE,oEAA2C,oBAA3C;;gBACE,kCAAuC;;;oBACH,eAAe;;cACnD,wBAAyB,OAAM,CAAC,EAAP,CAAW,YAApC,GACE;gBAAA,WAAW,SAAX;gBACA,OAAO,cADP;;cAEF,IAA6C,iBAAiB,wBAA9D;gBAAA,2BAA2B,eAA3B;;cACA,IAAG,sBAAH;;kBACE,yBAA8B;;AAC9B;AAAA;;kBACE,IAAY,eAAgB,OAAM,CAAC,EAAP,CAAW,SAA3B,KAAuC,UAAnD;AAAA;;kBACA,eAAgB,OAAM,CAAC,EAAP,CAAW,SAA3B,GAAsC,OAAO,CAAC,mBAAoB,OAAM,CAAC,EAAP,CAAW,WAAU,CAAC;AAF1F,iBAFF;;cAKA,wBAAyB,OAAM,CAAC,EAAP,CAAzB,GAAsC,WAZxC;;AADF;UAcA;UACA;AAjBF;AAHF,OAFF;;IAwBA,IAAC,YAAD,CAAa,wBAAb,EAAuC,eAAvC;IACA,OAAO,CAAC,OAAR,sFAAqC;IACrC,OAAO,CAAC,wBAAR,GAAmC;IACnC,OAAO,CAAC,oBAAR,GAA+B,4BAA4B,EAA5B,IAAkC,IAAC;IAClE,OAAO,CAAC,eAAR,GAA0B;IAC1B,OAAO,CAAC,MAAR,GAAiB,IAAC;IAClB,OAAO,CAAC,IAAR,GAAe,KAAK,CAAC;WACrB;EAxDa;;4BA0Df,cAAa;IACX;WACA,IAAC,gBAAD;EAFW;;4BAIb,cAAa;IACX,EAAE,CAAC,KAAH,CAAS;MAAA,OAAO,KAAP;KAAT;IACA,IAAC,QAAO,CAAC,KAAT,CAAe;MAAA,OAAO,KAAP;KAAf;IACA,IAAC,mBAAkB,CAAC,KAApB,CAA0B;MAAA,OAAO,KAAP;KAA1B;WACA,IAAC,eAAc,CAAC,KAAhB,CAAsB;MAAA,OAAO,KAAP;KAAtB;EAJW;;4BAMb,cAAa,SAAC,wBAAD,EAA2B,eAA3B;IAEX,MAAc,0BAAc,yBAA5B;AAAA;;AACA,YAAO,IAAC,WAAR;AAAA,WACO,UADP;QAEI,IAAC,QAAO,CAAC,UAAT,GAAsB,SAAC,CAAD,EAAI,CAAJ;AAAU,iBAAO,CAAC,CAAC,CAAC,GAAF,CAAM,MAAN,KAAiB,WAAlB,CAA8B,CAAC,aAA/B,CAA6C,CAAC,CAAC,GAAF,CAAM,MAAN,KAAiB,WAA9D;QAAjB;AADnB;AADP,WAGO,aAHP;QAII,IAAC,QAAO,CAAC,UAAT,GAAsB,SAAC,CAAD,EAAI,CAAJ;AACpB;UAAA;;AAAa;AAAA;iBAAA;;kBAAyD,UAAS;6BAAlE;;AAAA;;;UACb;;AAAa;AAAA;iBAAA;;kBAAyD,UAAS;6BAAlE;;AAAA;;;UACb;;AAAY;AAAA;iBAAA;;kBAAyD,UAAS;6BAAlE;;AAAA;;;UACZ;;AAAY;AAAA;iBAAA;;kBAAyD,UAAS;6BAAlE;;AAAA;;;UACZ,IAAG,YAAY,SAAf;AAA8B,mBAAO,CAAC,EAAtC;WAAA,MACK,IAAG,YAAY,SAAf;AAA8B,mBAAO,EAArC;WAAA,MACA,IAAG,WAAW,QAAd;AAA4B,mBAAO,CAAC,EAApC;WAAA,MACA,IAAG,WAAW,QAAd;AAA4B,mBAAO,EAAnC;;UACL,IAAG,wBAAyB,EAAC,CAAC,EAAF,CAAzB,GAAiC,wBAAyB,EAAC,CAAC,EAAF,CAA7D;AAAwE,mBAAO,CAAC,EAAhF;WAAA,MACK,IAAG,wBAAyB,EAAC,CAAC,EAAF,CAAzB,GAAiC,wBAAyB,EAAC,CAAC,EAAF,CAA7D;AAAwE,mBAAO,EAA/E;;iBACL,CAAC,CAAC,CAAC,GAAF,CAAM,MAAN,KAAiB,WAAlB,CAA8B,CAAC,aAA/B,CAA6C,CAAC,CAAC,GAAF,CAAM,MAAN,KAAiB,WAA9D;QAXoB;AADnB;AAHP,WAgBO,cAhBP;QAiBI,IAAC,QAAO,CAAC,UAAT,GAAsB,SAAC,CAAD,EAAI,CAAJ;AACpB;UAAA;;AAAa;AAAA;iBAAA;;kBAAyD,UAAS;6BAAlE;;AAAA;;;UACb;;AAAa;AAAA;iBAAA;;kBAAyD,UAAS;6BAAlE;;AAAA;;;UACb;;AAAY;AAAA;iBAAA;;kBAAyD,UAAS;6BAAlE;;AAAA;;;UACZ;;AAAY;AAAA;iBAAA;;kBAAyD,UAAS;6BAAlE;;AAAA;;;UACZ,IAAG,YAAY,SAAf;AAA8B,mBAAO,CAAC,EAAtC;WAAA,MACK,IAAG,YAAY,SAAf;AAA8B,mBAAO,EAArC;WAAA,MACA,IAAG,WAAW,QAAd;AAA4B,mBAAO,CAAC,EAApC;WAAA,MACA,IAAG,WAAW,QAAd;AAA4B,mBAAO,EAAnC;;UACL,IAAG,wBAAyB,EAAC,CAAC,EAAF,CAAzB,GAAiC,wBAAyB,EAAC,CAAC,EAAF,CAA7D;AAAwE,mBAAO,CAAC,EAAhF;WAAA,MACK,IAAG,wBAAyB,EAAC,CAAC,EAAF,CAAzB,GAAiC,wBAAyB,EAAC,CAAC,EAAF,CAA7D;AAAwE,mBAAO,EAA/E;;iBACL,CAAC,CAAC,CAAC,GAAF,CAAM,MAAN,KAAiB,WAAlB,CAA8B,CAAC,aAA/B,CAA6C,CAAC,CAAC,GAAF,CAAM,MAAN,KAAiB,WAA9D;QAXoB;AADnB;AAhBP;QA8BI,IAAC,QAAO,CAAC,UAAT,GAAsB,SAAC,CAAD,EAAI,CAAJ;AAAU,iBAAO,CAAC,CAAC,CAAC,GAAF,CAAM,MAAN,KAAiB,WAAlB,CAA8B,CAAC,aAA/B,CAA6C,CAAC,CAAC,GAAF,CAAM,MAAN,KAAiB,WAA9D;QAAjB;AA9B1B;WA+BA,IAAC,QAAO,CAAC,IAAT;EAlCW;;4BAoCb,kBAAiB;AACf;IAAA,IAAc,4DAAd;AAAA;;AACA;AAAA;SAAA;;MACE,KAAgB,wDAA+B,CAAE,kBAAjC,CAAhB;AAAA;;;;AACA;AAAA;aAAA;;cAA4C,aAAY;0BACtD,IAAC,IAAG,CAAC,IAAL,CAAU,qCAAmC,MAAM,CAAC,EAA1C,GAA6C,GAAvD,CAA0D,CAAC,WAA3D,CAAuE,mBAAvE,CAA2F,CAAC,QAA5F,CAAqG,sBAAsB,IAA3H;;AADF;;;AAFF;;EAFe;;4BAOjB,iBAAgB;AACd;IAAA,KAAc,IAAC,UAAS,CAAC,MAAzB;AAAA;;IACA,IAAC,0BAAD,GAA6B;IAC7B,IAAC,oBAAD,GAAuB;IACvB,IAAC,OAAD,GAAU;AACV;AAAA;;YAAuC,QAAQ,CAAC,GAAT,CAAa,MAAb,MAAwB;;;MAC7D,2BACE;QAAA,IAAI,QAAQ,CAAC,EAAb;QACA,MAAM,QAAQ,CAAC,GAAT,CAAa,MAAb,CADN;QAEA,MAAM,KAAK,CAAC,IAAN,CAAW,QAAQ,CAAC,UAApB,EAAgC,UAAhC,KAA+C,KAAK,CAAC,IAAN,CAAW,QAAQ,CAAC,UAApB,EAAgC,MAAhC,CAFrD;QAGA,QAAQ,EAHR;;AAIF;AAAA;;QACE,wBAAwB,CAAC,MAAM,CAAC,IAAhC,CACE;UAAA,IAAI,OAAJ;UACA,MAAM,KAAK,CAAC,IADZ;UAEA,MAAM,KAAK,CAAC,IAAN,CAAW,KAAX,EAAkB,MAAlB,CAFN;SADF;QAIA,IAAG,sBAAH;AACE;AAAA;;YACE,IAAyC,aAAW,IAAC,oBAAZ,cAAzC;cAAA,IAAC,oBAAmB,CAAC,IAArB,CAA0B,OAA1B;;AADF,WADF;;QAGA,IAAG,KAAK,CAAC,IAAN,KAAc,aAAd,IAAgC,cAAK,CAAC,KAAN,KAAmB,oBAAnB,CAAnC;UACE,IAAC,OAAM,CAAC,IAAR,CAAa,KAAb,EADF;;AARF;MAUA,IAAC,0BAAyB,CAAC,IAA3B,CAAgC,wBAAhC;AAhBF;+CAiBA,IAAC;EAtBa;;4BAwBhB,aAAY;IACV,IAAO,kBAAP;MACE,IAAC,MAAD,GAAa,SAAK;QAAA,KAAK,IAAC,KAAI,CAAC,GAAN,CAAU,SAAV,CAAL;OAAL;MACb,IAAC,SAAD,CAAU,IAAC,MAAX,EAAkB,MAAlB,EAA0B;eAAA;sDAAG,KAAC;QAAJ;MAAA,QAA1B;MACA,IAAC,WAAU,CAAC,SAAZ,CAAsB,IAAC,MAAvB,EAA8B;QAAA,OAAO,KAAP;OAA9B,EAHF;;IAIA,IAAG,IAAC,KAAI,CAAC,GAAN,CAAU,eAAV,MAA8B,SAAjC;MACE,IAAC,WAAU,CAAC,cAAZ,CAA2B,IAAC,eAA5B,EAA4C,iBAA5C,EAA+D;QAAC,OAAO,KAAR;OAA/D,EADF;;+CAEA,IAAC;EAPS;;4BASZ,gBAAe;IACb,IAAC,MAAK,CAAC,YAAP,GAAsB,IAAI,CAAC,KAAL,CAAW,IAAC,QAAO,CAAC,MAAT,CAAgB,CAAC,SAAC,GAAD,EAAM,MAAN;aAAiB,MAAM,MAAM,CAAC,KAAP;IAAvB,CAAD,CAAhB,EAAyD,CAAzD,IAA8D,IAAC,QAAO,CAAC,MAAlF;+CACtB,IAAC;EAFY;;4BAIf,2BAA0B;AACxB;IAAA,IAAC,sBAAD,GAAyB;AACzB;AAAA;;MACE,OAAO,WAAW,CAAC,GAAZ,CAAgB,MAAhB;;YACgB,SAAS;;MAChC,IAAC,sBAAsB,MAAK,CAAC,IAA7B,CAAkC,WAAlC;AAHF;AAIA;MACE,IAAC,sBAAsB,MAAK,CAAC,IAA7B,CAAkC,SAAC,CAAD,EAAI,CAAJ;eAAU,CAAC,CAAC,EAAE,CAAC,aAAL,CAAmB,CAAC,CAAC,EAArB;MAAV,CAAlC;AADF;IAEA,IAAC,MAAK,CAAC,mBAAP,GAA6B,IAAI,CAAC,KAAL,CAAW,IAAC,mBAAkB,CAAC,MAAM,CAAC,MAA3B,GAAoC,MAAM,CAAC,IAAP,CAAY,IAAC,sBAAb,CAAmC,CAAC,MAAnF;+CAC7B,IAAC;EATuB;;4BAW1B,uBAAsB;AACpB;IAAA,IAAC,eAAD,GAAkB;IAClB,iBAAiB;AACjB;AAAA;;MACE,IAAY,YAAY,CAAC,aAAb,EAAZ;AAAA;;MACA,OAAO,YAAY,CAAC,GAAb,CAAiB,SAAjB;MACP,YAAY,YAAY,CAAC,GAAb,CAAiB,SAAjB;;YACI,SAAS;;;aACH,cAAc;;MACpC,YACE;QAAA,OAAO,YAAY,CAAC,GAAb,CAAiB,WAAjB,CAAP;QACA,SAAS,YAAY,CAAC,GAAb,CAAiB,SAAjB,CADT;QAEA,SAAa,SAAK,YAAY,CAAC,GAAb,CAAiB,SAAjB,CAAL,CAAiC,CAAC,cAAlC,EAFb;QAGA,UAAU,YAAY,CAAC,GAAb,CAAiB,UAAjB,CAHV;QAIA,WAAW,YAAY,CAAC,EAJxB;;MAKF,IAAC,eAAe,MAAM,WAAU,CAAC,SAAjC,GAA6C;MAC7C,sDAA4B,CAAE,kBAA3B,KAAuC,IAA1C;QACE,IAAC,eAAe,MAAM,WAAU,CAAC,KAAjC,GAAyC;;UACzC,cAAe,SAAS;;QACxB,cAAe,MAAK,CAAC,IAArB,CAA0B,YAA1B,EAHF;OAAA;QAKE,IAAC,eAAe,MAAM,WAAU,CAAC,KAAjC,GAAyC,UAL3C;;AAbF;IAmBA,IAAC,oBAAD,GAAuB;IACvB,IAAC,kBAAD,GAAqB;AACrB;MACE,iBAAiB;AACjB;AAAA;;QACE,WAAW,YAAY,CAAC,GAAb,CAAiB,cAAjB,KAAoC,YAAY,CAAC,GAAb,CAAiB,uBAAjB;QAC/C,IAAkE,QAAlE;UAAA,cAAe,UAAf,GAA2B,CAAC,cAAe,UAAf,IAA4B,CAA7B,IAAkC,EAA7D;;AAFF;MAGA,IAAsD,IAAC,oBAAD,GAAuB,cAAe,MAAK,CAAC,MAAlG;QAAA,IAAC,oBAAD,GAAuB,cAAe,MAAK,CAAC,OAA5C;;MACA,gBAAgB;AAChB;;QACE,IAAG,QAAQ,aAAX;UACE,gBAAgB;UAChB,IAAC,kBAAkB,MAAnB,GAA2B,SAF7B;;AADF;AAPF;+CAWA,IAAC;EAnCmB;;4BAqCtB,oBAAmB,SAAC,CAAD;AACjB;IAAA,EAAE,wBAAF,CAA2B,CAAC,IAA5B;IACA,YAAY,EAAE,CAAC,CAAC,MAAJ,CAAW,CAAC,IAAZ,CAAiB,wBAAjB,CAA0C,CAAC,IAA3C;IACZ,SAAS;IACT,SAAS,EAAE,CAAC,CAAC,MAAJ,CAAW,CAAC,MAAZ;IACT,YAAY,EAAE,CAAC,CAAC,MAAJ,CAAW,CAAC,YAAZ,EAA0B,CAAC,SAA3B;IACZ,SAAS,SAAS,CAAC,WAAV;IACT,SAAS,CAAC,GAAV,CAAc,MAAd,EAAsB,MAAM,CAAC,IAAP,GAAc,CAAC,CAAC,OAAtC;WACA,SAAS,CAAC,GAAV,CAAc,KAAd,EAAqB,MAAM,CAAC,GAAP,GAAa,SAAb,GAAyB,MAAzB,GAAkC,MAAvD;EARiB;;4BAUnB,oBAAmB,SAAC,CAAD;WACjB,EAAE,CAAC,CAAC,MAAJ,CAAW,CAAC,IAAZ,CAAiB,wBAAjB,CAA0C,CAAC,IAA3C;EADiB;;4BAGnB,eAAc,SAAC,CAAD;AACZ;IAAA,YAAY,EAAE,CAAC,CAAC,MAAJ,CAAW,CAAC,IAAZ,CAAiB,YAAjB;IACZ,MAAc,8DAAwB,4DAAtC;AAAA;;IACA,MAAM,iBAAe,SAAS,CAAC,OAAzB,GAAiC,WAAjC,GAA4C,SAAS,CAAC,SAAtD,GAAgE;WACtE,MAAM,CAAC,IAAP,CAAY,GAAZ,EAAiB,QAAjB;EAJY;;4BAMd,eAAc,SAAC,CAAD;AACZ;IAAA,IAAmD,EAAE,CAAC,WAAH,EAAnD;AAAA,aAAO,IAAC,cAAD,CAAmB,wBAAnB,EAAP;;IACA,KAAc,MAAM,CAAC,OAAP,CAAe,cAAf,CAAd;AAAA;;IACA,UACE;MAAA,KAAK,cAAY,IAAC,OAAlB;MACA,QAAQ,QADR;MAEA,OAAO;eAAA,SAAC,KAAD,EAAQ,QAAR,EAAkB,OAAlB;iBACL,OAAO,CAAC,KAAR,CAAc,oBAAd,EAAoC,QAApC;QADK;MAAA,QAFP;MAIA,SAAS;eAAA,SAAC,KAAD,EAAQ,QAAR,EAAkB,OAAlB;UACP,GAAG,CAAC,MAAM,CAAC,QAAX,CAAoB,QAApB;iBACA,MAAM,CAAC,QAAQ,CAAC,MAAhB;QAFO;MAAA,QAJT;;WAOF,IAAC,WAAU,CAAC,kBAAZ,CAAgC,aAAhC,EAA+C,OAA/C,CAAuD,CAAC,IAAxD;EAXY;;4BAad,wBAAuB,SAAC,CAAD;AACrB;IAAA,cAAc,EAAE,yBAAF,CAA4B,CAAC,GAA7B;IACd,IAAC,KAAI,CAAC,GAAN,CAAU,aAAV,EAAyB,WAAzB;IACA,IAAC,KAAI,CAAC,KAAN;WACA,EAAE,uBAAF,CAA0B,CAAC,KAA3B,CAAiC,MAAjC;EAJqB;;4BAMvB,iBAAgB,SAAC,CAAD;AACd;IAAA,IAAG,OAAO,EAAE,kBAAF,CAAqB,CAAC,GAAtB,EAAV;MACE,IAAC,KAAI,CAAC,GAAN,CAAU,MAAV,EAAkB,IAAlB;MACA,IAAC,KAAI,CAAC,KAAN,GAFF;;WAGA,EAAE,gBAAF,CAAmB,CAAC,KAApB,CAA0B,MAA1B;EAJc;;4BAMhB,6BAA4B,SAAC,CAAD;IAC1B,IAAC,qBAAD,GAAwB,EAAE,2BAAF,CAA8B,CAAC,IAA/B,CAAoC,SAApC;;MAExB,IAAC;;WACD,EAAE,2BAAF,CAA8B,CAAC,IAA/B,CAAoC,SAApC,EAA+C,IAAC,qBAAhD;EAJ0B;;4BAM5B,aAAY,SAAC,CAAD;AACV;IAAA,IAAmD,EAAE,CAAC,WAAH,EAAnD;AAAA,aAAO,IAAC,cAAD,CAAmB,wBAAnB,EAAP;;IACA,KAAc,IAAC,KAAI,CAAC,MAApB;AAAA;;IACA,IAAG,IAAC,KAAI,CAAC,GAAN,CAAU,MAAV,MAAqB,SAArB,IAAmC,CAAI,EAAE,CAAC,SAAH,EAA1C;MACE,IAAC,cAAD,CAAmB,oBAAnB;;WACc,CAAE,UAAhB,CAA2B,yBAA3B,EAAsD;UAAA,UAAU,cAAV;UAA0B,OAAO,WAAjC;SAAtD;;AACA,aAHF;;IAIA,UACE;MAAA,KAAK,cAAY,IAAC,OAAb,GAAoB,OAAzB;MACA,QAAQ,KADR;MAEA,OAAO;eAAA,SAAC,KAAD,EAAQ,QAAR,EAAkB,OAAlB;iBACL,OAAO,CAAC,KAAR,CAAc,oBAAd,EAAoC,QAApC;QADK;MAAA,QAFP;MAIA,SAAS;eAAA,SAAC,KAAD,EAAQ,QAAR,EAAkB,OAAlB;iBAA8B,KAAC,YAAD;QAA9B;MAAA,QAJT;;WAKF,IAAC,WAAU,CAAC,kBAAZ,CAAgC,WAAhC,EAA6C,OAA7C,CAAqD,CAAC,IAAtD;EAbU;;4BAeZ,cAAa,SAAC,CAAD;AACX;IAAA,UACE;MAAA,KAAK,cAAY,IAAC,OAAb,GAAoB,QAAzB;MACA,QAAQ,KADR;MAEA,OAAO;eAAA,SAAC,KAAD,EAAQ,QAAR,EAAkB,OAAlB;iBACL,OAAO,CAAC,KAAR,CAAc,oBAAd,EAAoC,QAApC;QADK;MAAA,QAFP;MAIA,SAAS;eAAA,SAAC,KAAD,EAAQ,QAAR,EAAkB,OAAlB;iBAA8B,KAAC,YAAD;QAA9B;MAAA,QAJT;;WAKF,IAAC,WAAU,CAAC,kBAAZ,CAAgC,YAAhC,EAA8C,OAA9C,CAAsD,CAAC,IAAvD;EAPW;;4BASb,sBAAqB,SAAC,CAAD;IACnB,IAAC,WAAD,GAAiB,IAAC,WAAD,KAAe,SAAlB,GAAiC,UAAjC,GAAiD;+CAC/D,IAAC;EAFkB;;4BAIrB,wBAAuB,SAAC,CAAD;IACrB,IAAC,WAAD,GAAiB,IAAC,WAAD,KAAe,aAAlB,GAAqC,cAArC,GAAyD;+CACvE,IAAC;EAFoB;;4BAIvB,iBAAgB,SAAC,CAAD;AACd;IAAA,KAAc,MAAM,CAAC,OAAP,CAAe,cAAf,CAAd;AAAA;;IACA,IAAG,WAAW,EAAE,CAAC,CAAC,MAAJ,CAAW,CAAC,IAAZ,CAAiB,IAAjB,CAAd;MACE,UACE;QAAA,KAAK,cAAY,IAAC,OAAb,GAAoB,UAApB,GAA8B,QAAnC;QACA,QAAQ,KADR;QAEA,OAAO;iBAAA,SAAC,KAAD,EAAQ,QAAR,EAAkB,OAAlB;mBACL,OAAO,CAAC,KAAR,CAAc,4BAAd,EAA4C,QAA5C;UADK;QAAA,QAFP;QAIA,SAAS;iBAAA,SAAC,KAAD,EAAQ,QAAR,EAAkB,OAAlB;mBAA8B,KAAC,YAAD;UAA9B;QAAA,QAJT;;aAKF,IAAC,WAAU,CAAC,kBAAZ,CAAgC,eAAhC,EAAiD,OAAjD,CAAyD,CAAC,IAA1D,GAPF;KAAA;aASE,OAAO,CAAC,KAAR,CAAc,yCAAd,EATF;;EAFc;;;;GAtU6B","file":"public/javascripts/app/views/clans/ClanDetailsView.js","sourcesContent":["RootView = require 'views/core/RootView'\r\ntemplate = require 'templates/clans/clan-details'\r\napp = require 'core/application'\r\nCreateAccountModal = require 'views/core/CreateAccountModal'\r\nCocoCollection = require 'collections/CocoCollection'\r\nCampaign = require 'models/Campaign'\r\nClan = require 'models/Clan'\r\nEarnedAchievement = require 'models/EarnedAchievement'\r\nLevelSession = require 'models/LevelSession'\r\nSubscribeModal = require 'views/core/SubscribeModal'\r\nThangType = require 'models/ThangType'\r\nUser = require 'models/User'\r\nutils = require 'core/utils'\r\n\r\n# TODO: Add message for clan not found\r\n# TODO: Progress visual for premium levels?\r\n# TODO: Add expanded level names toggle\r\n# TODO: Only need campaign data if clan is private\r\n\r\nmodule.exports = class ClanDetailsView extends RootView\r\n  id: 'clan-details-view'\r\n  template: template\r\n\r\n  events:\r\n    'change .expand-progress-checkbox': 'onExpandedProgressCheckbox'\r\n    'click .delete-clan-btn': 'onDeleteClan'\r\n    'click .edit-description-save-btn': 'onEditDescriptionSave'\r\n    'click .edit-name-save-btn': 'onEditNameSave'\r\n    'click .join-clan-btn': 'onJoinClan'\r\n    'click .leave-clan-btn': 'onLeaveClan'\r\n    'click .member-header': 'onClickMemberHeader'\r\n    'click .progress-header': 'onClickProgressHeader'\r\n    'click .progress-level-cell': 'onClickLevel'\r\n    'click .remove-member-btn': 'onRemoveMember'\r\n    'mouseenter .progress-level-cell': 'onMouseEnterPoint'\r\n    'mouseleave .progress-level-cell': 'onMouseLeavePoint'\r\n\r\n  constructor: (options, @clanID) ->\r\n    super options\r\n    @initData()\r\n\r\n  destroy: ->\r\n    @stopListening?()\r\n\r\n  initData: ->\r\n    @showExpandedProgress = false\r\n    @memberSort = 'nameAsc'\r\n    @stats = {}\r\n\r\n    @campaigns = new CocoCollection([], { url: \"/db/campaign\", model: Campaign, comparator:'_id' })\r\n    @clan = new Clan _id: @clanID\r\n    @members = new CocoCollection([], { url: \"/db/clan/#{@clanID}/members\", model: User, comparator: 'nameLower' })\r\n    @memberAchievements = new CocoCollection([], { url: \"/db/clan/#{@clanID}/member_achievements\", model: EarnedAchievement, comparator:'_id' })\r\n    @memberSessions = new CocoCollection([], { url: \"/db/clan/#{@clanID}/member_sessions\", model: LevelSession, comparator:'_id' })\r\n\r\n    @listenTo me, 'sync', => @render?()\r\n    @listenTo @campaigns, 'sync', @onCampaignSync\r\n    @listenTo @clan, 'sync', @onClanSync\r\n    @listenTo @members, 'sync', @onMembersSync\r\n    @listenTo @memberAchievements, 'sync', @onMemberAchievementsSync\r\n    @listenTo @memberSessions, 'sync', @onMemberSessionsSync\r\n\r\n    @supermodel.loadModel @campaigns, cache: false\r\n    @supermodel.loadModel @clan, cache: false\r\n    @supermodel.loadCollection(@members, 'members', {cache: false})\r\n    @supermodel.loadCollection(@memberAchievements, 'member_achievements', {cache: false})\r\n\r\n  getRenderData: ->\r\n    context = super()\r\n    context.campaignLevelProgressions = @campaignLevelProgressions ? []\r\n    context.clan = @clan\r\n    context.conceptsProgression = @conceptsProgression ? []\r\n    if application.isProduction()\r\n      context.joinClanLink = \"https://codecombat.com/clans/#{@clanID}\"\r\n    else\r\n      context.joinClanLink = \"http://localhost:3000/clans/#{@clanID}\"\r\n    context.owner = @owner\r\n    context.memberAchievementsMap = @memberAchievementsMap\r\n    context.memberLanguageMap = @memberLanguageMap\r\n    context.memberLevelStateMap = @memberLevelMap ? {}\r\n    context.memberMaxLevelCount = @memberMaxLevelCount\r\n    context.memberSort = @memberSort\r\n    context.isOwner = @clan.get('ownerID') is me.id\r\n    context.isMember = @clanID in (me.get('clans') ? [])\r\n    context.stats = @stats\r\n\r\n    # Find last campaign level for each user\r\n    # TODO: why do we do this for every render?\r\n    highestUserLevelCountMap = {}\r\n    lastUserCampaignLevelMap = {}\r\n    maxLastUserCampaignLevel = 0\r\n    userConceptsMap = {}\r\n    if @campaigns.loaded\r\n      levelCount = 0\r\n      for campaign in @campaigns.models when campaign.get('type') is 'hero'\r\n        campaignID = campaign.id\r\n        lastLevelIndex = 0\r\n        for levelID, level of campaign.get('levels')\r\n          levelSlug = level.slug\r\n          for member in @members?.models ? []\r\n            if context.memberLevelStateMap[member.id]?[levelSlug]\r\n              lastUserCampaignLevelMap[member.id] ?= {}\r\n              lastUserCampaignLevelMap[member.id][campaignID] ?= {}\r\n              lastUserCampaignLevelMap[member.id][campaignID] =\r\n                levelSlug: levelSlug\r\n                index: lastLevelIndex\r\n              maxLastUserCampaignLevel = lastLevelIndex if lastLevelIndex > maxLastUserCampaignLevel\r\n              if level.concepts?\r\n                userConceptsMap[member.id] ?= {}\r\n                for concept in level.concepts\r\n                  continue if userConceptsMap[member.id][concept] is 'complete'\r\n                  userConceptsMap[member.id][concept] = context.memberLevelStateMap[member.id][levelSlug].state\r\n              highestUserLevelCountMap[member.id] = levelCount\r\n          lastLevelIndex++\r\n          levelCount++\r\n\r\n    @sortMembers(highestUserLevelCountMap, userConceptsMap)# if @clan.get('dashboardType') is 'premium'\r\n    context.members = @members?.models ? []\r\n    context.lastUserCampaignLevelMap = lastUserCampaignLevelMap\r\n    context.showExpandedProgress = maxLastUserCampaignLevel <= 30 or @showExpandedProgress\r\n    context.userConceptsMap = userConceptsMap\r\n    context.arenas = @arenas\r\n    context.i18n = utils.i18n\r\n    context\r\n\r\n  afterRender: ->\r\n    super()\r\n    @updateHeroIcons()\r\n\r\n  refreshData: ->\r\n    me.fetch cache: false\r\n    @members.fetch cache: false\r\n    @memberAchievements.fetch cache: false\r\n    @memberSessions.fetch cache: false\r\n\r\n  sortMembers: (highestUserLevelCountMap, userConceptsMap) ->\r\n    # Progress sort precedence: most completed concepts, most started concepts, most levels, name sort\r\n    return unless @members? and @memberSort?\r\n    switch @memberSort\r\n      when \"nameDesc\"\r\n        @members.comparator = (a, b) -> return (b.get('name') or 'Anonymous').localeCompare(a.get('name') or 'Anonymous')\r\n      when \"progressAsc\"\r\n        @members.comparator = (a, b) ->\r\n          aComplete = (concept for concept, state of userConceptsMap[a.id] when state is 'complete')\r\n          bComplete = (concept for concept, state of userConceptsMap[b.id] when state is 'complete')\r\n          aStarted = (concept for concept, state of userConceptsMap[a.id] when state is 'started')\r\n          bStarted = (concept for concept, state of userConceptsMap[b.id] when state is 'started')\r\n          if aComplete < bComplete then return -1\r\n          else if aComplete > bComplete then return 1\r\n          else if aStarted < bStarted then return -1\r\n          else if aStarted > bStarted then return 1\r\n          if highestUserLevelCountMap[a.id] < highestUserLevelCountMap[b.id] then return -1\r\n          else if highestUserLevelCountMap[a.id] > highestUserLevelCountMap[b.id] then return 1\r\n          (a.get('name') or 'Anonymous').localeCompare(b.get('name') or 'Anonymous')\r\n      when \"progressDesc\"\r\n        @members.comparator = (a, b) ->\r\n          aComplete = (concept for concept, state of userConceptsMap[a.id] when state is 'complete')\r\n          bComplete = (concept for concept, state of userConceptsMap[b.id] when state is 'complete')\r\n          aStarted = (concept for concept, state of userConceptsMap[a.id] when state is 'started')\r\n          bStarted = (concept for concept, state of userConceptsMap[b.id] when state is 'started')\r\n          if aComplete > bComplete then return -1\r\n          else if aComplete < bComplete then return 1\r\n          else if aStarted > bStarted then return -1\r\n          else if aStarted < bStarted then return 1\r\n          if highestUserLevelCountMap[a.id] > highestUserLevelCountMap[b.id] then return -1\r\n          else if highestUserLevelCountMap[a.id] < highestUserLevelCountMap[b.id] then return 1\r\n          (b.get('name') or 'Anonymous').localeCompare(a.get('name') or 'Anonymous')\r\n      else\r\n        @members.comparator = (a, b) -> return (a.get('name') or 'Anonymous').localeCompare(b.get('name') or 'Anonymous')\r\n    @members.sort()\r\n\r\n  updateHeroIcons: ->\r\n    return unless @members?.models?\r\n    for member in @members.models\r\n      continue unless hero = member.get('heroConfig')?.thangType\r\n      for slug, original of ThangType.heroes when original is hero\r\n        @$el.find(\".player-hero-icon[data-memberID=#{member.id}]\").removeClass('.player-hero-icon').addClass('player-hero-icon ' + slug)\r\n\r\n  onCampaignSync: ->\r\n    return unless @campaigns.loaded\r\n    @campaignLevelProgressions = []\r\n    @conceptsProgression = []\r\n    @arenas = []\r\n    for campaign in @campaigns.models when campaign.get('type') is 'hero'\r\n      campaignLevelProgression =\r\n        ID: campaign.id\r\n        slug: campaign.get('slug')\r\n        name: utils.i18n(campaign.attributes, 'fullName') or utils.i18n(campaign.attributes, 'name')\r\n        levels: []\r\n      for levelID, level of campaign.get('levels')\r\n        campaignLevelProgression.levels.push\r\n          ID: levelID\r\n          slug: level.slug\r\n          name: utils.i18n level, 'name'\r\n        if level.concepts?\r\n          for concept in level.concepts\r\n            @conceptsProgression.push concept unless concept in @conceptsProgression\r\n        if level.type is 'hero-ladder' and level.slug not in ['capture-their-flag']  # Would use isType, but it's not a Level model\r\n          @arenas.push level\r\n      @campaignLevelProgressions.push campaignLevelProgression\r\n    @render?()\r\n\r\n  onClanSync: ->\r\n    unless @owner?\r\n      @owner = new User _id: @clan.get('ownerID')\r\n      @listenTo @owner, 'sync', => @render?()\r\n      @supermodel.loadModel @owner, cache: false\r\n    if @clan.get(\"dashboardType\") is \"premium\"\r\n      @supermodel.loadCollection(@memberSessions, 'member_sessions', {cache: false})\r\n    @render?()\r\n\r\n  onMembersSync: ->\r\n    @stats.averageLevel = Math.round(@members.reduce(((sum, member) -> sum + member.level()), 0) / @members.length)\r\n    @render?()\r\n\r\n  onMemberAchievementsSync: ->\r\n    @memberAchievementsMap = {}\r\n    for achievement in @memberAchievements.models\r\n      user = achievement.get('user')\r\n      @memberAchievementsMap[user] ?= []\r\n      @memberAchievementsMap[user].push achievement\r\n    for user of @memberAchievementsMap\r\n      @memberAchievementsMap[user].sort (a, b) -> b.id.localeCompare(a.id)\r\n    @stats.averageAchievements = Math.round(@memberAchievements.models.length / Object.keys(@memberAchievementsMap).length)\r\n    @render?()\r\n\r\n  onMemberSessionsSync: ->\r\n    @memberLevelMap = {}\r\n    memberSessions = {}\r\n    for levelSession in @memberSessions.models\r\n      continue if levelSession.isMultiplayer()\r\n      user = levelSession.get('creator')\r\n      levelSlug = levelSession.get('levelID')\r\n      @memberLevelMap[user] ?= {}\r\n      @memberLevelMap[user][levelSlug] ?= {}\r\n      levelInfo =\r\n        level: levelSession.get('levelName')\r\n        levelID: levelSession.get('levelID')\r\n        changed: new Date(levelSession.get('changed')).toLocaleString()\r\n        playtime: levelSession.get('playtime')\r\n        sessionID: levelSession.id\r\n      @memberLevelMap[user][levelSlug].levelInfo = levelInfo\r\n      if levelSession.get('state')?.complete is true\r\n        @memberLevelMap[user][levelSlug].state = 'complete'\r\n        memberSessions[user] ?= []\r\n        memberSessions[user].push levelSession\r\n      else\r\n        @memberLevelMap[user][levelSlug].state = 'started'\r\n    @memberMaxLevelCount = 0\r\n    @memberLanguageMap = {}\r\n    for user of memberSessions\r\n      languageCounts = {}\r\n      for levelSession in memberSessions[user]\r\n        language = levelSession.get('codeLanguage') or levelSession.get('submittedCodeLanguage')\r\n        languageCounts[language] = (languageCounts[language] or 0) + 1 if language\r\n      @memberMaxLevelCount = memberSessions[user].length if @memberMaxLevelCount < memberSessions[user].length\r\n      mostUsedCount = 0\r\n      for language, count of languageCounts\r\n        if count > mostUsedCount\r\n          mostUsedCount = count\r\n          @memberLanguageMap[user] = language\r\n    @render?()\r\n\r\n  onMouseEnterPoint: (e) ->\r\n    $('.level-popup-container').hide()\r\n    container = $(e.target).find('.level-popup-container').show()\r\n    margin = 20\r\n    offset = $(e.target).offset()\r\n    scrollTop = $(e.target).offsetParent().scrollTop()\r\n    height = container.outerHeight()\r\n    container.css('left', offset.left + e.offsetX)\r\n    container.css('top', offset.top + scrollTop - height - margin)\r\n\r\n  onMouseLeavePoint: (e) ->\r\n    $(e.target).find('.level-popup-container').hide()\r\n\r\n  onClickLevel: (e) ->\r\n    levelInfo = $(e.target).data 'level-info'\r\n    return unless levelInfo?.levelID? and levelInfo?.sessionID?\r\n    url = \"/play/level/#{levelInfo.levelID}?session=#{levelInfo.sessionID}&observing=true\"\r\n    window.open url, '_blank'\r\n\r\n  onDeleteClan: (e) ->\r\n    return @openModalView(new CreateAccountModal()) if me.isAnonymous()\r\n    return unless window.confirm(\"Delete Clan?\")\r\n    options =\r\n      url: \"/db/clan/#{@clanID}\"\r\n      method: 'DELETE'\r\n      error: (model, response, options) =>\r\n        console.error 'Error joining clan', response\r\n      success: (model, response, options) =>\r\n        app.router.navigate \"/clans\"\r\n        window.location.reload()\r\n    @supermodel.addRequestResource( 'delete_clan', options).load()\r\n\r\n  onEditDescriptionSave: (e) ->\r\n    description = $('.edit-description-input').val()\r\n    @clan.set 'description', description\r\n    @clan.patch()\r\n    $('#editDescriptionModal').modal('hide')\r\n\r\n  onEditNameSave: (e) ->\r\n    if name = $('.edit-name-input').val()\r\n      @clan.set 'name', name\r\n      @clan.patch()\r\n    $('#editNameModal').modal('hide')\r\n\r\n  onExpandedProgressCheckbox: (e) ->\r\n    @showExpandedProgress = $('.expand-progress-checkbox').prop('checked')\r\n    # TODO: why does render reset the checkbox to be unchecked?\r\n    @render?()\r\n    $('.expand-progress-checkbox').attr('checked', @showExpandedProgress)\r\n\r\n  onJoinClan: (e) ->\r\n    return @openModalView(new CreateAccountModal()) if me.isAnonymous()\r\n    return unless @clan.loaded\r\n    if @clan.get('type') is 'private' and not me.isPremium()\r\n      @openModalView new SubscribeModal()\r\n      window.tracker?.trackEvent 'Show subscription modal', category: 'Subscription', label: 'join clan'\r\n      return\r\n    options =\r\n      url: \"/db/clan/#{@clanID}/join\"\r\n      method: 'PUT'\r\n      error: (model, response, options) =>\r\n        console.error 'Error joining clan', response\r\n      success: (model, response, options) => @refreshData()\r\n    @supermodel.addRequestResource( 'join_clan', options).load()\r\n\r\n  onLeaveClan: (e) ->\r\n    options =\r\n      url: \"/db/clan/#{@clanID}/leave\"\r\n      method: 'PUT'\r\n      error: (model, response, options) =>\r\n        console.error 'Error leaving clan', response\r\n      success: (model, response, options) => @refreshData()\r\n    @supermodel.addRequestResource( 'leave_clan', options).load()\r\n\r\n  onClickMemberHeader: (e) ->\r\n    @memberSort = if @memberSort is 'nameAsc' then 'nameDesc' else 'nameAsc'\r\n    @render?()\r\n\r\n  onClickProgressHeader: (e) ->\r\n    @memberSort = if @memberSort is 'progressAsc' then 'progressDesc' else 'progressAsc'\r\n    @render?()\r\n\r\n  onRemoveMember: (e) ->\r\n    return unless window.confirm(\"Remove Hero?\")\r\n    if memberID = $(e.target).data('id')\r\n      options =\r\n        url: \"/db/clan/#{@clanID}/remove/#{memberID}\"\r\n        method: 'PUT'\r\n        error: (model, response, options) =>\r\n          console.error 'Error removing clan member', response\r\n        success: (model, response, options) => @refreshData()\r\n      @supermodel.addRequestResource( 'remove_member', options).load()\r\n    else\r\n      console.error \"No member ID attached to remove button.\"\r\n"]}