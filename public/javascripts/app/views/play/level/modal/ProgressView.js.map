{"version":3,"sources":["app/templates/play/level/modal/progress-view.jade","app/views/play/level/modal/ProgressView.coffee"],"names":[],"mappings":"AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7EA;AAAA;;ACAA;EAAA;;;AAAA,WAAW,QAAQ,qBAAR;;AACX,QAAQ,QAAQ,YAAR;;AACR,OAAO,QAAQ,WAAR;;AAEP,MAAM,CAAC,OAAP,GAAuB;;;;;;;yBAErB,KAAI;;yBACJ,YAAW;;yBACX,WAAU,QAAQ,0CAAR;;yBAEV,SACE;IAAA,mBAAmB,mBAAnB;IACA,yBAAyB,wBADzB;IAEA,qBAAqB,qBAFrB;IAGA,0BAA0B,yBAH1B;;;yBAKF,aAAY,SAAC,OAAD;IACV,IAAC,MAAD,GAAS,OAAO,CAAC;IACjB,IAAC,OAAD,GAAU,OAAO,CAAC;IAClB,IAAC,UAAD,GAAa,OAAO,CAAC;IACrB,IAAC,UAAD,GAAa,OAAO,CAAC;IACrB,IAAC,cAAD,GAAiB,OAAO,CAAC;IACzB,IAAC,QAAD,GAAW,OAAO,CAAC;IAGnB,IAAC,UAAS,CAAC,GAAX,CAAe,aAAf,EAA8B,IAA9B;IACA,IAAC,qBAAD,GAAwB,OAAO,KAAK,CAAC,IAAN,CAAW,IAAC,UAAS,CAAC,sBAAtB,EAA8C,aAA9C,CAA4D,CAAC,OAA7D,CAAqE,qBAArE,EAA4F,EAA5F,CAAP;IACxB,IAAG,IAAC,MAAK,CAAC,GAAP,CAAW,WAAX,MAA2B,SAA9B;aACE,IAAC,SAAD,GAAY,IAAI,CAAC,YAAL,CAAkB;QAAE,OAAD,IAAC,MAAF;QAAU,SAAD,IAAC,QAAV;QAAoB,QAAD,IAAC,OAApB;OAAlB,EADd;;EAXU;;yBAcZ,oBAAmB;WACjB,IAAC,QAAD,CAAS,MAAT;EADiB;;yBAGnB,yBAAwB;WACtB,IAAC,QAAD,CAAS,YAAT;EADsB;;yBAGxB,sBAAqB;WACnB,IAAC,QAAD,CAAS,QAAT;EADmB;;yBAGrB,0BAAyB;AACvB;IAAA,IAAG,CAAC,CAAC,MAAM,CAAC,UAAT,CAAoB,IAAC,OAAM,CAAC,GAAR,CAAY,MAAZ,CAApB,EAAyC,UAAzC,CAAH;MACE,OAAO;MACP,WAAW,UAFb;KAAA;MAIE,OAAO;MACP,WAAW,SALb;;IAMA,kBAAkB;MAChB,SAAS,IAAC,MAAK,CAAC,EADA;MAEhB,WAAW,IAAC,MAAK,CAAC,GAAP,CAAW,MAAX,CAFK;MAGhB,aAAa,IAAC,UAAS,CAAC,EAHR;MAIhB,UAAU,IAAC,OAAM,CAAC,EAJF;MAKhB,kBALgB;;;SAOJ,CAAE,UAAhB,CAA2B,IAA3B,EAAiC,eAAjC,EAAkD,CAAC,UAAD,CAAlD;;IACA,IAAC,EAAD,CAAG,oBAAH,CAAwB,CAAC,GAAzB,CAA6B,IAAC,SAA9B,CAAuC,CAAC,MAAxC;WACA,IAAC,QAAD;EAhBuB;;;;GAnCiB","file":"public/javascripts/app/views/play/level/modal/ProgressView.js","sourcesContent":["var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,i18n = locals_.i18n,me = locals_.me;buf.push(\"<div class=\\\"modal-header\\\"><div id=\\\"close-modal\\\" data-dismiss=\\\"modal\\\" class=\\\"btn well well-sm well-parchment\\\"><span class=\\\"glyphicon glyphicon-remove\\\"></span></div><div class=\\\"well well-sm well-parchment\\\"><h1 data-i18n=\\\"play_level.level_complete\\\"></h1></div></div><div class=\\\"modal-body\\\"><div class=\\\"container-fluid\\\"><div class=\\\"row\\\">\");\nvar colClass = !view.nextLevel.isNew() ? 'col-sm-7' : 'col-sm-12'\nbuf.push(\"<div\" + (jade.attrs({ \"class\": [(colClass)] }, {\"class\":true})) + \"><div class=\\\"well well-sm well-parchment\\\"><h3 data-i18n=\\\"play_level.completed_level\\\" class=\\\"text-uppercase\\\"></h3><h2 class=\\\"text-uppercase text-center\\\">\" + (jade.escape(null == (jade.interp = i18n(view.level.attributes, 'name')) ? \"\" : jade.interp)) + \"</h2></div><div class=\\\"well well-sm well-parchment\\\">\");\nif ( me.isSessionless())\n{\nbuf.push(\"<h3 class=\\\"course-title\\\"><span data-i18n=\\\"play_level.course\\\" class=\\\"text-uppercase spr\\\"></span><span class=\\\"text-uppercase text-center\\\">\" + (jade.escape(null == (jade.interp = i18n(view.course.attributes, 'name')) ? \"\" : jade.interp)) + \"</span></h3><span data-i18n=\\\"play_level.victory_no_progress_for_teachers\\\"></span>\");\n}\nelse\n{\nbuf.push(\"<h3 data-i18n=\\\"play_level.course\\\" class=\\\"text-uppercase\\\"></h3><div class=\\\"row\\\"><div class=\\\"col-sm-8\\\"><h3 class=\\\"text-uppercase text-center\\\">\" + (jade.escape(null == (jade.interp = i18n(view.course.attributes, 'name')) ? \"\" : jade.interp)) + \"</h3></div><div class=\\\"col-sm-4\\\">\");\nvar stats = view.classroom.statsForSessions(view.levelSessions, view.course.id)\nbuf.push(\"<h1><span>\" + (jade.escape((jade.interp = stats.levels.numDone) == null ? '' : jade.interp)) + \"/\" + (jade.escape((jade.interp = stats.levels.size) == null ? '' : jade.interp)) + \"</span></h1></div></div>\");\n}\nbuf.push(\"</div></div>\");\nif ( !view.nextLevel.isNew())\n{\nbuf.push(\"<div class=\\\"col-sm-5\\\"><div class=\\\"well well-sm well-parchment\\\"><h3 class=\\\"text-uppercase\\\"><span data-i18n=\\\"play_level.next_level\\\"></span><span>:</span></h3><h2 class=\\\"text-uppercase\\\">\" + (jade.escape(null == (jade.interp = i18n(view.nextLevel.attributes, 'name').replace('Course: ', '')) ? \"\" : jade.interp)) + \"</h2><div class=\\\"next-level-description\\\">\" + (null == (jade.interp = view.nextLevelDescription) ? \"\" : jade.interp) + \"</div></div></div>\");\n}\nbuf.push(\"</div>\");\nif ( view.shareURL)\n{\nbuf.push(\"<div class=\\\"well well-sm well-parchment\\\"><h3 class=\\\"text-uppercase\\\">\");\nif ( view.level.isType('game-dev'))\n{\nbuf.push(\"<span data-i18n=\\\"sharing.share_game\\\"></span>\");\n}\nelse\n{\nbuf.push(\"<span data-i18n=\\\"sharing.share_web\\\"></span>\");\n}\nbuf.push(\"</h3><p><span data-i18n=\\\"sharing.victory_course_share_prefix\\\"></span><span>\" + (jade.escape(null == (jade.interp = ' ') ? \"\" : jade.interp)) + \"</span><a\" + (jade.attrs({ 'href':(view.shareURL), 'target':('_blank') }, {\"href\":true,\"target\":true})) + \">\");\nif ( view.level.isType('game-dev'))\n{\nbuf.push(\"<span data-i18n=\\\"sharing.victory_course_share_game\\\"></span>\");\n}\nelse\n{\nbuf.push(\"<span data-i18n=\\\"sharing.victory_course_share_web\\\"></span>\");\n}\nbuf.push(\"</a><span>\" + (jade.escape(null == (jade.interp = ' ') ? \"\" : jade.interp)) + \"</span><span data-i18n=\\\"sharing.victory_course_share_suffix\\\"></span></p>\");\nif ( view.session.isFake())\n{\nbuf.push(\"<div data-i18n=\\\"sharing.unavailable\\\" class=\\\"alert alert-warning\\\"></div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"row\\\"><div class=\\\"col-sm-9\\\"><input\" + (jade.attrs({ 'id':('share-level-input'), 'value':(view.shareURL), \"class\": [('text-h4'),('semibold'),('form-control'),('input-lg')] }, {\"value\":true})) + \"/></div><div class=\\\"col-sm-3\\\"><button id=\\\"share-level-btn\\\" class=\\\"btn btn-lg btn-success btn-illustrated\\\"><span data-i18n=\\\"sharing.copy_url\\\"></span></button></div></div>\");\n}\nbuf.push(\"</div>\");\n}\nbuf.push(\"<div class=\\\"row\\\"><div class=\\\"col-sm-5 col-sm-offset-2\\\"><!-- TODO: Add rest of campaign functionality-->\");\nif ( view.level.get('type') === 'course-ladder')\n{\nbuf.push(\"<button id=\\\"ladder-btn\\\" class=\\\"btn btn-illustrated btn-default btn-block btn-lg text-uppercase\\\">Ladder</button>\");\n}\nbuf.push(\"</div><div class=\\\"col-sm-5\\\">\");\nif ( !view.nextLevel.isNew())\n{\nbuf.push(\"<button id=\\\"next-level-btn\\\" data-i18n=\\\"play_level.next_level\\\" class=\\\"btn btn-illustrated btn-primary btn-block btn-lg text-uppercase\\\"></button>\");\n}\nelse\n{\nbuf.push(\"<button id=\\\"done-btn\\\" data-i18n=\\\"play_level.done\\\" class=\\\"btn btn-illustrated btn-primary btn-block btn-lg text-uppercase\\\"></button>\");\n}\nbuf.push(\"</div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","CocoView = require 'views/core/CocoView'\r\nutils = require 'core/utils'\r\nurls = require 'core/urls'\r\n\r\nmodule.exports = class ProgressView extends CocoView\r\n\r\n  id: 'progress-view'\r\n  className: 'modal-content'\r\n  template: require 'templates/play/level/modal/progress-view'\r\n\r\n  events:\r\n    'click #done-btn': 'onClickDoneButton'\r\n    'click #next-level-btn': 'onClickNextLevelButton'\r\n    'click #ladder-btn': 'onClickLadderButton'\r\n    'click #share-level-btn': 'onClickShareLevelButton'\r\n\r\n  initialize: (options) ->\r\n    @level = options.level\r\n    @course = options.course\r\n    @classroom = options.classroom\r\n    @nextLevel = options.nextLevel\r\n    @levelSessions = options.levelSessions\r\n    @session = options.session\r\n    # Translate and Markdownify level description, but take out any images (we don't have room for arena banners, etc.).\r\n    # Images in Markdown are like ![description](url)\r\n    @nextLevel.get('description', true)  # Make sure the defaults are available\r\n    @nextLevelDescription = marked(utils.i18n(@nextLevel.attributesWithDefaults, 'description').replace(/!\\[.*?\\]\\(.*?\\)\\n*/g, ''))\r\n    if @level.get('shareable') is 'project'\r\n      @shareURL = urls.playDevLevel({@level, @session, @course})\r\n\r\n  onClickDoneButton: ->\r\n    @trigger 'done'\r\n\r\n  onClickNextLevelButton: ->\r\n    @trigger 'next-level'\r\n\r\n  onClickLadderButton: ->\r\n    @trigger 'ladder'\r\n\r\n  onClickShareLevelButton: ->\r\n    if _.string.startsWith(@course.get('slug'), 'game-dev')\r\n      name = 'Student Game Dev - Copy URL'\r\n      category = 'GameDev'\r\n    else\r\n      name = 'Student Web Dev - Copy URL'\r\n      category = 'WebDev'\r\n    eventProperties = {\r\n      levelID: @level.id\r\n      levelSlug: @level.get('slug')\r\n      classroomID: @classroom.id\r\n      courseID: @course.id\r\n      category\r\n    }\r\n    window.tracker?.trackEvent name, eventProperties, ['MixPanel']\r\n    @$('#share-level-input').val(@shareURL).select()\r\n    @tryCopy()\r\n"]}