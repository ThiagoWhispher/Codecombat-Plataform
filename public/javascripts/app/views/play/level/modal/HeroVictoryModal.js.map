{"version":3,"sources":["app/templates/play/level/modal/hero-victory-modal.jade","app/views/play/level/modal/HeroVictoryModal.coffee"],"names":[],"mappings":"AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApXA;AAAA;;ACAA;EAAA;;;;;AAAA,YAAY,QAAQ,sBAAR;;AACZ,qBAAqB,QAAQ,+BAAR;;AACrB,WAAW,QAAQ,+CAAR;;AACX,cAAc,QAAQ,oBAAR;;AACd,oBAAoB,QAAQ,0BAAR;;AACpB,iBAAiB,QAAQ,4BAAR;;AACjB,aAAa,QAAQ,gBAAR;;AACb,QAAQ,QAAQ,YAAR;;AACR,YAAY,QAAQ,kBAAR;;AACZ,uBAAuB,QAAQ,wCAAR;;AACvB,cAAc,QAAQ,iBAAR;;AACd,OAAO,QAAQ,aAAR;;AACP,QAAQ,QAAQ,YAAR;;AACR,SAAS,QAAQ,eAAR;;AACT,QAAQ,QAAQ,cAAR;;AACR,gBAAgB,QAAQ,sBAAR;;AAChB,UAAU,QAAQ,cAAR;;AAEV,MAAM,CAAC,OAAP,GAAuB;;;6BACrB,KAAI;;6BACJ,WAAU;;6BACV,cAAa;;6BACb,uBAAsB;;6BAEtB,gBACE;IAAA,yBAAyB,iBAAzB;;;6BAEF,SA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","file":"public/javascripts/app/views/play/level/modal/HeroVictoryModal.js","sourcesContent":["var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,me = locals_.me,victoryText = locals_.victoryText,isCourseLevel = locals_.isCourseLevel,currentCourseName = locals_.currentCourseName,currentLevelName = locals_.currentLevelName,nextLevelName = locals_.nextLevelName,level = locals_.level,achievements = locals_.achievements,thangTypes = locals_.thangTypes,i18n = locals_.i18n,features = locals_.features,readyToRank = locals_.readyToRank,showHourOfCodeDoneButton = locals_.showHourOfCodeDoneButton,showLeaderboard = locals_.showLeaderboard,showReturnToCourse = locals_.showReturnToCourse,document = locals_.document;buf.push(\"<div class=\\\"modal-dialog game\\\"><div class=\\\"background-wrapper\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nbuf.push(\"<div id=\\\"victory-header\\\" class=\\\"out\\\"><div id=\\\"victory-title\\\">\");\nif ( !me.get('preferredLanguage') || me.get('preferredLanguage').split('-')[0] == 'en')\n{\nbuf.push(\"<img src=\\\"/images/pages/play/level/modal/victory_word.png\\\" draggable=\\\"false\\\"/>\");\n}\nelse\n{\nbuf.push(\"<h1 data-i18n=\\\"play_level.victory\\\">Victory</h1>\");\n}\nbuf.push(\"</div></div></div><div class=\\\"modal-body\\\">\");\nif ( victoryText)\n{\nbuf.push(\"<div id=\\\"victory-text\\\">\" + (jade.escape(null == (jade.interp = victoryText) ? \"\" : jade.interp)) + \"</div>\");\n}\nif ( isCourseLevel)\n{\nbuf.push(\"<div class=\\\"course-name-container\\\">\");\nif ( currentCourseName)\n{\nbuf.push(\"<p><span data-i18n=\\\"play_level.course\\\" class=\\\"spr level-title\\\"></span><span class=\\\"level-name\\\">\" + (jade.escape(null == (jade.interp = currentCourseName) ? \"\" : jade.interp)) + \"</span></p>\");\n}\nbuf.push(\"</div><div class=\\\"container-fluid\\\"><div class=\\\"row\\\"><div class=\\\"col-md-6\\\">\");\nif ( currentLevelName)\n{\nbuf.push(\"<div data-i18n=\\\"play_level.completed_level\\\" class=\\\"level-title\\\"></div><div class=\\\"level-name\\\">\" + (jade.escape(null == (jade.interp = currentLevelName.replace('Course: ', '')) ? \"\" : jade.interp)) + \"</div>\");\n}\nbuf.push(\"</div><div class=\\\"col-md-6\\\">\");\nif ( nextLevelName)\n{\nbuf.push(\"<div data-i18n=\\\"play_level.next_level\\\" class=\\\"level-title\\\"></div><div class=\\\"level-name\\\">\" + (jade.escape(null == (jade.interp = nextLevelName.replace('Course: ', '')) ? \"\" : jade.interp)) + \"</div>\");\n}\nelse\n{\nbuf.push(\"<div data-i18n=\\\"play_level.course\\\" class=\\\"level-title\\\"></div><div data-i18n=\\\"play_level.victory_title_suffix\\\" class=\\\"level-name\\\"></div>\");\n}\nbuf.push(\"</div></div></div><br/>\");\n}\nbuf.push(\"<div id=\\\"level-feedback\\\"><div class=\\\"rating secret\\\"><div data-i18n=\\\"play_level.victory_rate_the_level\\\" class=\\\"rating-label\\\">Rate the level:</div><i class=\\\"glyphicon glyphicon-star-empty\\\"></i><i class=\\\"glyphicon glyphicon-star-empty\\\"></i><i class=\\\"glyphicon glyphicon-star-empty\\\"></i><i class=\\\"glyphicon glyphicon-star-empty\\\"></i><i class=\\\"glyphicon glyphicon-star-empty\\\"></i></div>\");\nif ( !me.get('anonymous'))\n{\nbuf.push(\"<span data-i18n=\\\"play_level.victory_review\\\" class=\\\"review-label secret\\\">Tell us more!</span><div class=\\\"review secret\\\"><br/><textarea data-i18n=\\\"[placeholder]play_level.victory_review_placeholder\\\"></textarea></div>\");\n}\nbuf.push(\"<div class=\\\"clearfix\\\"></div></div>\");\nif ( level.isType('hero', 'hero-ladder', 'game-dev', 'web-dev'))\n{\n// iterate achievements\n;(function(){\n  var $$obj = achievements;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var achievement = $$obj[$index];\n\nif ( achievement.get('hidden'))\n{\ncontinue;\n}\nvar animate = achievement.completed && !achievement.completedAWhileAgo\nbuf.push(\"<div\" + (jade.attrs({ 'data-achievement-id':(achievement.id), 'data-animate':(animate), \"class\": [('achievement-panel'),(achievement.completedAWhileAgo ? 'earned' : '')] }, {\"class\":true,\"data-achievement-id\":true,\"data-animate\":true})) + \">\");\nvar rewards = achievement.get('rewards') || {};\nbuf.push(\"<div class=\\\"achievement-description\\\">\" + (jade.escape(null == (jade.interp = achievement.description) ? \"\" : jade.interp)) + \"</div><div class=\\\"achievement-rewards\\\">\");\nvar worth = achievement.worth;\nvar previousWorth = achievement.previousWorth;\nvar gems = achievement.gems;\nvar previousGems = achievement.previousGems;\nif ( worth)\n{\nbuf.push(\"<div\" + (jade.attrs({ 'data-number':(worth), 'data-number-unit':('xp'), 'data-previous-number':(previousWorth || 0), \"class\": [('reward-panel'),('numerical'),('xp')] }, {\"data-number\":true,\"data-number-unit\":true,\"data-previous-number\":true})) + \"><div\" + (jade.attrs({ \"class\": [('reward-image-container'),(animate ? 'pending-reward-image' : 'show')] }, {\"class\":true})) + \"><img src=\\\"/images/pages/play/level/modal/reward_icon_xp.png\\\"/></div><div class=\\\"reward-text\\\">\" + (jade.escape(null == (jade.interp = animate ? '+0' : '+'+worth) ? \"\" : jade.interp)) + \"</div></div>\");\n}\nif ( gems)\n{\nbuf.push(\"<div\" + (jade.attrs({ 'data-number':(gems), 'data-number-unit':('gem'), 'data-previous-number':(previousGems || 0), \"class\": [('reward-panel'),('numerical'),('gems')] }, {\"data-number\":true,\"data-number-unit\":true,\"data-previous-number\":true})) + \"><div\" + (jade.attrs({ \"class\": [('reward-image-container'),(animate ? 'pending-reward-image' : 'show')] }, {\"class\":true})) + \"><img src=\\\"/images/pages/play/level/modal/reward_icon_gems.png\\\"/></div><div class=\\\"reward-text\\\">\" + (jade.escape(null == (jade.interp = animate ? '+0' : '+'+gems) ? \"\" : jade.interp)) + \"</div></div>\");\n}\nif ( rewards.heroes)\n{\n// iterate rewards.heroes\n;(function(){\n  var $$obj = rewards.heroes;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var hero = $$obj[$index];\n\nvar hero = thangTypes[hero];\nbuf.push(\"<div\" + (jade.attrs({ 'data-hero-thang-type':(hero.get('original')), \"class\": [('reward-panel'),('hero')] }, {\"data-hero-thang-type\":true})) + \"><div\" + (jade.attrs({ \"class\": [('reward-image-container'),(animate ? 'pending-reward-image' : 'show')] }, {\"class\":true})) + \"><img\" + (jade.attrs({ 'src':(hero.getPortraitURL()) }, {\"src\":true})) + \"/></div>\");\nif ( animate)\n{\nbuf.push(\"<div data-i18n=\\\"play_level.victory_new_hero\\\" class=\\\"reward-text\\\">New Hero</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"reward-text\\\">\" + (jade.escape(null == (jade.interp = i18n(hero.attributes, 'name')) ? \"\" : jade.interp)) + \"</div>\");\n}\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var hero = $$obj[$index];\n\nvar hero = thangTypes[hero];\nbuf.push(\"<div\" + (jade.attrs({ 'data-hero-thang-type':(hero.get('original')), \"class\": [('reward-panel'),('hero')] }, {\"data-hero-thang-type\":true})) + \"><div\" + (jade.attrs({ \"class\": [('reward-image-container'),(animate ? 'pending-reward-image' : 'show')] }, {\"class\":true})) + \"><img\" + (jade.attrs({ 'src':(hero.getPortraitURL()) }, {\"src\":true})) + \"/></div>\");\nif ( animate)\n{\nbuf.push(\"<div data-i18n=\\\"play_level.victory_new_hero\\\" class=\\\"reward-text\\\">New Hero</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"reward-text\\\">\" + (jade.escape(null == (jade.interp = i18n(hero.attributes, 'name')) ? \"\" : jade.interp)) + \"</div>\");\n}\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\n}\nif ( rewards.items)\n{\n// iterate rewards.items\n;(function(){\n  var $$obj = rewards.items;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var item = $$obj[$index];\n\nvar item = thangTypes[item];\nbuf.push(\"<div\" + (jade.attrs({ 'data-item-thang-type':(item.get('original')), \"class\": [('reward-panel'),('item')] }, {\"data-item-thang-type\":true})) + \"><div\" + (jade.attrs({ \"class\": [('reward-image-container'),(animate ? 'pending-reward-image' : 'show')] }, {\"class\":true})) + \"><img\" + (jade.attrs({ 'src':(item.getPortraitURL()) }, {\"src\":true})) + \"/></div>\");\nif ( animate)\n{\nbuf.push(\"<div data-i18n=\\\"play_level.victory_new_item\\\" class=\\\"reward-text\\\">New Item</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"reward-text\\\">\" + (jade.escape(null == (jade.interp = i18n(item.attributes, 'name')) ? \"\" : jade.interp)) + \"</div>\");\n}\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var item = $$obj[$index];\n\nvar item = thangTypes[item];\nbuf.push(\"<div\" + (jade.attrs({ 'data-item-thang-type':(item.get('original')), \"class\": [('reward-panel'),('item')] }, {\"data-item-thang-type\":true})) + \"><div\" + (jade.attrs({ \"class\": [('reward-image-container'),(animate ? 'pending-reward-image' : 'show')] }, {\"class\":true})) + \"><img\" + (jade.attrs({ 'src':(item.getPortraitURL()) }, {\"src\":true})) + \"/></div>\");\nif ( animate)\n{\nbuf.push(\"<div data-i18n=\\\"play_level.victory_new_item\\\" class=\\\"reward-text\\\">New Item</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"reward-text\\\">\" + (jade.escape(null == (jade.interp = i18n(item.attributes, 'name')) ? \"\" : jade.interp)) + \"</div>\");\n}\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\n}\nbuf.push(\"</div></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var achievement = $$obj[$index];\n\nif ( achievement.get('hidden'))\n{\ncontinue;\n}\nvar animate = achievement.completed && !achievement.completedAWhileAgo\nbuf.push(\"<div\" + (jade.attrs({ 'data-achievement-id':(achievement.id), 'data-animate':(animate), \"class\": [('achievement-panel'),(achievement.completedAWhileAgo ? 'earned' : '')] }, {\"class\":true,\"data-achievement-id\":true,\"data-animate\":true})) + \">\");\nvar rewards = achievement.get('rewards') || {};\nbuf.push(\"<div class=\\\"achievement-description\\\">\" + (jade.escape(null == (jade.interp = achievement.description) ? \"\" : jade.interp)) + \"</div><div class=\\\"achievement-rewards\\\">\");\nvar worth = achievement.worth;\nvar previousWorth = achievement.previousWorth;\nvar gems = achievement.gems;\nvar previousGems = achievement.previousGems;\nif ( worth)\n{\nbuf.push(\"<div\" + (jade.attrs({ 'data-number':(worth), 'data-number-unit':('xp'), 'data-previous-number':(previousWorth || 0), \"class\": [('reward-panel'),('numerical'),('xp')] }, {\"data-number\":true,\"data-number-unit\":true,\"data-previous-number\":true})) + \"><div\" + (jade.attrs({ \"class\": [('reward-image-container'),(animate ? 'pending-reward-image' : 'show')] }, {\"class\":true})) + \"><img src=\\\"/images/pages/play/level/modal/reward_icon_xp.png\\\"/></div><div class=\\\"reward-text\\\">\" + (jade.escape(null == (jade.interp = animate ? '+0' : '+'+worth) ? \"\" : jade.interp)) + \"</div></div>\");\n}\nif ( gems)\n{\nbuf.push(\"<div\" + (jade.attrs({ 'data-number':(gems), 'data-number-unit':('gem'), 'data-previous-number':(previousGems || 0), \"class\": [('reward-panel'),('numerical'),('gems')] }, {\"data-number\":true,\"data-number-unit\":true,\"data-previous-number\":true})) + \"><div\" + (jade.attrs({ \"class\": [('reward-image-container'),(animate ? 'pending-reward-image' : 'show')] }, {\"class\":true})) + \"><img src=\\\"/images/pages/play/level/modal/reward_icon_gems.png\\\"/></div><div class=\\\"reward-text\\\">\" + (jade.escape(null == (jade.interp = animate ? '+0' : '+'+gems) ? \"\" : jade.interp)) + \"</div></div>\");\n}\nif ( rewards.heroes)\n{\n// iterate rewards.heroes\n;(function(){\n  var $$obj = rewards.heroes;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var hero = $$obj[$index];\n\nvar hero = thangTypes[hero];\nbuf.push(\"<div\" + (jade.attrs({ 'data-hero-thang-type':(hero.get('original')), \"class\": [('reward-panel'),('hero')] }, {\"data-hero-thang-type\":true})) + \"><div\" + (jade.attrs({ \"class\": [('reward-image-container'),(animate ? 'pending-reward-image' : 'show')] }, {\"class\":true})) + \"><img\" + (jade.attrs({ 'src':(hero.getPortraitURL()) }, {\"src\":true})) + \"/></div>\");\nif ( animate)\n{\nbuf.push(\"<div data-i18n=\\\"play_level.victory_new_hero\\\" class=\\\"reward-text\\\">New Hero</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"reward-text\\\">\" + (jade.escape(null == (jade.interp = i18n(hero.attributes, 'name')) ? \"\" : jade.interp)) + \"</div>\");\n}\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var hero = $$obj[$index];\n\nvar hero = thangTypes[hero];\nbuf.push(\"<div\" + (jade.attrs({ 'data-hero-thang-type':(hero.get('original')), \"class\": [('reward-panel'),('hero')] }, {\"data-hero-thang-type\":true})) + \"><div\" + (jade.attrs({ \"class\": [('reward-image-container'),(animate ? 'pending-reward-image' : 'show')] }, {\"class\":true})) + \"><img\" + (jade.attrs({ 'src':(hero.getPortraitURL()) }, {\"src\":true})) + \"/></div>\");\nif ( animate)\n{\nbuf.push(\"<div data-i18n=\\\"play_level.victory_new_hero\\\" class=\\\"reward-text\\\">New Hero</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"reward-text\\\">\" + (jade.escape(null == (jade.interp = i18n(hero.attributes, 'name')) ? \"\" : jade.interp)) + \"</div>\");\n}\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\n}\nif ( rewards.items)\n{\n// iterate rewards.items\n;(function(){\n  var $$obj = rewards.items;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var item = $$obj[$index];\n\nvar item = thangTypes[item];\nbuf.push(\"<div\" + (jade.attrs({ 'data-item-thang-type':(item.get('original')), \"class\": [('reward-panel'),('item')] }, {\"data-item-thang-type\":true})) + \"><div\" + (jade.attrs({ \"class\": [('reward-image-container'),(animate ? 'pending-reward-image' : 'show')] }, {\"class\":true})) + \"><img\" + (jade.attrs({ 'src':(item.getPortraitURL()) }, {\"src\":true})) + \"/></div>\");\nif ( animate)\n{\nbuf.push(\"<div data-i18n=\\\"play_level.victory_new_item\\\" class=\\\"reward-text\\\">New Item</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"reward-text\\\">\" + (jade.escape(null == (jade.interp = i18n(item.attributes, 'name')) ? \"\" : jade.interp)) + \"</div>\");\n}\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var item = $$obj[$index];\n\nvar item = thangTypes[item];\nbuf.push(\"<div\" + (jade.attrs({ 'data-item-thang-type':(item.get('original')), \"class\": [('reward-panel'),('item')] }, {\"data-item-thang-type\":true})) + \"><div\" + (jade.attrs({ \"class\": [('reward-image-container'),(animate ? 'pending-reward-image' : 'show')] }, {\"class\":true})) + \"><img\" + (jade.attrs({ 'src':(item.getPortraitURL()) }, {\"src\":true})) + \"/></div>\");\nif ( animate)\n{\nbuf.push(\"<div data-i18n=\\\"play_level.victory_new_item\\\" class=\\\"reward-text\\\">New Item</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"reward-text\\\">\" + (jade.escape(null == (jade.interp = i18n(item.attributes, 'name')) ? \"\" : jade.interp)) + \"</div>\");\n}\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\n}\nbuf.push(\"</div></div>\");\n    }\n\n  }\n}).call(this);\n\n}\nbuf.push(\"</div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><div id=\\\"totals\\\"><div id=\\\"xp-wrapper\\\" class=\\\"total-wrapper\\\"><div id=\\\"xp-total\\\" class=\\\"total-count\\\">0</div><div class=\\\"total-label\\\"><span data-i18n=\\\"play_level.victory_experience_gained\\\" class=\\\"spr\\\">XP Gained</span>-<span data-i18n=\\\"general.player_level\\\" class=\\\"spl spr\\\">Level</span><span class=\\\"level\\\">\" + (jade.escape(null == (jade.interp = me.level()) ? \"\" : jade.interp)) + \"</span></div><div class=\\\"xp-bar-outer\\\"><div class=\\\"xp-bar-already-achieved\\\"></div><div class=\\\"xp-bar-total\\\"></div></div></div><div id=\\\"gem-wrapper\\\" class=\\\"total-wrapper\\\"><div id=\\\"gem-total\\\" class=\\\"total-count\\\">0</div><div data-i18n=\\\"play_level.victory_gems_gained\\\" class=\\\"total-label\\\">Gems Gained</div></div></div>\");\nif ( view.shareURL)\n{\nbuf.push(\"<div id=\\\"share-level-container\\\"><span class=\\\"share-level-label\\\"><span data-i18n=\\\"sharing.victory_share_prefix\\\">Share this link to invite your friends & family to</span><span>\" + (jade.escape(null == (jade.interp = ' ') ? \"\" : jade.interp)) + \"</span><a\" + (jade.attrs({ 'href':(view.shareURL), 'target':('_blank') }, {\"href\":true,\"target\":true})) + \">\");\nif ( view.level.isType('game-dev'))\n{\nbuf.push(\"<span data-i18n=\\\"sharing.victory_share_game\\\">play your game level</span>\");\n}\nelse\n{\nbuf.push(\"<span data-i18n=\\\"sharing.victory_share_web\\\">view your webpage</span>\");\n}\nbuf.push(\"</a><span data-i18n=\\\"sharing.victory_share_suffix\\\"></span></span><div class=\\\"row\\\"><div class=\\\"col-sm-9\\\"><input\" + (jade.attrs({ 'id':('share-level-input'), 'value':(view.shareURL), \"class\": [('text-h4'),('semibold'),('form-control'),('input-md')] }, {\"value\":true})) + \"/></div><div class=\\\"col-sm-3\\\"><button id=\\\"share-level-btn\\\" class=\\\"btn btn-md btn-success btn-illustrated\\\"><span data-i18n=\\\"sharing.copy_url\\\">Copy URL</span></button></div></div></div>\");\n}\nif ( features.codePlay)\n{\nbuf.push(\"<img id=\\\"sweepstakes-entry\\\" src=\\\"/images/common/codeplay/SweepstakesEntry.png\\\"/>\");\n}\nif ( me.get('anonymous'))\n{\nbuf.push(\"<div class=\\\"sign-up-poke hide\\\"><div data-i18n=\\\"play_level.victory_sign_up_poke\\\" class=\\\"sign-up-blurb\\\">Want to save your code? Create a free account!</div><button data-dismiss=\\\"modal\\\" data-i18n=\\\"play_level.victory_sign_up\\\" class=\\\"btn btn-illustrated btn-warning sign-up-button btn-lg\\\">Sign Up to Save Progress</button></div>\");\n}\nbuf.push(\"<button id=\\\"saving-progress-label\\\" disabled=\\\"disabled\\\" data-i18n=\\\"play_level.victory_saving_progress\\\" class=\\\"btn btn-illustrated btn-lg btn-warning hide\\\">Saving Progress</button><div class=\\\"next-level-buttons\\\">\");\nif ( view.showHoc2016ExploreButton)\n{\nbuf.push(\"<button id=\\\"continue-button\\\" data-i18n=\\\"play_level.explore_codecombat\\\" class=\\\"btn btn-illustrated btn-success btn-lg world-map-button next-level-button hide\\\"></button>\");\n}\nelse if ( readyToRank)\n{\nbuf.push(\"<div class=\\\"ladder-submission-view\\\"></div>\");\n}\nelse if ( level.isType('hero-ladder'))\n{\nbuf.push(\"<button\" + (jade.attrs({ 'data-href':(\"/play/ladder/\" + (level.get('slug')) + \"#my-matches\"), 'data-dismiss':(\"modal\"), 'data-i18n':(\"play_level.victory_return_to_ladder\"), \"class\": [('btn'),('btn-illustrated'),('btn-primary'),('btn-lg'),('return-to-ladder-button')] }, {\"data-href\":true,\"data-dismiss\":true,\"data-i18n\":true})) + \">Return to Ladder</button>\");\n}\nelse\n{\nbuf.push(\"<button id=\\\"continue-button\\\" data-i18n=\\\"common.continue\\\" class=\\\"btn btn-illustrated btn-success btn-lg world-map-button next-level-button hide\\\">Continue</button>\");\n}\nbuf.push(\"</div>\");\nif ( !me.get('anonymous') && !showHourOfCodeDoneButton && !features.codePlay && showLeaderboard)\n{\nbuf.push(\"<button data-dismiss=\\\"modal\\\" data-i18n=\\\"leaderboard.view_other_solutions\\\" class=\\\"btn btn-illustrated btn-success leaderboard-button btn-lg\\\">View Other Solutions</button>\");\n}\nelse if ( showReturnToCourse)\n{\nbuf.push(\"<button data-dismiss=\\\"modal\\\" data-i18n=\\\"play_level.victory_go_home\\\" class=\\\"btn btn-illustrated btn-warning return-to-course-button btn-lg\\\">Go Home</button>\");\n}\nif ( showHourOfCodeDoneButton)\n{\nbuf.push(\"<div class=\\\"hour-of-code-done\\\"><div data-i18n=\\\"play_level.get_certificate\\\" class=\\\"hoc-label\\\"></div><a href=\\\"https://code.org/api/hour/finish\\\" data-i18n=\\\"play_level.finished_hoc\\\" class=\\\"btn btn-md btn-illustrated\\\"></a></div>\");\n}\nif ( view.level.get('slug') == 'lost-viking')\n{\nbuf.push(\"<div class=\\\"offer lost-viking\\\"><p><img src=\\\"/file/db/level/55144b509f0c4854051769c1/viking1.png\\\" class=\\\"pull-left\\\"/><img src=\\\"/file/db/level/55144b509f0c4854051769c1/viking_2.png\\\" class=\\\"pull-right\\\"/><span data-i18n=\\\"play_level.victory_viking_code_school\\\"></span></p><button data-i18n=\\\"play_level.victory_become_a_viking\\\" class=\\\"btn btn-illustrated btn-primary btn-lg world-map-button continue-from-offer-button\\\">Become a Viking</button></div>\");\n}\nif ( features.codePlay)\n{\nbuf.push(\"<a\" + (jade.attrs({ 'href':(document.location.protocol + \"//lenovogamestate.com/pages/products/\") }, {\"href\":true})) + \">\");\nvar url = \"/images/common/codeplay/NA_VictoryPage_Y710_735x100_VictoryPage.png\"\nif ( me.isFromUk())\n{\nurl = \"/images/common/codeplay/UK_VictoryPage_Miix510_735x100_VictoryPage.png\"\n}\nbuf.push(\"<img\" + (jade.attrs({ 'id':('lenovo-link'), 'src':(url) }, {\"src\":true})) + \"/></a>\");\n}\nbuf.push(\"</div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","ModalView = require 'views/core/ModalView'\r\nCreateAccountModal = require 'views/core/CreateAccountModal'\r\ntemplate = require 'templates/play/level/modal/hero-victory-modal'\r\nAchievement = require 'models/Achievement'\r\nEarnedAchievement = require 'models/EarnedAchievement'\r\nCocoCollection = require 'collections/CocoCollection'\r\nLocalMongo = require 'lib/LocalMongo'\r\nutils = require 'core/utils'\r\nThangType = require 'models/ThangType'\r\nLadderSubmissionView = require 'views/play/common/LadderSubmissionView'\r\nAudioPlayer = require 'lib/AudioPlayer'\r\nUser = require 'models/User'\r\nutils = require 'core/utils'\r\nCourse = require 'models/Course'\r\nLevel = require 'models/Level'\r\nLevelFeedback = require 'models/LevelFeedback'\r\nstorage = require 'core/storage'\r\n\r\nmodule.exports = class HeroVictoryModal extends ModalView\r\n  id: 'hero-victory-modal'\r\n  template: template\r\n  closeButton: false\r\n  closesOnClickOutside: false\r\n\r\n  subscriptions:\r\n    'ladder:game-submitted': 'onGameSubmitted'\r\n\r\n  events:\r\n    'click #continue-button': 'onClickContinue'\r\n    'click .leaderboard-button': 'onClickLeaderboard'\r\n    'click .return-to-course-button': 'onClickReturnToCourse'\r\n    'click .return-to-ladder-button': 'onClickReturnToLadder'\r\n    'click .sign-up-button': 'onClickSignupButton'\r\n    'click .continue-from-offer-button': 'onClickContinueFromOffer'\r\n    'click .skip-offer-button': 'onClickSkipOffer'\r\n    'click #share-level-btn': 'onClickShareLevelButton'\r\n\r\n    # Feedback events\r\n    'mouseover .rating i': (e) -> @showStars(@starNum($(e.target)))\r\n    'mouseout .rating i': -> @showStars()\r\n    'click .rating i': (e) ->\r\n      @setStars(@starNum($(e.target)))\r\n      @$el.find('.review, .review-label').show()\r\n    'keypress .review textarea': -> @saveReviewEventually()\r\n\r\n  constructor: (options) ->\r\n    super(options)\r\n    @courseID = options.courseID\r\n    @courseInstanceID = options.courseInstanceID\r\n\r\n    @session = options.session\r\n    @level = options.level\r\n    @thangTypes = {}\r\n    if @level.isType('hero', 'hero-ladder', 'course', 'course-ladder', 'game-dev', 'web-dev')\r\n      achievements = new CocoCollection([], {\r\n        url: \"/db/achievement?related=#{@session.get('level').original}\"\r\n        model: Achievement\r\n      })\r\n      @achievements = @supermodel.loadCollection(achievements, 'achievements').model\r\n      @listenToOnce @achievements, 'sync', @onAchievementsLoaded\r\n      @readyToContinue = false\r\n      @waitingToContinueSince = new Date()\r\n      @previousXP = me.get 'points', true\r\n      @previousLevel = me.level()\r\n    else\r\n      @readyToContinue = true\r\n    @playSound 'victory'\r\n    if @level.isType('course', 'course-ladder')\r\n      @saveReviewEventually = _.debounce(@saveReviewEventually, 2000)\r\n      @loadExistingFeedback()\r\n\r\n    if @level.get('shareable') is 'project'\r\n      @shareURL = \"#{window.location.origin}/play/#{@level.get('type')}-level/#{@level.get('slug')}/#{@session.id}\"\r\n\r\n  destroy: ->\r\n    clearInterval @sequentialAnimationInterval\r\n    @saveReview() if @$el.find('.review textarea').val()\r\n    @feedback?.off()\r\n    super()\r\n\r\n  onHidden: ->\r\n    Backbone.Mediator.publish 'music-player:exit-menu', {}\r\n    super()\r\n\r\n  loadExistingFeedback: ->\r\n    url = \"/db/level/#{@level.id}/feedback\"\r\n    @feedback = new LevelFeedback()\r\n    @feedback.setURL url\r\n    @feedback.fetch cache: false\r\n    @listenToOnce(@feedback, 'sync', -> @onFeedbackLoaded())\r\n    @listenToOnce(@feedback, 'error', -> @onFeedbackNotFound())\r\n\r\n  onFeedbackLoaded: ->\r\n    @feedback.url = -> '/db/level.feedback/' + @id\r\n    @$el.find('.review textarea').val(@feedback.get('review'))\r\n    @$el.find('.review, .review-label').show()\r\n    @showStars()\r\n\r\n  onFeedbackNotFound: ->\r\n    @feedback = new LevelFeedback()\r\n    @feedback.set('levelID', @level.get('slug') or @level.id)\r\n    @feedback.set('levelName', @level.get('name') or '')\r\n    @feedback.set('level', {majorVersion: @level.get('version').major, original: @level.get('original')})\r\n    @showStars()\r\n\r\n  onAchievementsLoaded: ->\r\n    @achievements.models = _.filter @achievements.models, (m) -> not m.get('query')?.ladderAchievementDifficulty  # Don't show higher AI difficulty achievements\r\n    @$el.toggleClass 'full-achievements', @achievements.models.length is 3\r\n    thangTypeOriginals = []\r\n    achievementIDs = []\r\n    for achievement in @achievements.models\r\n      rewards = achievement.get('rewards') or {}\r\n      thangTypeOriginals.push rewards.heroes or []\r\n      thangTypeOriginals.push rewards.items or []\r\n      achievement.completed = LocalMongo.matchesQuery(@session.attributes, achievement.get('query'))\r\n      achievementIDs.push(achievement.id) if achievement.completed\r\n\r\n    thangTypeOriginals = _.uniq _.flatten thangTypeOriginals\r\n    for thangTypeOriginal in thangTypeOriginals\r\n      thangType = new ThangType()\r\n      thangType.url = \"/db/thang.type/#{thangTypeOriginal}/version\"\r\n      #thangType.project = ['original', 'rasterIcon', 'name', 'soundTriggers', 'i18n']  # This is what we need, but the PlayHeroesModal needs more, and so we load more to fill up the supermodel.\r\n      thangType.project = ['original', 'rasterIcon', 'name', 'slug', 'soundTriggers', 'featureImages', 'gems', 'heroClass', 'description', 'components', 'extendedName', 'unlockLevelName', 'i18n']\r\n      @thangTypes[thangTypeOriginal] = @supermodel.loadModel(thangType).model\r\n\r\n    @newEarnedAchievements = []\r\n    hadOneCompleted = false\r\n    for achievement in @achievements.models\r\n      continue unless achievement.completed\r\n      hadOneCompleted = true\r\n      ea = new EarnedAchievement({\r\n        collection: achievement.get('collection')\r\n        triggeredBy: @session.id\r\n        achievement: achievement.id\r\n      })\r\n      ea.save()\r\n      @newEarnedAchievements.push ea\r\n      @listenToOnce ea, 'sync', ->\r\n        if _.all((ea.id for ea in @newEarnedAchievements))\r\n          @newEarnedAchievementsResource.markLoaded()\r\n          @listenToOnce me, 'sync', ->\r\n            @readyToContinue = true\r\n            @updateSavingProgressStatus()\r\n          me.fetch cache: false unless me.loading\r\n\r\n    @readyToContinue = true unless hadOneCompleted\r\n\r\n    # have to use a something resource because addModelResource doesn't handle models being upserted/fetched via POST like we're doing here\r\n    @newEarnedAchievementsResource = @supermodel.addSomethingResource('earned achievements') if @newEarnedAchievements.length\r\n\r\n  getRenderData: ->\r\n    c = super()\r\n    c.levelName = utils.i18n @level.attributes, 'name'\r\n    if @level.isType('hero', 'game-dev', 'web-dev')\r\n      c.victoryText = utils.i18n @level.get('victory') ? {}, 'body'\r\n    earnedAchievementMap = _.indexBy(@newEarnedAchievements or [], (ea) -> ea.get('achievement'))\r\n    for achievement in (@achievements?.models or [])\r\n      earnedAchievement = earnedAchievementMap[achievement.id]\r\n      if earnedAchievement\r\n        achievement.completedAWhileAgo = new Date().getTime() - Date.parse(earnedAchievement.attributes.changed) > 30 * 1000\r\n      achievement.worth = achievement.get 'worth', true\r\n      achievement.gems = achievement.get('rewards')?.gems\r\n    c.achievements = @achievements?.models.slice() or []\r\n    for achievement in c.achievements\r\n      achievement.description = utils.i18n achievement.attributes, 'description'\r\n      continue unless @supermodel.finished() and proportionalTo = achievement.get 'proportionalTo'\r\n      # For repeatable achievements, we modify their base worth/gems by their repeatable growth functions.\r\n      achievedAmount = utils.getByPath @session.attributes, proportionalTo\r\n      previousAmount = Math.max(0, achievedAmount - 1)\r\n      func = achievement.getExpFunction()\r\n      achievement.previousWorth = (achievement.get('worth') ? 0) * func previousAmount\r\n      achievement.worth = (achievement.get('worth') ? 0) * func achievedAmount\r\n      rewards = achievement.get 'rewards'\r\n      achievement.gems = rewards?.gems * func achievedAmount if rewards?.gems\r\n      achievement.previousGems = rewards?.gems * func previousAmount if rewards?.gems\r\n\r\n    # for testing the three states\r\n    #if c.achievements.length\r\n    #  c.achievements = [c.achievements[0].clone(), c.achievements[0].clone(), c.achievements[0].clone()]\r\n    #for achievement, index in c.achievements\r\n    ##  achievement.completed = index > 0\r\n    ##  achievement.completedAWhileAgo = index > 1\r\n    #  achievement.completed = true\r\n    #  achievement.completedAWhileAgo = false\r\n    #  achievement.attributes.worth = (index + 1) * achievement.get('worth', true)\r\n    #  rewards = achievement.get('rewards') or {}\r\n    #  rewards.gems *= (index + 1)\r\n\r\n    c.thangTypes = @thangTypes\r\n    c.me = me\r\n    c.readyToRank = @level.isType('hero-ladder', 'course-ladder') and @session.readyToRank()\r\n    c.level = @level\r\n    c.i18n = utils.i18n\r\n\r\n    elapsed = (new Date() - new Date(me.get('dateCreated')))\r\n    if me.get 'hourOfCode'\r\n      # Show the Hour of Code \"I'm Done\" tracking pixel after they played for 20 minutes\r\n      gameDevHoc = storage.load('should-return-to-game-dev-hoc')\r\n      lastLevelOriginal = if gameDevHoc then '57ee6f5786cf4e1f00afca2c' else '541c9a30c6362edfb0f34479'\r\n      lastLevel = @level.get('original') is lastLevelOriginal # hoc2016 or kithgard-gates\r\n      enough = elapsed >= 20 * 60 * 1000 or lastLevel\r\n      tooMuch = elapsed > 120 * 60 * 1000\r\n      showDone = (elapsed >= 30 * 60 * 1000 and not tooMuch) or lastLevel\r\n      if enough and not tooMuch and not me.get('hourOfCodeComplete')\r\n        pixelCode = if gameDevHoc then 'code_combat_gamedev' else 'code_combat'\r\n        $('body').append($(\"<img src='https://code.org/api/hour/finish_#{pixelCode}.png' style='visibility: hidden;'>\"))\r\n        me.set 'hourOfCodeComplete', true\r\n        me.patch()\r\n        window.tracker?.trackEvent 'Hour of Code Finish'\r\n      # Show the \"I'm done\" button between 30 - 120 minutes if they definitely came from Hour of Code\r\n      c.showHourOfCodeDoneButton = showDone\r\n      @showHoc2016ExploreButton = gameDevHoc and lastLevel\r\n\r\n    c.showLeaderboard = @level.get('scoreTypes')?.length > 0 and not @level.isType('course')\r\n\r\n    c.showReturnToCourse = not c.showLeaderboard and not me.get('anonymous') and @level.isType('course', 'course-ladder')\r\n    c.isCourseLevel = @level.isType('course')\r\n    c.currentCourseName = @course?.get('name')\r\n    c.currentLevelName = @level?.get('name')\r\n    c.nextLevelName = @nextLevel?.get('name')\r\n\r\n    return c\r\n\r\n  afterRender: ->\r\n    super()\r\n    @$el.toggleClass 'with-achievements', @level.isType('hero', 'hero-ladder', 'game-dev', 'web-dev')\r\n    return unless @supermodel.finished()\r\n    @playSelectionSound hero, true for original, hero of @thangTypes  # Preload them\r\n    @updateSavingProgressStatus()\r\n    @initializeAnimations()\r\n    if @level.isType('hero-ladder', 'course-ladder')\r\n      @ladderSubmissionView = new LadderSubmissionView session: @session, level: @level\r\n      @insertSubView @ladderSubmissionView, @$el.find('.ladder-submission-view')\r\n\r\n  initializeAnimations: ->\r\n    return @endSequentialAnimations() unless @level.isType('hero', 'hero-ladder', 'game-dev', 'web-dev')\r\n    @updateXPBars 0\r\n    #playVictorySound = => @playSound 'victory-title-appear'  # TODO: actually add this\r\n    @$el.find('#victory-header').delay(250).queue(->\r\n      $(@).removeClass('out').dequeue()\r\n      #playVictorySound()\r\n    )\r\n    complete = _.once(_.bind(@beginSequentialAnimations, @))\r\n    @animatedPanels = $()\r\n    panels = @$el.find('.achievement-panel')\r\n    for panel in panels\r\n      panel = $(panel)\r\n      continue unless panel.data('animate')\r\n      @animatedPanels = @animatedPanels.add(panel)\r\n      panel.delay(500)  # Waiting for victory header to show up and fall\r\n      panel.queue(->\r\n        $(@).addClass('earned') # animate out the grayscale\r\n        $(@).dequeue()\r\n      )\r\n      panel.delay(500)\r\n      panel.queue(->\r\n        $(@).find('.reward-image-container').addClass('show')\r\n        $(@).dequeue()\r\n      )\r\n      panel.delay(500)\r\n      panel.queue(-> complete())\r\n    @animationComplete = not @animatedPanels.length\r\n    complete() if @animationComplete\r\n\r\n  beginSequentialAnimations: ->\r\n    return if @destroyed\r\n    return unless @level.isType('hero', 'hero-ladder', 'game-dev', 'web-dev')\r\n    @sequentialAnimatedPanels = _.map(@animatedPanels.find('.reward-panel'), (panel) -> {\r\n      number: $(panel).data('number')\r\n      previousNumber: $(panel).data('previous-number')\r\n      textEl: $(panel).find('.reward-text')\r\n      rootEl: $(panel)\r\n      unit: $(panel).data('number-unit')\r\n      hero: $(panel).data('hero-thang-type')\r\n      item: $(panel).data('item-thang-type')\r\n    })\r\n\r\n    @totalXP = 0\r\n    @totalXP += panel.number for panel in @sequentialAnimatedPanels when panel.unit is 'xp'\r\n    @totalGems = 0\r\n    @totalGems += panel.number for panel in @sequentialAnimatedPanels when panel.unit is 'gem'\r\n    @gemEl = $('#gem-total')\r\n    @XPEl = $('#xp-total')\r\n    @totalXPAnimated = @totalGemsAnimated = @lastTotalXP = @lastTotalGems = 0\r\n    @sequentialAnimationStart = new Date()\r\n    @sequentialAnimationInterval = setInterval(@tickSequentialAnimation, 1000 / 60)\r\n\r\n  tickSequentialAnimation: =>\r\n    # TODO: make sure the animation pulses happen when the numbers go up and sounds play (up to a max speed)\r\n    return @endSequentialAnimations() unless panel = @sequentialAnimatedPanels[0]\r\n    if panel.number\r\n      duration = Math.log(panel.number + 1) / Math.LN10 * 1000  # Math.log10 is ES6\r\n    else\r\n      duration = 1000\r\n    ratio = @getEaseRatio (new Date() - @sequentialAnimationStart), duration\r\n    if panel.unit is 'xp'\r\n      newXP = Math.floor(ratio * (panel.number - panel.previousNumber))\r\n      totalXP = @totalXPAnimated + newXP\r\n      if totalXP isnt @lastTotalXP\r\n        panel.textEl.text('+' + newXP)\r\n        @XPEl.text(totalXP)\r\n        @updateXPBars(totalXP)\r\n        xpTrigger = 'xp-' + (totalXP % 6)  # 6 xp sounds\r\n        @playSound xpTrigger, (0.5 + ratio / 2)\r\n        @XPEl.addClass 'four-digits' if totalXP >= 1000 and @lastTotalXP < 1000\r\n        @XPEl.addClass 'five-digits' if totalXP >= 10000 and @lastTotalXP < 10000\r\n        @lastTotalXP = totalXP\r\n    else if panel.unit is 'gem'\r\n      newGems = Math.floor(ratio * (panel.number - panel.previousNumber))\r\n      totalGems = @totalGemsAnimated + newGems\r\n      if totalGems isnt @lastTotalGems\r\n        panel.textEl.text('+' + newGems)\r\n        @gemEl.text(totalGems)\r\n        gemTrigger = 'gem-' + (parseInt(panel.number * ratio) % 4)  # 4 gem sounds\r\n        @playSound gemTrigger, (0.5 + ratio / 2)\r\n        @gemEl.addClass 'four-digits' if totalGems >= 1000 and @lastTotalGems < 1000\r\n        @gemEl.addClass 'five-digits' if totalGems >= 10000 and @lastTotalGems < 10000\r\n        @lastTotalGems = totalGems\r\n    else if panel.item\r\n      thangType = @thangTypes[panel.item]\r\n      panel.textEl.text utils.i18n(thangType.attributes, 'name')\r\n      @playSound 'item-unlocked' if 0.5 < ratio < 0.6\r\n    else if panel.hero\r\n      thangType = @thangTypes[panel.hero]\r\n      panel.textEl.text utils.i18n(thangType.attributes, 'name')\r\n      @playSelectionSound thangType if 0.5 < ratio < 0.6\r\n    if ratio is 1\r\n      panel.rootEl.removeClass('animating').find('.reward-image-container img').removeClass('pulse')\r\n      @sequentialAnimationStart = new Date()\r\n      if panel.unit is 'xp'\r\n        @totalXPAnimated += panel.number - panel.previousNumber\r\n      else if panel.unit is 'gem'\r\n        @totalGemsAnimated += panel.number - panel.previousNumber\r\n      @sequentialAnimatedPanels.shift()\r\n      return\r\n    panel.rootEl.addClass('animating').find('.reward-image-container').removeClass('pending-reward-image').find('img').addClass('pulse')\r\n\r\n  getEaseRatio: (timeSinceStart, duration) ->\r\n    # Ease in/out quadratic - http://gizma.com/easing/\r\n    timeSinceStart = Math.min timeSinceStart, duration\r\n    t = 2 * timeSinceStart / duration\r\n    if t < 1\r\n      return 0.5 * t * t\r\n    --t\r\n    -0.5 * (t * (t - 2) - 1)\r\n\r\n  updateXPBars: (achievedXP) ->\r\n    previousXP = @previousXP\r\n    previousXP = previousXP + 1000000 if me.isInGodMode()\r\n    previousLevel = @previousLevel\r\n\r\n    currentXP = previousXP + achievedXP\r\n    currentLevel = User.levelFromExp currentXP\r\n    currentLevelXP = User.expForLevel currentLevel\r\n\r\n    nextLevel = currentLevel + 1\r\n    nextLevelXP = User.expForLevel nextLevel\r\n\r\n    leveledUp = currentLevel > previousLevel\r\n    totalXPNeeded = nextLevelXP - currentLevelXP\r\n    alreadyAchievedPercentage = 100 * (previousXP - currentLevelXP) / totalXPNeeded\r\n    alreadyAchievedPercentage = 0 if alreadyAchievedPercentage < 0  # In case of level up\r\n    if leveledUp\r\n      newlyAchievedPercentage = 100 * (currentXP - currentLevelXP) / totalXPNeeded\r\n    else\r\n      newlyAchievedPercentage = 100 * achievedXP / totalXPNeeded\r\n\r\n    xpEl = $('#xp-wrapper')\r\n    xpBarJustEarned = xpEl.find('.xp-bar-already-achieved').css('width', alreadyAchievedPercentage + '%')\r\n    xpBarTotal = xpEl.find('.xp-bar-total').css('width', (alreadyAchievedPercentage + newlyAchievedPercentage) + '%')\r\n    levelLabel = xpEl.find('.level')\r\n    utils.replaceText levelLabel, currentLevel\r\n\r\n    if leveledUp and (not @displayedLevel or currentLevel > @displayedLevel)\r\n      @playSound 'level-up'\r\n    @displayedLevel = currentLevel\r\n\r\n  endSequentialAnimations: ->\r\n    clearInterval @sequentialAnimationInterval\r\n    @animationComplete = true\r\n    @updateSavingProgressStatus()\r\n    Backbone.Mediator.publish 'music-player:enter-menu', terrain: @level.get('terrain', true) or 'forest'\r\n\r\n  updateSavingProgressStatus: ->\r\n    @$el.find('#saving-progress-label').toggleClass('hide', @readyToContinue)\r\n    @$el.find('.next-level-button').toggleClass('hide', not @readyToContinue)\r\n    @$el.find('.sign-up-poke').toggleClass('hide', not @readyToContinue)\r\n\r\n  onGameSubmitted: (e) ->\r\n    @returnToLadder()\r\n\r\n  returnToLadder: ->\r\n    # Preserve the supermodel as we navigate back to the ladder.\r\n    viewArgs = [{supermodel: if @options.hasReceivedMemoryWarning then null else @supermodel}, @level.get('slug')]\r\n    ladderURL = \"/play/ladder/#{@level.get('slug') || @level.id}\"\r\n    if leagueID = (@courseInstanceID or @getQueryVariable 'league')\r\n      leagueType = if @level.isType('course-ladder') then 'course' else 'clan'\r\n      viewArgs.push leagueType\r\n      viewArgs.push leagueID\r\n      ladderURL += \"/#{leagueType}/#{leagueID}\"\r\n    ladderURL += '#my-matches'\r\n    Backbone.Mediator.publish 'router:navigate', route: ladderURL, viewClass: 'views/ladder/LadderView', viewArgs: viewArgs\r\n\r\n  playSelectionSound: (hero, preload=false) ->\r\n    return unless sounds = hero.get('soundTriggers')?.selected\r\n    return unless sound = sounds[Math.floor Math.random() * sounds.length]\r\n    name = AudioPlayer.nameForSoundReference sound\r\n    if preload\r\n      AudioPlayer.preloadSoundReference sound\r\n    else\r\n      AudioPlayer.playSound name, 1\r\n\r\n  getNextLevelCampaign: ->\r\n    campaign = @level.get 'campaign'\r\n    if @level.get('slug') in campaignEndLevels\r\n      campaign = ''  # Return to campaign selector\r\n    if (campaign is 'dungeon' or @level.get('slug') in ['kithgard-gates', 'game-grove']) and storage.load('should-return-to-game-dev-hoc')\r\n      # Return to game-dev-hoc instead if we're in that mode, since the levels don't realize they can be in that copycat campaign\r\n      campaign = 'game-dev-hoc'\r\n    campaign\r\n\r\n  getNextLevelLink: (returnToCourse=false) ->\r\n    if @level.isType('course')\r\n      link = \"/students\"\r\n      if @courseID\r\n        link += \"/#{@courseID}\"\r\n        link += \"/#{@courseInstanceID}\" if @courseInstanceID\r\n    else\r\n      link = '/play'\r\n      nextCampaign = @getNextLevelCampaign()\r\n      link += '/' + nextCampaign\r\n    link\r\n\r\n  onClickContinue: (e, extraOptions=null) ->\r\n    @playSound 'menu-button-click'\r\n    nextLevelLink = @getNextLevelLink extraOptions?.returnToCourse\r\n    # Preserve the supermodel as we navigate back to the world map.\r\n    options =\r\n      justBeatLevel: @level\r\n      supermodel: if @options.hasReceivedMemoryWarning then null else @supermodel\r\n    _.merge options, extraOptions if extraOptions\r\n    if @showHoc2016ExploreButton\r\n      # Send players to /play after completing final game-dev activity project level\r\n      nextLevelLink = '/play'\r\n      viewClass = 'views/play/CampaignView'\r\n      viewArgs = [options]\r\n    else if @level.isType('course') and @nextLevel and not options.returnToCourse\r\n      viewClass = 'views/play/level/PlayLevelView'\r\n      options.courseID = @courseID\r\n      options.courseInstanceID = @courseInstanceID\r\n      viewArgs = [options, @nextLevel.get('slug')]\r\n    else if @level.isType('course')\r\n      # TODO: shouldn't set viewClass and route in different places\r\n      viewClass = 'views/courses/CoursesView'\r\n      viewArgs = [options]\r\n      if @courseID\r\n        viewClass = 'views/courses/CourseDetailsView'\r\n        viewArgs.push @courseID\r\n        viewArgs.push @courseInstanceID if @courseInstanceID\r\n    else if @level.isType('course-ladder')\r\n      leagueID = @courseInstanceID or @getQueryVariable 'league'\r\n      nextLevelLink = \"/play/ladder/#{@level.get('slug')}\"\r\n      nextLevelLink += \"/course/#{leagueID}\" if leagueID\r\n      viewClass = 'views/ladder/LadderView'\r\n      viewArgs = [options, @level.get('slug')]\r\n      viewArgs = viewArgs.concat ['course', leagueID] if leagueID\r\n    else\r\n      if @level.get('slug') in campaignEndLevels\r\n        options.worldComplete = @level.get('campaign') or true\r\n      viewClass = 'views/play/CampaignView'\r\n      viewArgs = [options, @getNextLevelCampaign()]\r\n    navigationEvent = route: nextLevelLink, viewClass: viewClass, viewArgs: viewArgs\r\n    if @level.get('slug') is 'lost-viking' and not (me.get('age') in ['0-13', '14-17'])\r\n      @showOffer navigationEvent\r\n    else\r\n      Backbone.Mediator.publish 'router:navigate', navigationEvent\r\n\r\n  onClickLeaderboard: (e) ->\r\n    @onClickContinue e, showLeaderboard: true\r\n\r\n  onClickReturnToCourse: (e) ->\r\n    @onClickContinue e, returnToCourse: true\r\n\r\n  onClickReturnToLadder: (e) ->\r\n    @playSound 'menu-button-click'\r\n    e.preventDefault()\r\n    @returnToLadder()\r\n\r\n  onClickSignupButton: (e) ->\r\n    e.preventDefault()\r\n    window.tracker?.trackEvent 'Started Signup', category: 'Play Level', label: 'Hero Victory Modal', level: @level.get('slug')\r\n    @openModalView new CreateAccountModal()\r\n\r\n  showOffer: (@navigationEventUponCompletion) ->\r\n    @$el.find('.modal-footer > *').hide()\r\n    @$el.find(\".modal-footer > .offer.#{@level.get('slug')}\").show()\r\n\r\n  onClickContinueFromOffer: (e) ->\r\n    url = {\r\n      'lost-viking': 'http://www.vikingcodeschool.com/codecombat?utm_source=codecombat&utm_medium=viking_level&utm_campaign=affiliate&ref=Code+Combat+Elite'\r\n    }[@level.get('slug')]\r\n    Backbone.Mediator.publish 'router:navigate', @navigationEventUponCompletion\r\n    window.open url, '_blank' if url\r\n\r\n  onClickSkipOffer: (e) ->\r\n    Backbone.Mediator.publish 'router:navigate', @navigationEventUponCompletion\r\n\r\n  onClickShareLevelButton: ->\r\n    @$('#share-level-input').val(@shareURL).select()\r\n    @tryCopy()\r\n\r\n  # Ratings and reviews\r\n\r\n  starNum: (starEl) -> starEl.prevAll('i').length + 1\r\n\r\n  showStars: (num) ->\r\n    @$el.find('.rating').show()\r\n    num ?= @feedback?.get('rating') or 0\r\n    stars = @$el.find('.rating i')\r\n    stars.removeClass('glyphicon-star').addClass('glyphicon-star-empty')\r\n    stars.slice(0, num).removeClass('glyphicon-star-empty').addClass('glyphicon-star')\r\n\r\n  setStars: (num) ->\r\n    @feedback.set('rating', num)\r\n    @feedback.save()\r\n\r\n  saveReviewEventually: ->\r\n    @saveReview()\r\n\r\n  saveReview: ->\r\n    @feedback.set('review', @$el.find('.review textarea').val())\r\n    @feedback.save()\r\n\r\n\r\n# Much easier to just keep this updated than to dynamically figure it out.\r\ncampaignEndLevels = [\r\n  'kithgard-gates'\r\n  'kithgard-mastery'\r\n  'tabula-rasa'\r\n  'wanted-poster'\r\n  'siege-of-stonehold'\r\n  'go-fetch'\r\n  'palimpsest'\r\n  'quizlet'\r\n  'clash-of-clones'\r\n  'summits-gate'\r\n]\r\n"]}