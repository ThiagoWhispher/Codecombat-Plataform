{"version":3,"sources":["app/views/play/level/LevelGoldView.coffee"],"names":[],"mappings":";AAAA;EAAA;;;AAAA,WAAW,QAAQ,qBAAR;;AACX,WAAW,QAAQ,2BAAR;;AACX,eAAe,QAAQ,gCAAR;;AAEf,MAAM,CAAC,OAAP,GAAuB;;;0BACrB,KAAI;;0BACJ,WAAU;;0BAEV,gBACE;IAAA,wBAAwB,eAAxB;IACA,uBAAuB,gBADvB;;;EAGW,uBAAC,OAAD;IACX,+CAAM,OAAN;IACA,IAAC,SAAD,GAAY;IACZ,IAAC,eAAD,GAAkB;IAClB,IAAC,UAAD,GAAa;EAJF;;0BAMb,gBAAe,SAAC,CAAD;AACb;IAAA,IAAU,IAAC,SAAS,EAAC,CAAC,IAAF,CAAV,KAAqB,CAAC,CAAC,IAAvB,IAAgC,IAAC,eAAe,EAAC,CAAC,IAAF,CAAhB,KAA2B,CAAC,CAAC,UAAvE;AAAA;;IACA,IAAC,SAAS,EAAC,CAAC,IAAF,CAAV,GAAoB,CAAC,CAAC;IACtB,IAAC,eAAe,EAAC,CAAC,IAAF,CAAhB,GAA0B,CAAC,CAAC;IAC5B,SAAS,IAAC,IAAG,CAAC,IAAL,CAAU,uBAAuB,CAAC,CAAC,IAAnC;IACT,KAAO,MAAM,CAAC,MAAd;MACE,SAAS,aAAa;QAAA,MAAM,CAAC,CAAC,IAAR;OAAb;MACT,IAAC,IAAI,CAAG,CAAC,CAAC,IAAF,KAAU,QAAb,GAA2B,SAA3B,GAA0C,QAA1C,CAAL,CAAyD,MAAzD;MACA,SAAS,IAAC,IAAG,CAAC,IAAL,CAAU,uBAAuB,CAAC,CAAC,IAAnC,EAHX;;IAIA,OAAO,KAAK,CAAC,CAAC;IACd,IAAG,CAAC,CAAC,UAAF,IAAiB,CAAC,CAAC,UAAF,GAAe,CAAC,CAAC,IAArC;MACE,QAAQ,OAAK,CAAC,CAAC,UAAP,GAAkB,IAD5B;;IAEA,MAAM,CAAC,IAAP,CAAY,IAAZ;IACA,IAAC,YAAD;IACA,IAAC,IAAG,CAAC,IAAL;WACA,IAAC,UAAD,GAAa;EAfA;;0BAiBf,cAAa;AACX;IAAA,UAAU;AACV;AAAA;;MACE,IAAG,IAAC,eAAe,MAAnB;QACE,OAAO,CAAC,IAAR,CAAa,WAAS,IAAT,GAAc,QAAd,GAAsB,IAAtB,GAA2B,UAA3B,GAAqC,IAAC,eAAe,MAArD,GAA2D,eAAxE,EADF;OAAA;QAGE,OAAO,CAAC,IAAR,CAAa,WAAS,IAAT,GAAc,QAAd,GAAsB,IAAtB,GAA2B,QAAxC,EAHF;;AADF;WAKA,IAAC,IAAG,CAAC,IAAL,CAAU,OAAV,EAAmB,OAAO,CAAC,IAAR,CAAa,GAAb,CAAnB;EAPW;;0BASb,iBAAgB,SAAC,CAAD;IACd,IAAwB,IAAC,UAAzB;aAAA,IAAC,IAAG,CAAC,MAAL,CAAY,CAAI,CAAC,CAAC,EAAlB;;EADc;;;;GAxC2B","file":"public/javascripts/app/views/play/level/LevelGoldView.js","sourcesContent":["CocoView = require 'views/core/CocoView'\r\ntemplate = require 'templates/play/level/gold'\r\nteamTemplate = require 'templates/play/level/team_gold'\r\n\r\nmodule.exports = class LevelGoldView extends CocoView\r\n  id: 'gold-view'\r\n  template: template\r\n\r\n  subscriptions:\r\n    'surface:gold-changed': 'onGoldChanged'\r\n    'level:set-letterbox': 'onSetLetterbox'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @teamGold = {}\r\n    @teamGoldEarned = {}\r\n    @shownOnce = false\r\n\r\n  onGoldChanged: (e) ->\r\n    return if @teamGold[e.team] is e.gold and @teamGoldEarned[e.team] is e.goldEarned\r\n    @teamGold[e.team] = e.gold\r\n    @teamGoldEarned[e.team] = e.goldEarned\r\n    goldEl = @$el.find('.gold-amount.team-' + e.team)\r\n    unless goldEl.length\r\n      teamEl = teamTemplate team: e.team\r\n      @$el[if e.team is 'humans' then 'prepend' else 'append'](teamEl)\r\n      goldEl = @$el.find('.gold-amount.team-' + e.team)\r\n    text = '' + e.gold\r\n    if e.goldEarned and e.goldEarned > e.gold\r\n      text += \" (#{e.goldEarned})\"\r\n    goldEl.text text\r\n    @updateTitle()\r\n    @$el.show()\r\n    @shownOnce = true\r\n\r\n  updateTitle: ->\r\n    strings = []\r\n    for team, gold of @teamGold\r\n      if @teamGoldEarned[team]\r\n        strings.push \"Team '#{team}' has #{gold} now of #{@teamGoldEarned[team]} gold earned.\"\r\n      else\r\n        strings.push \"Team '#{team}' has #{gold} gold.\"\r\n    @$el.attr 'title', strings.join ' '\r\n\r\n  onSetLetterbox: (e) ->\r\n    @$el.toggle not e.on if @shownOnce\r\n"]}