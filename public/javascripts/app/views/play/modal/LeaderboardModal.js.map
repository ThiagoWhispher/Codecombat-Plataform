{"version":3,"sources":["app/templates/play/modal/leaderboard-modal.jade","app/views/play/modal/LeaderboardModal.coffee"],"names":[],"mappings":"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","file":"public/javascripts/app/views/play/modal/LeaderboardModal.js","sourcesContent":["var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),levelName = locals_.levelName,submenus = locals_.submenus;buf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><img src=\\\"/images/pages/play/modal/leaderboard-background.png\\\" draggable=\\\"false\\\" id=\\\"leaderboard-background\\\"/><h1 class=\\\"level-title\\\">\" + (jade.escape(null == (jade.interp = levelName) ? \"\" : jade.interp)) + \"</h1><div id=\\\"close-modal\\\"><span class=\\\"glyphicon glyphicon-remove\\\"></span></div><ul id=\\\"leaderboard-nav\\\" class=\\\"nav nav-pills nav-stacked\\\">\");\nvar lastScoreType = null;\n// iterate submenus\n;(function(){\n  var $$obj = submenus;\n  if ('number' == typeof $$obj.length) {\n\n    for (var index = 0, $$l = $$obj.length; index < $$l; index++) {\n      var submenu = $$obj[index];\n\nif ( lastScoreType && submenu.scoreType != lastScoreType)\n{\nbuf.push(\"<br/>\");\n}\nbuf.push(\"<li\" + (jade.attrs({ \"class\": [(index ? \"\" : \"active\")] }, {\"class\":true})) + \"><a\" + (jade.attrs({ 'href':('#' + submenu.scoreType + '-' + submenu.timespan + '-view'), 'data-toggle':('tab') }, {\"href\":true,\"data-toggle\":true})) + \">\");\nif ( submenu.scoreType != lastScoreType)\n{\nbuf.push(\"<div\" + (jade.attrs({ 'data-i18n':('leaderboard.' + submenu.scoreType.replace('-', '_')), \"class\": [('scoreType')] }, {\"data-i18n\":true})) + \">\" + (jade.escape(null == (jade.interp = submenu.scoreType) ? \"\" : jade.interp)) + \"</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"scoreType\\\">&nbsp;</div>\");\n}\nbuf.push(\"<div\" + (jade.attrs({ 'data-i18n':('leaderboard.' + submenu.timespan), \"class\": [('timespan')] }, {\"data-i18n\":true})) + \"></div>\");\nlastScoreType = submenu.scoreType;\nbuf.push(\"</a></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var index in $$obj) {\n      $$l++;      var submenu = $$obj[index];\n\nif ( lastScoreType && submenu.scoreType != lastScoreType)\n{\nbuf.push(\"<br/>\");\n}\nbuf.push(\"<li\" + (jade.attrs({ \"class\": [(index ? \"\" : \"active\")] }, {\"class\":true})) + \"><a\" + (jade.attrs({ 'href':('#' + submenu.scoreType + '-' + submenu.timespan + '-view'), 'data-toggle':('tab') }, {\"href\":true,\"data-toggle\":true})) + \">\");\nif ( submenu.scoreType != lastScoreType)\n{\nbuf.push(\"<div\" + (jade.attrs({ 'data-i18n':('leaderboard.' + submenu.scoreType.replace('-', '_')), \"class\": [('scoreType')] }, {\"data-i18n\":true})) + \">\" + (jade.escape(null == (jade.interp = submenu.scoreType) ? \"\" : jade.interp)) + \"</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"scoreType\\\">&nbsp;</div>\");\n}\nbuf.push(\"<div\" + (jade.attrs({ 'data-i18n':('leaderboard.' + submenu.timespan), \"class\": [('timespan')] }, {\"data-i18n\":true})) + \"></div>\");\nlastScoreType = submenu.scoreType;\nbuf.push(\"</a></li>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul><div class=\\\"tab-content leaderboard-tab-content\\\">\");\n// iterate submenus\n;(function(){\n  var $$obj = submenus;\n  if ('number' == typeof $$obj.length) {\n\n    for (var index = 0, $$l = $$obj.length; index < $$l; index++) {\n      var submenu = $$obj[index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'id':(submenu.scoreType + '-' + submenu.timespan + '-view'), \"class\": [('tab-pane')] }, {\"id\":true})) + \"><div class=\\\"leaderboard-tab-view\\\"></div></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var index in $$obj) {\n      $$l++;      var submenu = $$obj[index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'id':(submenu.scoreType + '-' + submenu.timespan + '-view'), \"class\": [('tab-pane')] }, {\"id\":true})) + \"><div class=\\\"leaderboard-tab-view\\\"></div></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/play/modal/leaderboard-modal'\r\nLeaderboardTabView = require 'views/play/modal/LeaderboardTabView'\r\nLevel = require 'models/Level'\r\nutils = require 'core/utils'\r\n\r\nmodule.exports = class LeaderboardModal extends ModalView\r\n  id: 'leaderboard-modal'\r\n  template: template\r\n  instant: true\r\n  timespans: ['day', 'week', 'all']\r\n\r\n  subscriptions: {}\r\n\r\n  events:\r\n    'shown.bs.tab #leaderboard-nav a': 'onTabShown'\r\n    'click #close-modal': 'hide'\r\n\r\n  constructor: (options) ->\r\n    super options\r\n    @levelSlug = @options.levelSlug\r\n    level = new Level({_id: @levelSlug})\r\n    level.project = ['name', 'i18n', 'scoreType', 'original']\r\n    @level = @supermodel.loadModel(level).model\r\n\r\n  getRenderData: (c) ->\r\n    c = super c\r\n    c.submenus = []\r\n    for scoreType in @level.get('scoreTypes') ? []\r\n      for timespan in @timespans\r\n        c.submenus.push scoreType: scoreType, timespan: timespan\r\n    c.levelName = utils.i18n @level.attributes, 'name'\r\n    c\r\n\r\n  afterRender: ->\r\n    super()\r\n    return unless @supermodel.finished()\r\n    for scoreType, scoreTypeIndex in @level.get('scoreTypes') ? []\r\n      for timespan, timespanIndex in @timespans\r\n        submenuView = new LeaderboardTabView scoreType: scoreType, timespan: timespan, level: @level\r\n        @insertSubView submenuView, @$el.find \"##{scoreType}-#{timespan}-view .leaderboard-tab-view\"\r\n        if scoreTypeIndex + timespanIndex is 0\r\n          submenuView.$el.parent().addClass 'active'\r\n          submenuView.onShown?()\r\n    @playSound 'game-menu-open'\r\n    @$el.find('.nano:visible').nanoScroller()\r\n\r\n  onTabShown: (e) ->\r\n    @playSound 'game-menu-tab-switch'\r\n    tabChunks = e.target.hash.substring(1).split '-'\r\n    scoreType = tabChunks[0 ... tabChunks.length - 2].join '-'\r\n    timespan = tabChunks[tabChunks.length - 2]\r\n    subview = _.find @subviews, scoreType: scoreType, timespan: timespan\r\n    subview.onShown?()\r\n    otherSubview.onHidden?() for subviewKey, otherSubview of @subviews when otherSubview isnt subview\r\n\r\n  onHidden: ->\r\n    super()\r\n    subview.onHidden?() for subviewKey, subview of @subviews\r\n    @playSound 'game-menu-close'\r\n"]}