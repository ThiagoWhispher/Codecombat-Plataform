{"version":3,"sources":["app/views/admin/FilesView.coffee"],"names":[],"mappings":";AAAA;EAAA;;;;AAAA,WAAW,QAAQ,qBAAR;;AACX,WAAW,QAAQ,uBAAR;;AACX,gBAAgB,QAAQ,6BAAR;;AAEhB,MAAM,CAAC,OAAP,GAAuB;;;;;;;;;;sBACrB,KAAI;;sBACJ,WAAU;;sBAEV,SACE;IAAA,wBAAwB;aAAG,UAAU,CAAC,IAAX,CAAgB;QAAC,WAAU,SAAX;OAAhB,EAAuC,IAAC,aAAxC;IAAH,CAAxB;IACA,yBAAyB,WADzB;;;sBAGF,cAAa;IACX;IACA,QAAQ,0BAAR;WACA,IAAC,UAAD;EAHW;;sBAKb,eAAc,SAAC,OAAD;AACZ;IAAA,OACE;MAAA,KAAK,OAAO,CAAC,GAAb;MACA,UAAU,OAAO,CAAC,QADlB;MAEA,UAAU,OAAO,CAAC,QAFlB;MAGA,MAAM,IAAC,cAAD,EAHN;MAIA,OAAO,IAJP;;IAQF,IAAC,cAAD,GAAiB,CAAC,IAAC,cAAD,EAAD,EAAmB,OAAO,CAAC,QAA3B,CAAoC,CAAC,IAArC,CAA0C,GAA1C;WACjB,CAAC,CAAC,IAAF,CAAO,OAAP,EAAgB;MAAC,MAAM,MAAP;MAAe,MAAM,IAArB;MAA2B,SAAS,IAAC,eAArC;KAAhB;EAXY;;sBAad,iBAAgB,SAAC,CAAD;WACd,IAAC,UAAD;EADc;;sBAGhB,gBAAe;WAAG,IAAC,IAAG,CAAC,IAAL,CAAU,gBAAV,CAA2B,CAAC,GAA5B;EAAH;;sBAEf,YAAW;WACT,CAAC,CAAC,IAAF,CACE;MAAA,KAAK,WAAQ,CAAC,IAAC,cAAD,EAAD,CAAR,GAA0B,GAA/B;MACA,SAAS,IAAC,cADV;MAEA,OAAO,KAFP;KADF;EADS;;sBAMX,gBAAe,SAAC,GAAD;AACb;IAAA,QAAQ,cAAc;MAAC,OAAM,GAAP;KAAd;WACR,IAAC,IAAG,CAAC,IAAL,CAAU,aAAV,CAAwB,CAAC,WAAzB,CAAqC,KAArC;EAFa;;;;GArCwB","file":"public/javascripts/app/views/admin/FilesView.js","sourcesContent":["RootView = require 'views/core/RootView'\r\ntemplate = require 'templates/admin/files'\r\ntableTemplate = require 'templates/admin/files_table'\r\n\r\nmodule.exports = class FilesView extends RootView\r\n  id: 'admin-files-view'\r\n  template: template\r\n\r\n  events:\r\n    'click #upload-button': -> filepicker.pick {mimetypes:'audio/*'}, @onFileChosen\r\n    'change #folder-select': 'loadFiles'\r\n\r\n  afterRender: ->\r\n    super()\r\n    require('core/services/filepicker')()  # Initialize if needed\r\n    @loadFiles()\r\n\r\n  onFileChosen: (InkBlob) =>\r\n    body =\r\n      url: InkBlob.url\r\n      filename: InkBlob.filename\r\n      mimetype: InkBlob.mimetype\r\n      path: @currentFolder()\r\n      force: true\r\n\r\n    # Automatically overwrite if the same path was put in here before\r\n#    body.force = true # if InkBlob.filename is @data\r\n    @uploadingPath = [@currentFolder(), InkBlob.filename].join('/')\r\n    $.ajax('/file', {type: 'POST', data: body, success: @onFileUploaded})\r\n\r\n  onFileUploaded: (e) =>\r\n    @loadFiles()\r\n\r\n  currentFolder: -> @$el.find('#folder-select').val()\r\n\r\n  loadFiles: ->\r\n    $.ajax\r\n      url: \"/file/#{@currentFolder()}/\"\r\n      success: @onLoadedFiles\r\n      cache: false\r\n\r\n  onLoadedFiles: (res) =>\r\n    table = tableTemplate({files:res})\r\n    @$el.find('#file-table').replaceWith(table)\r\n"]}