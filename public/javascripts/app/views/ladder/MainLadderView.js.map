{"version":3,"sources":["app/views/ladder/MainLadderView.coffee"],"names":[],"mappings":";AAAA;EAAA;;;AAAA,WAAW,QAAQ,qBAAR;;AACX,WAAW,QAAQ,4BAAR;;AACX,eAAe,QAAQ,qBAAR;;AACf,iBAAiB,QAAQ,4BAAR;;AAEX;;;oCACJ,MAAK;;oCACL,QAAO;;EAEM,iCAAC,KAAD;IACX;IACA,IAAC,IAAD,GAAO,cAAY,EAAE,CAAC,EAAf,GAAkB;EAFd;;;;GAJuB;;AAQtC,MAAM,CAAC,OAAP,GAAuB;;;;;;;2BACrB,KAAI;;2BACJ,WAAU;;2BAEV,aAAY;IACV,IAAC,eAAD,GAAkB;IAClB,IAAC,kBAAD,GAAqB;IACrB,IAAC,UAAD,GAAa;IAEb,IAAC,SAAD,GAAY,IAAC,WAAU,CAAC,cAAZ,CAA+B,6BAA/B,EAA0D,eAA1D,EAA2E;MAAC,OAAO,KAAR;KAA3E,EAA2F,CAA3F,CAA6F,CAAC;IAC1G,IAAC,aAAD,CAAc,IAAC,SAAf,EAAyB,MAAzB,EAAiC,IAAC,iBAAlC;WAEA,IAAC,mBAAD;EARU;;2BAUZ,mBAAkB,SAAC,CAAD;AAChB;AAAA;AAAA;;MACE,IAAC,eAAe,QAAO,CAAC,GAAR,CAAY,SAAZ,EAAhB,gDAAiE,CAAE,kBAAzB,GAAuC,UAAvC,GAAuD;AADnG;WAEA,IAAC,OAAD;EAHgB;;2BAKlB,qBAAoB;AAClB;IAAA,UAAU;aAAA,SAAC,eAAD;AACR;QAAA,IAAU,KAAC,UAAX;AAAA;;AACA;;UACE,KAAC,kBAAkB,MAAK,CAAC,GAAN,CAAnB,GAAgC;YAAA,UAAU,KAAK,CAAC,QAAhB;YAA0B,UAAU,KAAK,CAAC,QAA1C;;AADlC;QAEA,IAAa,KAAC,WAAU,CAAC,QAAZ,EAAb;iBAAA,KAAC,OAAD;;MAJQ;IAAA;IAMV,WAAW;AACX;;AACE;AAAA;;QACE,QAAQ,CAAC,IAAT,CAAc,KAAK,CAAC,EAApB;AADF;AADF;IAGA,yBAAyB,IAAC,WAAU,CAAC,kBAAZ,CAA+B,aAA/B,EAA8C;MACrE,KAAK,yBADgE;MAErE,MAAM;QAAC,KAAK,QAAN;OAF+D;MAGrE,QAAQ,MAH6D;MAIrE,SAAS,OAJ4D;KAA9C,EAKtB,CALsB;WAMzB,sBAAsB,CAAC,IAAvB;EAjBkB;;;;GAnBwB;;AAsC9C,aAAa;EACX;IACE,MAAM,eADR;IAEE,YAAY,CAFd;IAGE,IAAI,eAHN;IAIE,OAAO,kEAJT;IAKE,aAAa,gIALf;GADW,EAQX;IACE,MAAM,UADR;IAEE,YAAY,CAFd;IAGE,IAAI,UAHN;IAIE,OAAO,qEAJT;IAKE,aAAa,8IALf;GARW,EAeX;IACE,MAAM,iBADR;IAEE,YAAY,CAFd;IAGE,IAAI,iBAHN;IAIE,OAAO,qEAJT;IAKE,aAAa,0EALf;GAfW,EAsBX;IACE,MAAM,iBADR;IAEE,YAAY,CAFd;IAGE,IAAI,iBAHN;IAIE,OAAO,qEAJT;IAKE,aAAa,+EALf;GAtBW,EA6BX;IACE,MAAM,4BADR;IAEE,YAAY,CAFd;IAGE,IAAI,4BAHN;IAIE,OAAO,kFAJT;IAKE,aAAa,6EALf;GA7BW,EAoCX;IACE,MAAM,YADR;IAEE,YAAY,CAFd;IAGE,IAAI,YAHN;IAIE,OAAO,8DAJT;IAKE,aAAa,gGALf;GApCW;;;AA6Cb,YAAY;EACV;IAAC,IAAI,aAAL;IAAoB,MAAM,oBAA1B;IAAgD,aAAa,2DAA7D;IAA0H,QAAQ,UAAlI;GADU","file":"public/javascripts/app/views/ladder/MainLadderView.js","sourcesContent":["RootView = require 'views/core/RootView'\r\ntemplate = require 'templates/play/ladder_home'\r\nLevelSession = require 'models/LevelSession'\r\nCocoCollection = require 'collections/CocoCollection'\r\n\r\nclass LevelSessionsCollection extends CocoCollection\r\n  url: ''\r\n  model: LevelSession\r\n\r\n  constructor: (model) ->\r\n    super()\r\n    @url = \"/db/user/#{me.id}/level.sessions?project=state.complete,levelID\"\r\n\r\nmodule.exports = class MainLadderView extends RootView\r\n  id: 'main-ladder-view'\r\n  template: template\r\n\r\n  initialize: ->\r\n    @levelStatusMap = []\r\n    @levelPlayCountMap = []\r\n    @campaigns = campaigns\r\n\r\n    @sessions = @supermodel.loadCollection(new LevelSessionsCollection(), 'your_sessions', {cache: false}, 0).model\r\n    @listenToOnce @sessions, 'sync', @onSessionsLoaded\r\n\r\n    @getLevelPlayCounts()\r\n\r\n  onSessionsLoaded: (e) ->\r\n    for session in @sessions.models\r\n      @levelStatusMap[session.get('levelID')] = if session.get('state')?.complete then 'complete' else 'started'\r\n    @render()\r\n\r\n  getLevelPlayCounts: ->\r\n    success = (levelPlayCounts) =>\r\n      return if @destroyed\r\n      for level in levelPlayCounts\r\n        @levelPlayCountMap[level._id] = playtime: level.playtime, sessions: level.sessions\r\n      @render() if @supermodel.finished()\r\n\r\n    levelIDs = []\r\n    for campaign in campaigns\r\n      for level in campaign.levels\r\n        levelIDs.push level.id\r\n    levelPlayCountsRequest = @supermodel.addRequestResource 'play_counts', {\r\n      url: '/db/level/-/play_counts'\r\n      data: {ids: levelIDs}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    levelPlayCountsRequest.load()\r\n\r\nheroArenas = [\r\n  {\r\n    name: 'Ace of Coders'\r\n    difficulty: 3\r\n    id: 'ace-of-coders'\r\n    image: '/file/db/level/55de80407a57948705777e89/Ace-of-Coders-banner.png'\r\n    description: 'Battle for control over the icy treasure chests as your gigantic warrior marshals his armies against his mirror-match nemesis.'\r\n  }\r\n  {\r\n    name: 'Zero Sum'\r\n    difficulty: 3\r\n    id: 'zero-sum'\r\n    image: '/file/db/level/550363b4ec31df9c691ab629/MAR26-Banner_Zero%20Sum.png'\r\n    description: 'Unleash your coding creativity in both gold gathering and battle tactics in this alpine mirror match between red sorcerer and blue sorcerer.'\r\n  }\r\n  {\r\n    name: 'Cavern Survival'\r\n    difficulty: 1\r\n    id: 'cavern-survival'\r\n    image: '/file/db/level/544437e0645c0c0000c3291d/OCT30-Cavern%20Survival.png'\r\n    description: 'Stay alive longer than your multiplayer opponent amidst hordes of ogres!'\r\n  }\r\n  {\r\n    name: 'Dueling Grounds'\r\n    difficulty: 1\r\n    id: 'dueling-grounds'\r\n    image: '/file/db/level/5442ba0e1e835500007eb1c7/OCT27-Dueling%20Grounds.png'\r\n    description: 'Battle head-to-head against another hero in this basic beginner combat arena.'\r\n  }\r\n  {\r\n    name: 'Multiplayer Treasure Grove'\r\n    difficulty: 2\r\n    id: 'multiplayer-treasure-grove'\r\n    image: '/file/db/level/5469643c37600b40e0e09c5b/OCT27-Multiplayer%20Treasure%20Grove.png'\r\n    description: 'Mix collection, flags, and combat in this multiplayer coin-gathering arena.'\r\n  }\r\n  {\r\n    name: 'Harrowland'\r\n    difficulty: 2\r\n    id: 'harrowland'\r\n    image: '/file/db/level/54b83c2629843994803c838e/OCT27-Harrowland.png'\r\n    description: 'Go head-to-head against another player in this dueling arena--but watch out for their friends!'\r\n  }\r\n]\r\n\r\ncampaigns = [\r\n  {id: 'multiplayer', name: 'Multiplayer Arenas', description: '... in which you code head-to-head against other players.', levels: heroArenas}\r\n]\r\n"]}