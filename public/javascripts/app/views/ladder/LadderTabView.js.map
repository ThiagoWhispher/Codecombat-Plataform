{"version":3,"sources":["app/views/ladder/LadderTabView.coffee"],"names":[],"mappings":"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","file":"public/javascripts/app/views/ladder/LadderTabView.js","sourcesContent":["CocoView = require 'views/core/CocoView'\r\nCocoClass = require 'core/CocoClass'\r\nLevel = require 'models/Level'\r\nLevelSession = require 'models/LevelSession'\r\nCocoCollection = require 'collections/CocoCollection'\r\nUser = require 'models/User'\r\nLeaderboardCollection  = require 'collections/LeaderboardCollection'\r\n{teamDataFromLevel} = require './utils'\r\nModelModal = require 'views/modal/ModelModal'\r\nrequire 'vendor/d3'\r\n\r\nHIGHEST_SCORE = 1000000\r\n\r\nmodule.exports = class LadderTabView extends CocoView\r\n  id: 'ladder-tab-view'\r\n  template: require 'templates/play/ladder/ladder-tab-view'\r\n\r\n  events:\r\n    'click .connect-facebook': 'onConnectFacebook'\r\n    'click .connect-google-plus': 'onConnectGPlus'\r\n    'click .name-col-cell': 'onClickPlayerName'\r\n    'click .spectate-cell': 'onClickSpectateCell'\r\n    'click .load-more-ladder-entries': 'onLoadMoreLadderEntries'\r\n\r\n    # Refactored, to-reimplement\r\n#  subscriptions:\r\n#    'auth:facebook-api-loaded': 'checkFriends'\r\n#    'auth:gplus-api-loaded': 'checkFriends'\r\n#    'auth:logged-in-with-facebook': 'onConnectedWithFacebook'\r\n#    'auth:logged-in-with-gplus': 'onConnectedWithGPlus'\r\n\r\n  initialize: (options, @level, @sessions) ->\r\n    @teams = teamDataFromLevel @level\r\n    @leaderboards = []\r\n    @refreshLadder()\r\n\r\n    @capitalize = _.string.capitalize\r\n\r\n    # Trying not loading the FP/G+ stuff for now to see if anyone complains they were using it so we can have just two columns.\r\n    #@socialNetworkRes = @supermodel.addSomethingResource('social_network_apis', 0)\r\n    #@checkFriends()\r\n\r\n  checkFriends: ->\r\n    return  # Skipping for now\r\n    return if @checked or (not window.FB) or (not window.gapi)\r\n    @checked = true\r\n\r\n    # @addSomethingToLoad('facebook_status')\r\n\r\n    @fbStatusRes = @supermodel.addSomethingResource('facebook_status', 0)\r\n    @fbStatusRes.load()\r\n\r\n    FB.getLoginStatus (response) =>\r\n      return if @destroyed\r\n      @facebookStatus = response.status\r\n      @onFacebook = view.facebookStatus is 'connected'\r\n      @loadFacebookFriends() if @onFacebook\r\n      @fbStatusRes.markLoaded()\r\n\r\n    if application.gplusHandler.loggedIn is undefined\r\n      @listenToOnce(application.gplusHandler, 'checked-state', @gplusSessionStateLoaded)\r\n    else\r\n      @gplusSessionStateLoaded()\r\n\r\n    @socialNetworkRes.markLoaded()\r\n\r\n  # FACEBOOK\r\n\r\n  onConnectFacebook: ->\r\n    @connecting = true\r\n    FB.login()\r\n\r\n  onConnectedWithFacebook: -> location.reload() if @connecting\r\n\r\n  loadFacebookFriends: ->\r\n    # @addSomethingToLoad('facebook_friends')\r\n\r\n    @fbFriendRes = @supermodel.addSomethingResource('facebook_friends', 0)\r\n    @fbFriendRes.load()\r\n\r\n    FB.api '/me/friends', @onFacebookFriendsLoaded\r\n\r\n  onFacebookFriendsLoaded: (response) =>\r\n    @facebookData = response.data\r\n    @loadFacebookFriendSessions()\r\n    @fbFriendRes.markLoaded()\r\n\r\n  loadFacebookFriendSessions: ->\r\n    levelFrag = \"#{@level.get('original')}.#{@level.get('version').major}\"\r\n    url = \"/db/level/#{levelFrag}/leaderboard_facebook_friends\"\r\n\r\n    @fbFriendSessionRes = @supermodel.addRequestResource('facebook_friend_sessions', {\r\n      url: url\r\n      data: { friendIDs: (f.id for f in @facebookData) }\r\n      method: 'POST'\r\n      success: @onFacebookFriendSessionsLoaded\r\n    })\r\n    @fbFriendSessionRes.load()\r\n\r\n  onFacebookFriendSessionsLoaded: (result) =>\r\n    friendsMap = {}\r\n    friendsMap[friend.id] = friend.name for friend in @facebookData\r\n    for friend in result\r\n      friend.name = friendsMap[friend.facebookID]\r\n      friend.otherTeam = if friend.team is 'humans' then 'ogres' else 'humans'\r\n      friend.imageSource = \"http://graph.facebook.com/#{friend.facebookID}/picture\"\r\n    @facebookFriendSessions = result\r\n    @friends = @consolidateFriends()\r\n    @render() # because the ladder tab renders before waiting for fb to finish\r\n\r\n  # GOOGLE PLUS\r\n\r\n  onConnectGPlus: ->\r\n    @connecting = true\r\n    @listenToOnce application.gplusHandler, 'logged-in', @onConnectedWithGPlus\r\n    application.gplusHandler.reauthorize()\r\n\r\n  onConnectedWithGPlus: -> location.reload() if @connecting\r\n\r\n  gplusSessionStateLoaded: ->\r\n    if application.gplusHandler.loggedIn\r\n      @onGPlus = true\r\n      #@addSomethingToLoad('gplus_friends')\r\n      @gpFriendRes = @supermodel.addSomethingResource('gplus_friends', 0)\r\n      @gpFriendRes.load()\r\n      application.gplusHandler.loadFriends @gplusFriendsLoaded\r\n\r\n  gplusFriendsLoaded: (friends) =>\r\n    @gplusData = friends.items\r\n    @loadGPlusFriendSessions()\r\n    @gpFriendRes.markLoaded()\r\n\r\n  loadGPlusFriendSessions: ->\r\n    levelFrag = \"#{@level.get('original')}.#{@level.get('version').major}\"\r\n    url = \"/db/level/#{levelFrag}/leaderboard_gplus_friends\"\r\n\r\n    @gpFriendSessionRes = @supermodel.addRequestResource('gplus_friend_sessions', {\r\n      url: url\r\n      data: { friendIDs: (f.id for f in @gplusData) }\r\n      method: 'POST'\r\n      success: @onGPlusFriendSessionsLoaded\r\n    })\r\n    @gpFriendSessionRes.load()\r\n\r\n  onGPlusFriendSessionsLoaded: (result) =>\r\n    friendsMap = {}\r\n    friendsMap[friend.id] = friend for friend in @gplusData\r\n    for friend in result\r\n      friend.name = friendsMap[friend.gplusID].displayName\r\n      friend.otherTeam = if friend.team is 'humans' then 'ogres' else 'humans'\r\n      friend.imageSource = friendsMap[friend.gplusID].image.url\r\n    @gplusFriendSessions = result\r\n    @friends = @consolidateFriends()\r\n    @render() # because the ladder tab renders before waiting for gplus to finish\r\n\r\n  # LADDER LOADING\r\n\r\n  refreshLadder: ->\r\n    # Only do this so often if not in a league; servers cache a lot of this data for a few minutes anyway.\r\n    return if not @options.league and (new Date() - 2 * 60 * 1000 < @lastRefreshTime)\r\n    @lastRefreshTime = new Date()\r\n    @supermodel.resetProgress()\r\n    @ladderLimit ?= parseInt @getQueryVariable('top_players', if @options.league then 100 else 20)\r\n    for team in @teams\r\n      if oldLeaderboard = @leaderboards[team.id]\r\n        @supermodel.removeModelResource oldLeaderboard\r\n        oldLeaderboard.destroy()\r\n      teamSession = _.find @sessions.models, (session) -> session.get('team') is team.id\r\n      @leaderboards[team.id] = new LeaderboardData(@level, team.id, teamSession, @ladderLimit, @options.league)\r\n      team.leaderboard = @leaderboards[team.id]\r\n      @leaderboardRes = @supermodel.addModelResource(@leaderboards[team.id], 'leaderboard', {cache: false}, 3)\r\n      @leaderboardRes.load()\r\n\r\n  render: ->\r\n    super()\r\n\r\n    @$el.find('.histogram-display').each (i, el) =>\r\n      histogramWrapper = $(el)\r\n      team = _.find @teams, name: histogramWrapper.data('team-name')\r\n      histogramData = null\r\n      $.when(\r\n        level = \"#{@level.get('original')}.#{@level.get('version').major}\"\r\n        url = \"/db/level/#{level}/histogram_data?team=#{team.name.toLowerCase()}\"\r\n        url += '&leagues.leagueID=' + @options.league.id if @options.league\r\n        $.get url, (data) -> histogramData = data\r\n      ).then =>\r\n        @generateHistogram(histogramWrapper, histogramData, team.name.toLowerCase()) unless @destroyed\r\n\r\n  generateHistogram: (histogramElement, histogramData, teamName) ->\r\n    #renders twice, hack fix\r\n    if $('#' + histogramElement.attr('id')).has('svg').length then return\r\n    histogramData = histogramData.map (d) -> d*100\r\n\r\n    margin =\r\n      top: 20\r\n      right: 20\r\n      bottom: 30\r\n      left: 15\r\n\r\n    width = 470 - margin.left - margin.right\r\n    height = 125 - margin.top - margin.bottom\r\n\r\n    formatCount = d3.format(',.0')\r\n\r\n    minX = Math.floor(Math.min(histogramData...) / 1000) * 1000\r\n    maxX = Math.ceil(Math.max(histogramData...) / 1000) * 1000\r\n    x = d3.scale.linear().domain([minX, maxX]).range([0, width])\r\n    data = d3.layout.histogram().bins(x.ticks(20))(histogramData)\r\n    y = d3.scale.linear().domain([0, d3.max(data, (d) -> d.y)]).range([height, 10])\r\n\r\n    #create the x axis\r\n    xAxis = d3.svg.axis().scale(x).orient('bottom').ticks(5).outerTickSize(0)\r\n\r\n    svg = d3.select('#' + histogramElement.attr('id')).append('svg')\r\n      .attr('width', width + margin.left + margin.right)\r\n      .attr('height', height + margin.top + margin.bottom)\r\n    .append('g')\r\n      .attr('transform', \"translate(#{margin.left}, #{margin.top})\")\r\n    barClass = 'bar'\r\n    if teamName.toLowerCase() is 'ogres' then barClass = 'ogres-bar'\r\n    if teamName.toLowerCase() is 'humans' then barClass = 'humans-bar'\r\n\r\n    bar = svg.selectAll('.bar')\r\n      .data(data)\r\n    .enter().append('g')\r\n      .attr('class', barClass)\r\n      .attr('transform', (d) -> \"translate(#{x(d.x)}, #{y(d.y)})\")\r\n\r\n    bar.append('rect')\r\n      .attr('x', 1)\r\n      .attr('width', width/20)\r\n      .attr('height', (d) -> height - y(d.y))\r\n    if session = @leaderboards[teamName].session\r\n      if @options.league\r\n        playerScore = (_.find(session.get('leagues'), {leagueID: @options.league.id})?.stats.totalScore or 10) * 100\r\n      else\r\n        playerScore = session.get('totalScore') * 100\r\n      scorebar = svg.selectAll('.specialbar')\r\n        .data([playerScore])\r\n        .enter().append('g')\r\n        .attr('class', 'specialbar')\r\n        .attr('transform', \"translate(#{x(playerScore)}, 0)\")\r\n\r\n      scorebar.append('rect')\r\n        .attr('x', 1)\r\n        .attr('width', 3)\r\n        .attr('height', height)\r\n    rankClass = 'rank-text'\r\n    if teamName.toLowerCase() is 'ogres' then rankClass = 'rank-text ogres-rank-text'\r\n    if teamName.toLowerCase() is 'humans' then rankClass = 'rank-text humans-rank-text'\r\n\r\n    message = \"#{histogramData.length} players\"\r\n    if @leaderboards[teamName].session?\r\n      if @options.league\r\n        # TODO: fix server handler to properly fetch myRank with a leagueID\r\n        message = \"#{histogramData.length} players in league\"\r\n      else if @leaderboards[teamName].myRank <= histogramData.length\r\n        message = \"##{@leaderboards[teamName].myRank} of #{histogramData.length}\"\r\n        message += \"+\" if histogramData.length >= 100000\r\n      else\r\n        message = 'Rank your session!'\r\n    svg.append('g')\r\n      .append('text')\r\n      .attr('class', rankClass)\r\n      .attr('y', 0)\r\n      .attr('text-anchor', 'end')\r\n      .attr('x', width)\r\n      .text(message)\r\n\r\n    #Translate the x-axis up\r\n    svg.append('g')\r\n      .attr('class', 'x axis')\r\n      .attr('transform', 'translate(0, ' + height + ')')\r\n      .call(xAxis)\r\n\r\n  consolidateFriends: ->\r\n    allFriendSessions = (@facebookFriendSessions or []).concat(@gplusFriendSessions or [])\r\n    sessions = _.uniq allFriendSessions, false, (session) -> session._id\r\n    if @options.league\r\n      sessions = _.sortBy sessions, (session) -> _.find(session.leagues, leagueID: @options.league.id)?.stats.totalScore ? (session.totalScore / 2)\r\n    else\r\n      sessions = _.sortBy sessions, 'totalScore'\r\n    sessions.reverse()\r\n    sessions\r\n\r\n  # Admin view of players' code\r\n  onClickPlayerName: (e) ->\r\n    return unless me.isAdmin()\r\n    row = $(e.target).parent()\r\n    player = new User _id: row.data 'player-id'\r\n    session = new LevelSession _id: row.data 'session-id'\r\n    @openModalView new ModelModal models: [session, player]\r\n\r\n  onClickSpectateCell: (e) ->\r\n    cell = $(e.target).closest '.spectate-cell'\r\n    row = cell.parent()\r\n    table = row.closest('table')\r\n    wasSelected = cell.hasClass 'selected'\r\n    table.find('.spectate-cell.selected').removeClass 'selected'\r\n    cell = $(e.target).closest('.spectate-cell').toggleClass 'selected', not wasSelected\r\n    sessionID = row.data 'session-id'\r\n    teamID = table.data 'team'\r\n    @spectateTargets ?= {}\r\n    @spectateTargets[teamID] = if wasSelected then null else sessionID\r\n    console.log @spectateTargets, cell, row, table\r\n\r\n  onLoadMoreLadderEntries: (e) ->\r\n    @ladderLimit ?= 100\r\n    @ladderLimit += 100\r\n    @lastRefreshTime = null\r\n    @refreshLadder()\r\n\r\nmodule.exports.LeaderboardData = LeaderboardData = class LeaderboardData extends CocoClass\r\n  ###\r\n  Consolidates what you need to load for a leaderboard into a single Backbone Model-like object.\r\n  ###\r\n\r\n  constructor: (@level, @team, @session, @limit, @league) ->\r\n    super()\r\n\r\n  collectionParameters: (parameters) ->\r\n    parameters.team = @team\r\n    parameters['leagues.leagueID'] = @league.id if @league\r\n    parameters\r\n\r\n  fetch: ->\r\n    console.warn 'Already have top players on', @ if @topPlayers\r\n\r\n    @topPlayers = new LeaderboardCollection(@level, @collectionParameters(order: -1, scoreOffset: HIGHEST_SCORE, limit: @limit))\r\n    promises = []\r\n    promises.push @topPlayers.fetch cache: false\r\n\r\n    if @session\r\n      if @league\r\n        score = _.find(@session.get('leagues'), {leagueID: @league.id})?.stats.totalScore\r\n      else\r\n        score = @session.get('totalScore')\r\n      if score\r\n        @playersAbove = new LeaderboardCollection(@level, @collectionParameters(order: 1, scoreOffset: score, limit: 4))\r\n        promises.push @playersAbove.fetch cache: false\r\n        @playersBelow = new LeaderboardCollection(@level, @collectionParameters(order: -1, scoreOffset: score, limit: 4))\r\n        promises.push @playersBelow.fetch cache: false\r\n        level = \"#{@level.get('original')}.#{@level.get('version').major}\"\r\n        success = (@myRank) =>\r\n        loadURL = \"/db/level/#{level}/leaderboard_rank?scoreOffset=#{score}&team=#{@team}\"\r\n        loadURL += '&leagues.leagueID=' + @league.id if @league\r\n        promises.push $.ajax(loadURL, cache: false, success: success)\r\n    @promise = $.when(promises...)\r\n    @promise.then @onLoad\r\n    @promise.fail @onFail\r\n    @promise\r\n\r\n  onLoad: =>\r\n    return if @destroyed or not @topPlayers.loaded\r\n    @loaded = true\r\n    @loading = false\r\n    @trigger 'sync', @\r\n    # TODO: cache user ids -> names mapping, and load them here as needed,\r\n    #   and apply them to sessions. Fetching each and every time is too costly.\r\n\r\n  onFail: (resource, jqxhr) =>\r\n    return if @destroyed\r\n    @trigger 'error', @, jqxhr\r\n\r\n  inTopSessions: ->\r\n    return me.id in (session.attributes.creator for session in @topPlayers.models)\r\n\r\n  nearbySessions: ->\r\n    if @league\r\n      score = _.find(@session?.get('leagues'), {leagueID: @league.id})?.stats.totalScore\r\n    else\r\n      score = @session?.get('totalScore')\r\n    return [] unless score\r\n    l = []\r\n    above = @playersAbove.models\r\n    l = l.concat(above)\r\n    l.reverse()\r\n    l.push @session\r\n    l = l.concat(@playersBelow.models)\r\n    if @myRank\r\n      startRank = @myRank - 4\r\n      session.rank = startRank + i for session, i in l\r\n    l\r\n\r\n  allResources: ->\r\n    resources = [@topPlayers, @playersAbove, @playersBelow]\r\n    return (r for r in resources when r)\r\n"]}