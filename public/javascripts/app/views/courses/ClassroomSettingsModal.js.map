{"version":3,"sources":["app/templates/courses/classroom-settings-modal.jade","app/views/courses/ClassroomSettingsModal.coffee"],"names":[],"mappings":"AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvGA;AAAA;;ACAA;EAAA;;;AAAA,YAAY,QAAQ,kBAAR;;AACZ,YAAY,QAAQ,sBAAR;;AACZ,WAAW,QAAQ,4CAAR;;AACX,QAAQ,QAAQ,YAAR;;AACR,SAAS,QAAQ,aAAR;;AAET,MAAM,CAAC,OAAP,GAAuB;;;;;;;mCACrB,KAAI;;mCACJ,WAAU;;mCAEV,SACE;IAAA,4BAA4B,cAA5B;IACA,6BAA6B,4BAD7B;IAEA,eAAe,cAFf;;;mCAIF,aAAY,SAAC,OAAD;;MAAC,UAAQ;;WACnB,IAAC,UAAD,GAAa,OAAO,CAAC,SAAR,IAAyB;EAD5B;;mCAGZ,cAAa;IACX;WACA,KAAK,CAAC,aAAN,CAAoB,IAAC,EAAD,CAAG,MAAH,CAApB;EAFW;;mCAIb,eAAc,SAAC,CAAD;AACZ;IAAA,IAAC,UAAS,CAAC,UAAX,GAAwB;IACxB,CAAC,CAAC,cAAF;IACA,OAAO,IAAC,EAAD,CAAG,MAAH;IACP,KAAK,CAAC,eAAN,CAAsB,IAAtB;IACA,QAAQ,KAAK,CAAC,YAAN,CAAmB,IAAnB,EAAyB;MAAA,mBAAmB,KAAnB;KAAzB;IACR,IAAG,KAAK,CAAC,QAAT;MACE,KAAK,CAAC,SAAN,GAAkB;QAAE,UAAU,KAAK,CAAC,QAAlB;;MAClB,OAAO,KAAK,CAAC,SAFf;KAAA;MAIE,KAAK,CAAC,kBAAN,CAAyB,IAAzB,EAA+B,UAA/B,EAA2C,CAAC,CAAC,IAAI,CAAC,CAAP,CAAS,uBAAT,CAA3C;AACA,aALF;;IAMA,IAAC,UAAS,CAAC,GAAX,CAAe,KAAf;IACA,eAAe,IAAC,UAAS,CAAC,mBAAX;IACf,IAAG,YAAH;AACE;;QACE,IAAG,KAAK,CAAC,UAAN,KAAoB,4BAAvB;UACE,KAAK,CAAC,OAAN,GAAgB,6BADlB;;AADF;MAGA,KAAK,CAAC,iBAAN,CAAwB,IAAxB,EAA8B,YAA9B;AACA,aALF;;IAOA,SAAS,IAAC,EAAD,CAAG,oBAAH;IACT,IAAC,cAAD,GAAiB,MAAM,CAAC,IAAP;IACjB,MAAM,CAAC,IAAP,CAAY,CAAC,CAAC,IAAI,CAAC,CAAP,CAAS,eAAT,CAAZ,CAAsC,CAAC,IAAvC,CAA4C,UAA5C,EAAwD,IAAxD;IACA,IAAC,UAAS,CAAC,IAAX;IACA,IAAC,aAAD,CAAc,IAAC,UAAf,EAA0B,OAA1B,EAAmC,SAAC,KAAD,EAAQ,KAAR;MACjC,IAAC,cAAD,CAAe,IAAC,UAAhB,EAA2B,MAA3B,EAAmC,IAAC,KAApC;MACA,MAAM,CAAC,IAAP,CAAY,IAAC,cAAb,CAA2B,CAAC,IAA5B,CAAiC,UAAjC,EAA6C,KAA7C;aACA,MAAM,CAAC,oBAAP,CAA4B,KAA5B;IAHiC,CAAnC;IAIA,IAAC,aAAD,CAAc,IAAC,UAAf,EAA0B,MAA1B,EAAkC,IAAC,KAAnC;+CACc,CAAE,UAAhB,CAA2B,2BAA3B,EAAwD;MAAA,UAAU,UAAV;MAAsB,aAAa,IAAC,UAAS,CAAC,EAA9C;KAAxD,EAA0G,CAAC,UAAD,CAA1G;EA9BY;;mCAgCd,6BAA4B;IAC1B,IAAC,EAAD,CAAG,qBAAH,CAAyB,CAAC,IAA1B,CAA+B,UAA/B,EAA2C,IAA3C;WACA,OAAO,CAAC,OAAR,CAAgB,IAAC,UAAS,CAAC,aAAX,EAAhB,CACA,CAAC,IADD,CACM;aAAA;QACJ,KAAC,EAAD,CAAG,qBAAH,CAAyB,CAAC,IAA1B,CAA+B,UAA/B,EAA2C,KAA3C;eACA,KAAK;UAAE,MAAM,SAAR;UAAmB,SAAS,IAA5B;SAAL;MAFI;IAAA,QADN,CAIA,CAAC,OAAD,CAJA,CAIO;aAAA,SAAC,CAAD;AACL;QAAA,OAAO,CAAC,GAAR,CAAY,GAAZ,EAAiB,CAAjB;QACA,KAAC,EAAD,CAAG,qBAAH,CAAyB,CAAC,IAA1B,CAA+B,UAA/B,EAA2C,KAA3C;eACA,KAAK;UAAE,2CAAoB,CAAE,iBAAhB,IAA2B,CAAC,CAAC,YAA7B,IAA6C,QAArD;UAA+D,MAAM,OAArE;UAA8E,SAAS,IAAvF;SAAL;MAHK;IAAA,QAJP;EAF0B;;;;GAhDwB","file":"public/javascripts/app/views/courses/ClassroomSettingsModal.js","sourcesContent":["var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),view = locals_.view,_ = locals_._,me = locals_.me;var ageRange_mixin = function(name){\nvar block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};\nbuf.push(\"<select\" + (jade.attrs({ 'name':(name), 'value':(view.classroom.get(name)), \"class\": [('age-range-select'),('form-control')] }, {\"name\":true,\"value\":true})) + \"><option value=\\\"\\\">-</option><option value=\\\"&lt;6\\\" data-i18n=\\\"courses.student_age_range_younger\\\"></option>\");\n// iterate _.range(6,18)\n;(function(){\n  var $$obj = _.range(6,18);\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var i = $$obj[$index];\n\nbuf.push(\"<option\" + (jade.attrs({ 'value':(i) }, {\"value\":true})) + \">\" + (jade.escape(null == (jade.interp = i) ? \"\" : jade.interp)) + \"</option>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var i = $$obj[$index];\n\nbuf.push(\"<option\" + (jade.attrs({ 'value':(i) }, {\"value\":true})) + \">\" + (jade.escape(null == (jade.interp = i) ? \"\" : jade.interp)) + \"</option>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<option value=\\\"18\\\" data-i18n=\\\"courses.student_age_range_older\\\"></option></select>\");\n};\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content style-flat\\\"><div class=\\\"modal-header\\\">\");\nif ( view.closeButton)\n{\nbuf.push(\"<div type=\\\"button\\\" data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div>\");\n}\nif ( view.classroom.isNew())\n{\nbuf.push(\"<h3 data-i18n=\\\"courses.create_new_class\\\" class=\\\"modal-title\\\"></h3>\");\n}\nelse\n{\nbuf.push(\"<h3 data-i18n=\\\"courses.edit_settings1\\\" class=\\\"modal-title\\\"></h3>\");\n}\nbuf.push(\"</div><div class=\\\"modal-body\\\"><form><div class=\\\"form-group\\\"><label data-i18n=\\\"courses.class_name\\\"></label><input\" + (jade.attrs({ 'id':('name-input'), 'name':(\"name\"), 'type':('text'), 'value':(view.classroom.get('name')), \"class\": [('form-control')] }, {\"name\":true,\"type\":true,\"value\":true})) + \"/></div><div class=\\\"form-group\\\"><label><span data-i18n=\\\"general.description\\\"></span><i data-i18n=\\\"signup.optional\\\" class=\\\"spl text-muted\\\"></i></label><textarea name=\\\"description\\\" rows=\\\"2\\\" class=\\\"form-control\\\">\" + (jade.escape(null == (jade.interp = view.classroom.get('description')) ? \"\" : jade.interp)) + \"</textarea></div><div class=\\\"form-group\\\"><label data-i18n=\\\"choose_hero.programming_language\\\"></label>\");\nvar aceConfig = view.classroom.get('aceConfig') || {};\nvar languageDisabled = !!_.size(view.classroom.get('members'));\nbuf.push(\"<div data-i18n=\\\"courses.language_cannot_change\\\" class=\\\"help-block small text-navy\\\"></div><select\" + (jade.attrs({ 'id':('programming-language-select'), 'name':(\"language\"), 'value':(aceConfig.language), 'disabled':(languageDisabled), \"class\": [('form-control')] }, {\"name\":true,\"value\":true,\"disabled\":true})) + \">\");\nvar aceConfig = view.classroom.get('aceConfig') || {};\nbuf.push(\"<option value=\\\"\\\" data-i18n=\\\"courses.language_select\\\"></option><option value=\\\"python\\\">Python</option><option value=\\\"javascript\\\">JavaScript</option></select></div><div class=\\\"form-group\\\"><label><span data-i18n=\\\"courses.avg_student_exp_label\\\"></span><i data-i18n=\\\"signup.optional\\\" class=\\\"spl text-muted\\\"></i></label><div data-i18n=\\\"courses.avg_student_exp_desc\\\" class=\\\"help-block small text-navy\\\"></div><select\" + (jade.attrs({ 'name':(\"averageStudentExp\"), 'value':(view.classroom.get('averageStudentExp')), \"class\": [('form-control')] }, {\"name\":true,\"value\":true})) + \"><option value=\\\"\\\" data-i18n=\\\"courses.avg_student_exp_select\\\"></option><option value=\\\"none\\\" data-i18n=\\\"courses.avg_student_exp_none\\\"></option><option value=\\\"beginner\\\" data-i18n=\\\"courses.avg_student_exp_beginner\\\"></option><option value=\\\"intermediate\\\" data-i18n=\\\"courses.avg_student_exp_intermediate\\\"></option><option value=\\\"advanced\\\" data-i18n=\\\"courses.avg_student_exp_advanced\\\"></option><option value=\\\"varied\\\" data-i18n=\\\"courses.avg_student_exp_varied\\\"></option></select></div><div class=\\\"form-group\\\"><label><span data-i18n=\\\"courses.student_age_range_label\\\"></span><i data-i18n=\\\"signup.optional\\\" class=\\\"spl text-muted\\\"></i></label><div>\");\nageRange_mixin(\"ageRangeMin\");\nbuf.push(\"<span data-i18n=\\\"courses.student_age_range_to\\\" class=\\\"spl spr\\\"></span>\");\nageRange_mixin(\"ageRangeMax\");\nbuf.push(\"</div>\");\nvar ageRange_mixin = function(name){\nvar block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};\nbuf.push(\"<select\" + (jade.attrs({ 'name':(name), 'value':(view.classroom.get(name)), \"class\": [('age-range-select'),('form-control')] }, {\"name\":true,\"value\":true})) + \"><option value=\\\"\\\">-</option><option value=\\\"&lt;6\\\" data-i18n=\\\"courses.student_age_range_younger\\\"></option>\");\n// iterate _.range(6,18)\n;(function(){\n  var $$obj = _.range(6,18);\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var i = $$obj[$index];\n\nbuf.push(\"<option\" + (jade.attrs({ 'value':(i) }, {\"value\":true})) + \">\" + (jade.escape(null == (jade.interp = i) ? \"\" : jade.interp)) + \"</option>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var i = $$obj[$index];\n\nbuf.push(\"<option\" + (jade.attrs({ 'value':(i) }, {\"value\":true})) + \">\" + (jade.escape(null == (jade.interp = i) ? \"\" : jade.interp)) + \"</option>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<option value=\\\"18\\\" data-i18n=\\\"courses.student_age_range_older\\\"></option></select>\");\n};\nbuf.push(\"</div></form></div><div class=\\\"modal-body wait secret\\\"><h3>Reticulating Splines...</h3><div class=\\\"progress progress-striped active\\\"><div class=\\\"progress-bar\\\"></div></div></div><div class=\\\"modal-footer\\\"><div class=\\\"text-center\\\">\");\nif ( view.classroom.isNew())\n{\nbuf.push(\"<button id=\\\"save-settings-btn\\\" data-i18n=\\\"courses.create_class\\\" class=\\\"btn btn-primary btn-lg\\\"></button>\");\n}\nelse\n{\nbuf.push(\"<button id=\\\"save-settings-btn\\\" data-i18n=\\\"common.save_changes\\\" class=\\\"btn btn-primary btn-lg\\\"></button>\");\n}\nif ( me.isAdmin())\n{\nbuf.push(\"<hr/><!-- DNT--><h3>Admin Only</h3><button id=\\\"update-courses-btn\\\" class=\\\"btn btn-forest btn-lg\\\">Update Courses</button>\");\n}\nbuf.push(\"</div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","Classroom = require 'models/Classroom'\r\nModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/courses/classroom-settings-modal'\r\nforms = require 'core/forms'\r\nerrors = require 'core/errors'\r\n\r\nmodule.exports = class ClassroomSettingsModal extends ModalView\r\n  id: 'classroom-settings-modal'\r\n  template: template\r\n\r\n  events:\r\n    'click #save-settings-btn': 'onSubmitForm'\r\n    'click #update-courses-btn': 'onClickUpdateCoursesButton'\r\n    'submit form': 'onSubmitForm'\r\n\r\n  initialize: (options={}) ->\r\n    @classroom = options.classroom or new Classroom()\r\n\r\n  afterRender: ->\r\n    super()\r\n    forms.updateSelects(@$('form'))\r\n\r\n  onSubmitForm: (e) ->\r\n    @classroom.notyErrors = false\r\n    e.preventDefault()\r\n    form = @$('form')\r\n    forms.clearFormAlerts(form)\r\n    attrs = forms.formToObject(form, ignoreEmptyString: false)\r\n    if attrs.language\r\n      attrs.aceConfig = { language: attrs.language }\r\n      delete attrs.language\r\n    else\r\n      forms.setErrorToProperty(form, 'language', $.i18n.t('common.required_field'))\r\n      return\r\n    @classroom.set(attrs)\r\n    schemaErrors = @classroom.getValidationErrors()\r\n    if schemaErrors\r\n      for error in schemaErrors\r\n        if error.schemaPath is \"/properties/name/minLength\"\r\n          error.message = 'Please enter a class name.'\r\n      forms.applyErrorsToForm(form, schemaErrors)\r\n      return\r\n\r\n    button = @$('#save-settings-btn')\r\n    @oldButtonText = button.text()\r\n    button.text($.i18n.t('common.saving')).attr('disabled', true)\r\n    @classroom.save()\r\n    @listenToOnce @classroom, 'error', (model, jqxhr) ->\r\n      @stopListening @classroom, 'sync', @hide\r\n      button.text(@oldButtonText).attr('disabled', false)\r\n      errors.showNotyNetworkError(jqxhr)\r\n    @listenToOnce @classroom, 'sync', @hide\r\n    window.tracker?.trackEvent \"Teachers Edit Class Saved\", category: 'Teachers', classroomID: @classroom.id, ['Mixpanel']\r\n\r\n  onClickUpdateCoursesButton: ->\r\n    @$('#update-courses-btn').attr('disabled', true)\r\n    Promise.resolve(@classroom.updateCourses())\r\n    .then =>\r\n      @$('#update-courses-btn').attr('disabled', false)\r\n      noty { text: 'Updated', timeout: 2000 }\r\n    .catch (e) =>\r\n      console.log 'e', e\r\n      @$('#update-courses-btn').attr('disabled', false)\r\n      noty { text: e.responseJSON?.message or e.responseText or 'Error!', type: 'error', timeout: 5000 }\r\n"]}