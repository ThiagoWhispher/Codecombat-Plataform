{"version":3,"sources":["app/templates/editor/campaign/campaign-level-view.jade","app/views/editor/campaign/CampaignLevelView.coffee"],"names":[],"mappings":"AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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","file":"public/javascripts/app/views/editor/campaign/CampaignLevelView.js","sourcesContent":["var __templateData = function anonymous(locals\n/**/) {\nvar buf = [];\nvar locals_ = (locals || {}),level = locals_.level,analytics = locals_.analytics;buf.push(\"<div class=\\\"jumbotron\\\"><div type=\\\"button\\\" aria-hidden=\\\"true\\\" class=\\\"button close\\\">&times;</div><h1><span class=\\\"spr\\\">\" + (jade.escape(null == (jade.interp = level.get('name')) ? \"\" : jade.interp)) + \"</span><a\" + (jade.attrs({ 'href':(\"/editor/level/\" + (level.get('slug')) + \"\"), 'target':(\"_blank\") }, {\"href\":true,\"target\":true})) + \">(edit)</a></h1><p>\" + (jade.escape(null == (jade.interp = level.get('description')) ? \"\" : jade.interp)) + \"</p>\");\nif ( analytics.startDay && analytics.endDay)\n{\nbuf.push(\"<div class=\\\"input-group input-group-sm\\\"><input\" + (jade.attrs({ 'id':('input-startday'), 'type':('text'), 'style':('width:100px;'), 'value':(analytics.startDay), \"class\": [('form-control')] }, {\"type\":true,\"style\":true,\"value\":true})) + \"/><input\" + (jade.attrs({ 'id':('input-endday'), 'type':('text'), 'style':('width:100px;'), 'value':(analytics.endDay), \"class\": [('form-control')] }, {\"type\":true,\"style\":true,\"value\":true})) + \"/><button id=\\\"reload-button\\\" style=\\\"margin-left:10px;\\\" class=\\\"btn btn-default btn-sm\\\">Reload</button></div>\");\n}\n// iterate analytics.graphs\n;(function(){\n  var $$obj = analytics.graphs;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var graph = $$obj[$index];\n\n// iterate graph.lines\n;(function(){\n  var $$obj = graph.lines;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var line = $$obj[$index];\n\nbuf.push(\"<label class=\\\"line-graph-label\\\"><input\" + (jade.attrs({ 'data-lineid':(\"\" + (line.lineID) + \"\"), 'type':('checkbox'), 'checked':(line.enabled), \"class\": [('line-graph-checkbox')] }, {\"data-lineid\":true,\"type\":true,\"checked\":true})) + \"/><span>\" + (jade.escape((jade.interp = line.description) == null ? '' : jade.interp)) + \"</span><span>&nbsp;&nbsp;</span></label>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var line = $$obj[$index];\n\nbuf.push(\"<label class=\\\"line-graph-label\\\"><input\" + (jade.attrs({ 'data-lineid':(\"\" + (line.lineID) + \"\"), 'type':('checkbox'), 'checked':(line.enabled), \"class\": [('line-graph-checkbox')] }, {\"data-lineid\":true,\"type\":true,\"checked\":true})) + \"/><span>\" + (jade.escape((jade.interp = line.description) == null ? '' : jade.interp)) + \"</span><span>&nbsp;&nbsp;</span></label>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<div class=\\\"line-graph-container\\\">\");\n// iterate graph.lines\n;(function(){\n  var $$obj = graph.lines;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var line = $$obj[$index];\n\n// iterate line.points\n;(function(){\n  var $$obj = line.points;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var line = $$obj[$index];\n\n// iterate line.points\n;(function(){\n  var $$obj = line.points;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var graph = $$obj[$index];\n\n// iterate graph.lines\n;(function(){\n  var $$obj = graph.lines;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var line = $$obj[$index];\n\nbuf.push(\"<label class=\\\"line-graph-label\\\"><input\" + (jade.attrs({ 'data-lineid':(\"\" + (line.lineID) + \"\"), 'type':('checkbox'), 'checked':(line.enabled), \"class\": [('line-graph-checkbox')] }, {\"data-lineid\":true,\"type\":true,\"checked\":true})) + \"/><span>\" + (jade.escape((jade.interp = line.description) == null ? '' : jade.interp)) + \"</span><span>&nbsp;&nbsp;</span></label>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var line = $$obj[$index];\n\nbuf.push(\"<label class=\\\"line-graph-label\\\"><input\" + (jade.attrs({ 'data-lineid':(\"\" + (line.lineID) + \"\"), 'type':('checkbox'), 'checked':(line.enabled), \"class\": [('line-graph-checkbox')] }, {\"data-lineid\":true,\"type\":true,\"checked\":true})) + \"/><span>\" + (jade.escape((jade.interp = line.description) == null ? '' : jade.interp)) + \"</span><span>&nbsp;&nbsp;</span></label>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<div class=\\\"line-graph-container\\\">\");\n// iterate graph.lines\n;(function(){\n  var $$obj = graph.lines;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var line = $$obj[$index];\n\n// iterate line.points\n;(function(){\n  var $$obj = line.points;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var line = $$obj[$index];\n\n// iterate line.points\n;(function(){\n  var $$obj = line.points;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attrs({ 'data-pointid':(\"\" + (point.pointID) + \"\"), \"class\": [('graph-point-info-container')] }, {\"data-pointid\":true})) + \"><div style=\\\"font-weight:bold;\\\">\" + (jade.escape((jade.interp = point.day) == null ? '' : jade.interp)) + \"</div>\");\n// iterate point.values\n;(function(){\n  var $$obj = point.values;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var value = $$obj[$index];\n\nbuf.push(\"<div>\" + (jade.escape((jade.interp = value) == null ? '' : jade.interp)) + \"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<h4>Common Problems</h4>\");\nif ( analytics.commonProblems.loading)\n{\nbuf.push(\"<div>Loading...</div>\");\n}\nelse\n{\nbuf.push(\"<table style=\\\"font-size:10pt\\\" class=\\\"table table-bordered table-condensed table-hover\\\"><thead><tr><td>Language</td><td>Error Message</td><td>Error Hint</td><td>Count</td></tr></thead><tbody>\");\nfor (var i = 0; i < analytics.commonProblems.data.length && i < 20; i++)\n{\nbuf.push(\"<tr><td>\" + (jade.escape(null == (jade.interp = analytics.commonProblems.data[i].language) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.commonProblems.data[i].message) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.commonProblems.data[i].hint) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.commonProblems.data[i].count) ? \"\" : jade.interp)) + \"</td></tr>\");\n}\nbuf.push(\"</tbody></table>\");\n}\nbuf.push(\"<h4>Recent Sessions</h4>\");\nif ( analytics.recentSessions.loading)\n{\nbuf.push(\"<div>Loading...</div>\");\n}\nelse\n{\nbuf.push(\"<div style=\\\"font-size:10pt\\\">Latest \" + (jade.escape((jade.interp = analytics.recentSessions.data.length) == null ? '' : jade.interp)) + \" sessions for this level</div><div style=\\\"font-size:10pt\\\">Double-click row to open player and session</div><table style=\\\"font-size:10pt\\\" class=\\\"table table-bordered table-condensed table-hover\\\"><thead><tr><td>Session ID</td><td>Player</td><td>Code Language</td><td>Playtime</td><td>Complete</td><td>Changed</td><td>Replay</td></tr></thead><tbody>\");\nfor (var i = 0; i < analytics.recentSessions.data.length; i++)\n{\nbuf.push(\"<tr\" + (jade.attrs({ 'data-player-id':(analytics.recentSessions.data[i].creator), 'data-session-id':(analytics.recentSessions.data[i]._id), \"class\": [('recent-session')] }, {\"data-player-id\":true,\"data-session-id\":true})) + \"><td>\" + (jade.escape(null == (jade.interp = analytics.recentSessions.data[i]._id) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.recentSessions.data[i].creatorName || analytics.recentSessions.data[i].creator) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.recentSessions.data[i].codeLanguage) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.recentSessions.data[i].playtime) ? \"\" : jade.interp)) + \"</td>\");\nif ( analytics.recentSessions.data[i].state && analytics.recentSessions.data[i].state.complete)\n{\nbuf.push(\"<td>\" + (jade.escape(null == (jade.interp = analytics.recentSessions.data[i].state.complete) ? \"\" : jade.interp)) + \"</td>\");\n}\nelse\n{\nbuf.push(\"<td>false</td>\");\n}\nbuf.push(\"<td>\" + (jade.escape(null == (jade.interp = analytics.recentSessions.data[i].changed) ? \"\" : jade.interp)) + \"</td><td><button class=\\\"btn replay-button btn-xs\\\"><div class=\\\"glyphicon glyphicon-eye-open\\\"></div></button></td></tr>\");\n}\nbuf.push(\"</tbody></table>\");\n}\nbuf.push(\"<h4>Completion Rates</h4>\");\nif ( analytics.levelCompletions.loading)\n{\nbuf.push(\"<div>Loading...</div>\");\n}\nelse\n{\nbuf.push(\"<table style=\\\"font-size:10pt\\\" class=\\\"table table-bordered table-condensed table-hover\\\"><thead><tr><td>Date</td><td>Started</td><td>Finished</td><td>Completion %</td>\");\nif ( analytics.levelHelps.data.length === analytics.levelCompletions.data.length)\n{\nbuf.push(\"<td>Helps Clicked</td><td>Helps / Started</td><td>Help Videos</td><td>Videos / Started</td>\");\n}\nbuf.push(\"</tr></thead><tbody>\");\nfor (var i = 0; i < analytics.levelCompletions.data.length; i++)\n{\nbuf.push(\"<tr><td>\" + (jade.escape(null == (jade.interp = analytics.levelCompletions.data[i].created) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.levelCompletions.data[i].started) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.levelCompletions.data[i].finished) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.levelCompletions.data[i].rate) ? \"\" : jade.interp)) + \"</td>\");\nif ( analytics.levelHelps.data.length === analytics.levelCompletions.data.length && analytics.levelCompletions.data[i].created == analytics.levelHelps.data[i].day)\n{\nbuf.push(\"<td>\" + (jade.escape(null == (jade.interp = analytics.levelHelps.data[i].alertHelps + analytics.levelHelps.data[i].paletteHelps) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = ((analytics.levelHelps.data[i].alertHelps + analytics.levelHelps.data[i].paletteHelps) / analytics.levelCompletions.data[i].started).toFixed(2)) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.levelHelps.data[i].videoStarts) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = (analytics.levelHelps.data[i].videoStarts / analytics.levelCompletions.data[i].started).toFixed(2)) ? \"\" : jade.interp)) + \"</td>\");\n}\nbuf.push(\"</tr>\");\n}\nbuf.push(\"</tbody></table>\");\n}\nbuf.push(\"<h4>Average Playtimes</h4>\");\nif ( analytics.levelPlaytimes.loading)\n{\nbuf.push(\"<div>Loading...</div>\");\n}\nelse\n{\nbuf.push(\"<table style=\\\"font-size:10pt\\\" class=\\\"table table-bordered table-condensed table-hover\\\"><thead><tr><td>Date</td><td>Average (s)</td></tr></thead><tbody>\");\nfor (var i = 0; i < analytics.levelPlaytimes.data.length; i++)\n{\nbuf.push(\"<tr><td>\" + (jade.escape(null == (jade.interp = analytics.levelPlaytimes.data[i].created) ? \"\" : jade.interp)) + \"</td><td>\" + (jade.escape(null == (jade.interp = analytics.levelPlaytimes.data[i].average.toFixed(2)) ? \"\" : jade.interp)) + \"</td></tr>\");\n}\nbuf.push(\"</tbody></table>\");\n}\nbuf.push(\"</div>\");\nif ( level.get('tasks'))\n{\nbuf.push(\"<div class=\\\"tasks\\\"><h3>Tasks (read only)</h3><ul class=\\\"list-unstyled\\\">\");\n// iterate level.get('tasks')\n;(function(){\n  var $$obj = level.get('tasks');\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var task = $$obj[$index];\n\nbuf.push(\"<li><input\" + (jade.attrs({ 'type':('checkbox'), 'checked':(task.complete) }, {\"type\":true,\"checked\":true})) + \"/><span class=\\\"spl\\\">\" + (jade.escape(null == (jade.interp = task.name) ? \"\" : jade.interp)) + \"</span></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var task = $$obj[$index];\n\nbuf.push(\"<li><input\" + (jade.attrs({ 'type':('checkbox'), 'checked':(task.complete) }, {\"type\":true,\"checked\":true})) + \"/><span class=\\\"spl\\\">\" + (jade.escape(null == (jade.interp = task.name) ? \"\" : jade.interp)) + \"</span></li>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul></div>\");\n};return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","CocoView = require 'views/core/CocoView'\r\nLevel = require 'models/Level'\r\nLevelSession = require 'models/LevelSession'\r\nModelModal = require 'views/modal/ModelModal'\r\nUser = require 'models/User'\r\nutils = require 'core/utils'\r\n\r\nmodule.exports = class CampaignLevelView extends CocoView\r\n  id: 'campaign-level-view'\r\n  template: require 'templates/editor/campaign/campaign-level-view'\r\n\r\n  events:\r\n    'change .line-graph-checkbox': 'updateGraphCheckbox'\r\n    'click .close': 'onClickClose'\r\n    'click #reload-button': 'onClickReloadButton'\r\n    'dblclick .recent-session': 'onDblClickRecentSession'\r\n    'mouseenter .graph-point': 'onMouseEnterPoint'\r\n    'mouseleave .graph-point': 'onMouseLeavePoint'\r\n    'click .replay-button': 'onClickReplay'\r\n\r\n  constructor: (options, @level) ->\r\n    super(options)\r\n    @fullLevel = new Level _id: @level.id\r\n    @fullLevel.fetch()\r\n    @listenToOnce @fullLevel, 'sync', => @render?()\r\n    @levelSlug = @level.get('slug')\r\n    @getAnalytics()\r\n\r\n  getRenderData: ->\r\n    c = super()\r\n    c.level = if @fullLevel.loaded then @fullLevel else @level\r\n    c.analytics = @analytics\r\n    c\r\n\r\n  afterRender: ->\r\n    super()\r\n    $(\"#input-startday\").datepicker dateFormat: \"yy-mm-dd\"\r\n    $(\"#input-endday\").datepicker dateFormat: \"yy-mm-dd\"\r\n    # TODO: Why does this have to be called from afterRender() instead of getRenderData()?\r\n    @updateAnalyticsGraphs()\r\n\r\n  updateGraphCheckbox: (e) ->\r\n    lineID = $(e.target).data('lineid')\r\n    checked = $(e.target).prop('checked')\r\n    for graph in @analytics.graphs\r\n      for line in graph.lines\r\n        if line.lineID is lineID\r\n          line.enabled = checked\r\n          return @render()\r\n\r\n  onClickClose: ->\r\n    @$el.addClass('hidden')\r\n    @trigger 'hidden'\r\n\r\n  onClickReloadButton: () =>\r\n    startDay = $('#input-startday').val()\r\n    endDay = $('#input-endday').val()\r\n    @getAnalytics startDay, endDay\r\n\r\n  onDblClickRecentSession: (e) ->\r\n    # Admin view of players' code\r\n    return unless me.isAdmin()\r\n    row = $(e.target).parent()\r\n    player = new User _id: row.data 'player-id'\r\n    session = new LevelSession _id: row.data 'session-id'\r\n    @openModalView new ModelModal models: [session, player]\r\n\r\n  onMouseEnterPoint: (e) ->\r\n    pointID = $(e.target).data('pointid')\r\n    container = @$el.find(\".graph-point-info-container[data-pointid=#{pointID}]\").show()\r\n    margin = 20\r\n    width = container.outerWidth()\r\n    height = container.outerHeight()\r\n    container.css('left', e.offsetX - width / 2)\r\n    container.css('top', e.offsetY - height - margin)\r\n\r\n  onMouseLeavePoint: (e) ->\r\n    pointID = $(e.target).data('pointid')\r\n    @$el.find(\".graph-point-info-container[data-pointid=#{pointID}]\").hide()\r\n\r\n  onClickReplay: (e) ->\r\n    sessionID = $(e.target).closest('tr').data 'session-id'\r\n    url = \"/play/level/#{@level.get('slug')}?session=#{sessionID}&observing=true\"\r\n    window.open url, '_blank'\r\n\r\n  updateAnalyticsGraphData: ->\r\n    # console.log 'updateAnalyticsGraphData'\r\n    # Build graphs based on available @analytics data\r\n    # Currently only one graph\r\n    @analytics.graphs = [graphID: 'level-completions', lines: []]\r\n\r\n    # TODO: Where should this metadata live?\r\n    # TODO: lineIDs assumed to be unique across graphs\r\n    completionLineID = 'level-completions'\r\n    playtimeLineID = 'level-playtime'\r\n    helpsLineID = 'helps-clicked'\r\n    videosLineID = 'help-videos'\r\n    lineMetadata = {}\r\n    lineMetadata[completionLineID] =\r\n      description: 'Level Completion (%)'\r\n      color: 'red'\r\n    lineMetadata[playtimeLineID] =\r\n      description: 'Average Playtime (s)'\r\n      color: 'green'\r\n    lineMetadata[helpsLineID] =\r\n      description: 'Help click rate (%)'\r\n      color: 'blue'\r\n    lineMetadata[videosLineID] =\r\n      description: 'Help video rate (%)'\r\n      color: 'purple'\r\n\r\n    # Use this days aggregate to fill in missing days from the analytics data\r\n    days = {}\r\n    days[\"#{day.created[0..3]}-#{day.created[4..5]}-#{day.created[6..7]}\"] = true for day in @analytics.levelCompletions.data if @analytics?.levelCompletions?.data?\r\n    days[day.created] = true for day in @analytics.levelPlaytimes.data if @analytics?.levelPlaytimes?.data?\r\n    days[\"#{day.day[0..3]}-#{day.day[4..5]}-#{day.day[6..7]}\"] = true for day in @analytics.levelHelps.data if @analytics?.levelHelps?.data?\r\n    days = Object.keys(days).sort (a, b) -> if a < b then -1 else 1\r\n    if days.length > 0\r\n      currentIndex = 0\r\n      currentDay = days[currentIndex]\r\n      currentDate = new Date(currentDay + \"T00:00:00.000Z\")\r\n      lastDay = days[days.length - 1]\r\n      while currentDay isnt lastDay\r\n        days.splice currentIndex, 0, currentDay if days[currentIndex] isnt currentDay\r\n        currentIndex++\r\n        currentDate.setUTCDate(currentDate.getUTCDate() + 1)\r\n        currentDay = currentDate.toISOString().substr(0, 10)\r\n\r\n    # Update level completion graph data\r\n    dayStartedMap = {}\r\n    if @analytics?.levelCompletions?.data?.length > 0\r\n      # Build line data\r\n      levelPoints = []\r\n      for day, i in @analytics.levelCompletions.data\r\n        dayStartedMap[day.created] = day.started\r\n        rate = parseFloat(day.rate)\r\n        levelPoints.push\r\n          x: i\r\n          y: rate\r\n          started: day.started\r\n          day: \"#{day.created[0..3]}-#{day.created[4..5]}-#{day.created[6..7]}\"\r\n          pointID: \"#{completionLineID}#{i}\"\r\n          values: [\"Started: #{day.started}\", \"Finished: #{day.finished}\", \"Completion rate: #{rate.toFixed(2)}%\"]\r\n      # Ensure points for each day\r\n      for day, i in days\r\n        if levelPoints.length <= i or levelPoints[i].day isnt day\r\n          levelPoints.splice i, 0,\r\n            y: 0.0\r\n            day: day\r\n            values: []\r\n        levelPoints[i].x = i\r\n        levelPoints[i].pointID = \"#{completionLineID}#{i}\"\r\n      @analytics.graphs[0].lines.push\r\n        lineID: completionLineID\r\n        enabled: true\r\n        points: levelPoints\r\n        description: lineMetadata[completionLineID].description\r\n        lineColor: lineMetadata[completionLineID].color\r\n        min: 0\r\n        max: 100.0\r\n\r\n    # Update average playtime graph data\r\n    if @analytics?.levelPlaytimes?.data?.length > 0\r\n      # Build line data\r\n      playtimePoints = []\r\n      for day, i in @analytics.levelPlaytimes.data\r\n        avg = parseFloat(day.average)\r\n        playtimePoints.push\r\n          x: i\r\n          y: avg\r\n          day: day.created\r\n          pointID: \"#{playtimeLineID}#{i}\"\r\n          values: [\"Average playtime: #{avg.toFixed(2)}s\"]\r\n      # Ensure points for each day\r\n      for day, i in days\r\n        if playtimePoints.length <= i or playtimePoints[i].day isnt day\r\n          playtimePoints.splice i, 0,\r\n            y: 0.0\r\n            day: day\r\n            values: []\r\n        playtimePoints[i].x = i\r\n        playtimePoints[i].pointID = \"#{playtimeLineID}#{i}\"\r\n      @analytics.graphs[0].lines.push\r\n        lineID: playtimeLineID\r\n        enabled: true\r\n        points: playtimePoints\r\n        description: lineMetadata[playtimeLineID].description\r\n        lineColor: lineMetadata[playtimeLineID].color\r\n        min: 0\r\n        max: d3.max(playtimePoints, (d) -> d.y)\r\n\r\n    # Update help graph data\r\n    if @analytics?.levelHelps?.data?.length > 0\r\n      # Build line data\r\n      helpPoints = []\r\n      videoPoints = []\r\n      for day, i in @analytics.levelHelps.data\r\n        helpCount = day.alertHelps + day.paletteHelps\r\n        started = dayStartedMap[day.day] ? 0\r\n        clickRate = if started > 0 then helpCount / started * 100 else 0\r\n        videoRate = day.videoStarts / helpCount * 100\r\n        helpPoints.push\r\n          x: i\r\n          y: clickRate\r\n          day: \"#{day.day[0..3]}-#{day.day[4..5]}-#{day.day[6..7]}\"\r\n          pointID: \"#{helpsLineID}#{i}\"\r\n          values: [\"Helps clicked: #{helpCount}\", \"Helps click clickRate: #{clickRate.toFixed(2)}%\"]\r\n        videoPoints.push\r\n          x: i\r\n          y: videoRate\r\n          day: \"#{day.day[0..3]}-#{day.day[4..5]}-#{day.day[6..7]}\"\r\n          pointID: \"#{videosLineID}#{i}\"\r\n          values: [\"Help videos started: #{day.videoStarts}\", \"Help videos start rate: #{videoRate.toFixed(2)}%\"]\r\n      # Ensure points for each day\r\n      for day, i in days\r\n        if helpPoints.length <= i or helpPoints[i].day isnt day\r\n          helpPoints.splice i, 0,\r\n            y: 0.0\r\n            day: day\r\n            values: []\r\n        helpPoints[i].x = i\r\n        helpPoints[i].pointID = \"#{helpsLineID}#{i}\"\r\n        if videoPoints.length <= i or videoPoints[i].day isnt day\r\n          videoPoints.splice i, 0,\r\n            y: 0.0\r\n            day: day\r\n            values: []\r\n        videoPoints[i].x = i\r\n        videoPoints[i].pointID = \"#{videosLineID}#{i}\"\r\n      if d3.max(helpPoints, (d) -> d.y) > 0\r\n        @analytics.graphs[0].lines.push\r\n          lineID: helpsLineID\r\n          enabled: true\r\n          points: helpPoints\r\n          description: lineMetadata[helpsLineID].description\r\n          lineColor: lineMetadata[helpsLineID].color\r\n          min: 0\r\n          max: 100.0\r\n      if d3.max(videoPoints, (d) -> d.y) > 0\r\n        @analytics.graphs[0].lines.push\r\n          lineID: videosLineID\r\n          enabled: true\r\n          points: videoPoints\r\n          description: lineMetadata[videosLineID].description\r\n          lineColor: lineMetadata[videosLineID].color\r\n          min: 0\r\n          max: 100.0\r\n\r\n  updateAnalyticsGraphs: ->\r\n    # Build d3 graphs\r\n    return unless @analytics?.graphs?.length > 0\r\n    containerSelector = '.line-graph-container'\r\n    # console.log 'updateAnalyticsGraphs', containerSelector, @analytics.graphs\r\n\r\n    margin = 20\r\n    keyHeight = 20\r\n    xAxisHeight = 20\r\n    yAxisWidth = 40\r\n    containerWidth = $(containerSelector).width()\r\n    containerHeight = $(containerSelector).height()\r\n\r\n    for graph in @analytics.graphs\r\n      graphLineCount = _.reduce graph.lines, ((sum, item) -> if item.enabled then sum + 1 else sum), 0\r\n      svg = d3.select(containerSelector).append(\"svg\")\r\n        .attr(\"width\", containerWidth)\r\n        .attr(\"height\", containerHeight)\r\n      width = containerWidth - margin * 2 - yAxisWidth * graphLineCount\r\n      height = containerHeight - margin * 2 - xAxisHeight - keyHeight * graphLineCount\r\n      currentLine = 0\r\n      for line in graph.lines\r\n        continue unless line.enabled\r\n        xRange = d3.scale.linear().range([0, width]).domain([d3.min(line.points, (d) -> d.x), d3.max(line.points, (d) -> d.x)])\r\n        yRange = d3.scale.linear().range([height, 0]).domain([line.min, line.max])\r\n\r\n        # x-Axis and guideline once\r\n        if currentLine is 0\r\n          startDay = new Date(line.points[0].day)\r\n          endDay = new Date(line.points[line.points.length - 1].day)\r\n          xAxisRange = d3.time.scale()\r\n            .domain([startDay, endDay])\r\n            .range([0, width])\r\n          xAxis = d3.svg.axis()\r\n            .scale(xAxisRange)\r\n          svg.append(\"g\")\r\n            .attr(\"class\", \"x axis\")\r\n            .call(xAxis)\r\n            .selectAll(\"text\")\r\n            .attr(\"dy\", \".35em\")\r\n            .attr(\"transform\", \"translate(\" + (margin + yAxisWidth * (graphLineCount - 1)) + \",\" + (height + margin) + \")\")\r\n            .style(\"text-anchor\", \"start\")\r\n\r\n          # Horizontal guidelines\r\n          svg.selectAll(\".line\")\r\n            .data([10, 30, 50, 70, 90])\r\n            .enter()\r\n            .append(\"line\")\r\n            .attr(\"x1\", margin + yAxisWidth * graphLineCount)\r\n            .attr(\"y1\", (d) -> margin + yRange(d))\r\n            .attr(\"x2\", margin + yAxisWidth * graphLineCount + width)\r\n            .attr(\"y2\", (d) -> margin + yRange(d))\r\n            .attr(\"stroke\", line.lineColor)\r\n            .style(\"opacity\", \"0.5\")\r\n\r\n        # y-Axis\r\n        yAxisRange = d3.scale.linear().range([height, 0]).domain([line.min, line.max])\r\n        yAxis = d3.svg.axis()\r\n          .scale(yRange)\r\n          .orient(\"left\")\r\n        svg.append(\"g\")\r\n          .attr(\"class\", \"y axis\")\r\n          .attr(\"transform\", \"translate(\" + (margin + yAxisWidth * currentLine) + \",\" + margin + \")\")\r\n          .style(\"color\", line.lineColor)\r\n          .call(yAxis)\r\n          .selectAll(\"text\")\r\n          .attr(\"y\", 0)\r\n          .attr(\"x\", 0)\r\n          .attr(\"fill\", line.lineColor)\r\n          .style(\"text-anchor\", \"start\")\r\n\r\n        # Key\r\n        svg.append(\"line\")\r\n          .attr(\"x1\", margin)\r\n          .attr(\"y1\", margin + height + xAxisHeight + keyHeight * currentLine + keyHeight / 2)\r\n          .attr(\"x2\", margin + 40)\r\n          .attr(\"y2\", margin + height + xAxisHeight + keyHeight * currentLine + keyHeight / 2)\r\n          .attr(\"stroke\", line.lineColor)\r\n          .attr(\"class\", \"key-line\")\r\n        svg.append(\"text\")\r\n          .attr(\"x\", margin + 40 + 10)\r\n          .attr(\"y\", margin + height + xAxisHeight + keyHeight * currentLine + (keyHeight + 10) / 2)\r\n          .attr(\"fill\", line.lineColor)\r\n          .attr(\"class\", \"key-text\")\r\n          .text(line.description)\r\n\r\n        # Path and points\r\n        svg.selectAll(\".circle\")\r\n          .data(line.points)\r\n          .enter()\r\n          .append(\"circle\")\r\n          .attr(\"transform\", \"translate(\" + (margin + yAxisWidth * graphLineCount) + \",\" + margin + \")\")\r\n          .attr(\"cx\", (d) -> xRange(d.x))\r\n          .attr(\"cy\", (d) -> yRange(d.y))\r\n          .attr(\"r\", (d) -> if d.started then Math.max(3, Math.min(10, Math.log(parseInt(d.started)))) + 2 else 6)\r\n          .attr(\"fill\", line.lineColor)\r\n          .attr(\"stroke-width\", 1)\r\n          .attr(\"class\", \"graph-point\")\r\n          .attr(\"data-pointid\", (d) -> \"#{line.lineID}#{d.x}\")\r\n        d3line = d3.svg.line()\r\n          .x((d) -> xRange(d.x))\r\n          .y((d) -> yRange(d.y))\r\n          .interpolate(\"linear\")\r\n        svg.append(\"path\")\r\n          .attr(\"d\", d3line(line.points))\r\n          .attr(\"transform\", \"translate(\" + (margin + yAxisWidth * graphLineCount) + \",\" + margin + \")\")\r\n          .style(\"stroke-width\", 1)\r\n          .style(\"stroke\", line.lineColor)\r\n          .style(\"fill\", \"none\")\r\n        currentLine++\r\n\r\n  getAnalytics: (startDay, endDay) =>\r\n    # Analytics APIs use 2 different day formats\r\n    if startDay?\r\n      startDayDashed = startDay\r\n      startDay = startDay.replace(/-/g, '')\r\n    else\r\n      startDay = utils.getUTCDay -14\r\n      startDayDashed = \"#{startDay[0..3]}-#{startDay[4..5]}-#{startDay[6..7]}\"\r\n    if endDay?\r\n      endDayDashed = endDay\r\n      endDay = endDay.replace(/-/g, '')\r\n    else\r\n      endDay = utils.getUTCDay -1\r\n      endDayDashed = \"#{endDay[0..3]}-#{endDay[4..5]}-#{endDay[6..7]}\"\r\n\r\n    # Initialize\r\n    @analytics =\r\n      startDay: startDayDashed\r\n      endDay: endDayDashed\r\n      commonProblems: {data: [], loading: true}\r\n      levelCompletions: {data: [], loading: true}\r\n      levelHelps: {data: [], loading: true}\r\n      levelPlaytimes: {data: [], loading: true}\r\n      recentSessions: {data: [], loading: true}\r\n      graphs: []\r\n    @render() # Hide old analytics data while we fetch new data\r\n\r\n    makeFinishDataFetch = (data) =>\r\n      return =>\r\n        return if @destroyed\r\n        @updateAnalyticsGraphData()\r\n        data.loading = false\r\n        @render()\r\n    @getCommonLevelProblems startDayDashed, endDayDashed, makeFinishDataFetch(@analytics.commonProblems)\r\n    @getLevelCompletions startDay, endDay, makeFinishDataFetch(@analytics.levelCompletions)\r\n    @getLevelHelps startDay, endDay, makeFinishDataFetch(@analytics.levelHelps)\r\n    @getLevelPlaytimes startDayDashed, endDayDashed, makeFinishDataFetch(@analytics.levelPlaytimes)\r\n    @getRecentSessions makeFinishDataFetch(@analytics.recentSessions)\r\n\r\n  getCommonLevelProblems: (startDay, endDay, doneCallback) ->\r\n    success = (data) =>\r\n      return doneCallback() if @destroyed\r\n      # console.log 'getCommonLevelProblems', data\r\n      @analytics.commonProblems.data = data\r\n      doneCallback()\r\n    request = @supermodel.addRequestResource 'common_problems', {\r\n      url: '/db/user.code.problem/-/common_problems'\r\n      data: {startDay: startDay, endDay: endDay, slug: @levelSlug}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n\r\n  getLevelCompletions: (startDay, endDay, doneCallback) ->\r\n    success = (data) =>\r\n      return doneCallback() if @destroyed\r\n      # console.log 'getLevelCompletions', data\r\n      data.sort (a, b) -> if a.created < b.created then -1 else 1\r\n      mapFn = (item) ->\r\n        item.rate = if item.started > 0 then item.finished / item.started * 100 else 0\r\n        item\r\n      @analytics.levelCompletions.data = _.map data, mapFn, @\r\n      doneCallback()\r\n    request = @supermodel.addRequestResource 'level_completions', {\r\n      url: '/db/analytics_perday/-/level_completions'\r\n      data: {startDay: startDay, endDay: endDay, slug: @levelSlug}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n\r\n  getLevelHelps: (startDay, endDay, doneCallback) ->\r\n    success = (data) =>\r\n      return doneCallback() if @destroyed\r\n      # console.log 'getLevelHelps', data\r\n      @analytics.levelHelps.data = data.sort (a, b) -> if a.day < b.day then -1 else 1\r\n      doneCallback()\r\n    request = @supermodel.addRequestResource 'level_helps', {\r\n      url: '/db/analytics_perday/-/level_helps'\r\n      data: {startDay: startDay, endDay: endDay, slugs: [@levelSlug]}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n\r\n  getLevelPlaytimes: (startDay, endDay, doneCallback) ->\r\n    success = (data) =>\r\n      return doneCallback() if @destroyed\r\n      # console.log 'getLevelPlaytimes', data\r\n      @analytics.levelPlaytimes.data = data.sort (a, b) -> if a.created < b.created then -1 else 1\r\n      doneCallback()\r\n    request = @supermodel.addRequestResource 'playtime_averages', {\r\n      url: '/db/level/-/playtime_averages'\r\n      data: {startDay: startDay, endDay: endDay, slugs: [@levelSlug]}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n\r\n  getRecentSessions: (doneCallback) ->\r\n    limit = 100\r\n    success = (data) =>\r\n      return doneCallback() if @destroyed\r\n      # console.log 'getRecentSessions', data\r\n      @analytics.recentSessions.data = data\r\n      doneCallback()\r\n    request = @supermodel.addRequestResource 'level_sessions_recent', {\r\n      url: \"/db/level.session/-/recent\"\r\n      data: {slug: @levelSlug, limit: limit}\r\n      method: 'POST'\r\n      success: success\r\n    }, 0\r\n    request.load()\r\n"]}