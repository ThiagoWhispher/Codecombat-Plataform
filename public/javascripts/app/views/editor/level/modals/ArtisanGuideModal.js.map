{"version":3,"sources":["app/views/editor/level/modals/ArtisanGuideModal.coffee"],"names":[],"mappings":";AAAA;EAAA;;;AAAA,YAAY,QAAQ,sBAAR;;AACZ,WAAW,QAAQ,kDAAR;;AAEX,QAAQ,QAAQ,YAAR;;AACP,qBAAsB,QAAQ,cAAR,EAAtB;;AAED,gBACE;EAAA,sBAAsB,KAAtB;EACA,UAAU,CAAC,YAAD,EAAe,cAAf,EAA+B,kBAA/B,EAAmD,eAAnD,CADV;EAEA,YACE;IAAA,YACE;MAAA,MAAM,QAAN;KADF;IAEA,cACE;MAAA,MAAM,QAAN;KAHF;IAIA,kBACE;MAAA,MAAM,QAAN;KALF;IAMA,eACE;MAAA,MAAM,QAAN;KAPF;GAHF;;;AAYF,MAAM,CAAC,OAAP,GAAuB;;;;;;;8BACrB,KAAI;;8BACJ,WAAU;;8BACV,SACE;IAAA,uBAAuB,aAAvB;;;8BAEF,aAAY,SAAC,OAAD;IACV,IAAC,MAAD,GAAS,OAAO,CAAC;WACjB,IAAC,QAAD,GACE;MAAA,OAAM,IAAC,MAAK,CAAC,GAAP,CAAW,MAAX,CAAN;MACA,WAAU,IAAC,MAAK,CAAC,GAAP,CAAW,MAAX,CADV;;EAHQ;;8BAMZ,cAAa;AACX;IAAA,IAAC,UAAD,CAAW,mBAAX;IACA,KAAK,CAAC,eAAN,CAAsB,IAAC,IAAvB;IACA,UAAU,KAAK,CAAC,YAAN,CAAmB,IAAC,IAApB;IACV,MAAM,GAAG,CAAC,gBAAJ,CAAqB,OAArB,EAA8B,aAA9B;IACN,KAAuD,GAAG,CAAC,KAA3D;AAAA,aAAO,KAAK,CAAC,iBAAN,CAAwB,IAAC,IAAzB,EAA8B,GAAG,CAAC,MAAlC,EAAP;;IACA,iBAAiB;MAAC,SAAQ,gBAAgB,OAAO,CAAC,UAAxB,GAAmC,wDAAnC,GAC6B,IAAC,QAAO,CAAC,SADtC,GACgD,KADhD,GACoD,IAAC,QAAO,CAAC,KAD7D,GACmE,iBADnE,GAEb,OAAO,CAAC,YAFK,GAEQ,iBAFR,GAGT,OAAO,CAAC,gBAHC,GAGgB,cAHhB,GAIZ,OAAO,CAAC,aAJL;;IAKjB,IAAC,oBAAD,CAAqB,cAArB;IACA,iBAAiB,CAAC,CAAC,KAAF,CAAQ,cAAR,EAAwB,IAAC,QAAzB;IACjB,cAAc,CAAC,OAAf,GAAyB,EAAE,CAAC,GAAH,CAAO,SAAP;IACzB,mBAAmB,cAAnB,EAAmC,IAAC,IAApC;WACA,CAAC,CAAC,IAAF,CAAO,cAAY,EAAE,CAAC,EAAf,GAAkB,2BAAzB;EAfW;;8BAiBb,sBAAqB,SAAC,OAAD;AACnB;IAAA,IAAG,CAAC,CAAC,OAAL;MACE,OAAO,CAAC,OAAR,GAAqB,CAAC,CAAC,OAAO,CAAC,QAAX,GAAoB,GAApB,GAAuB,CAAC,CAAC,OAAO,CAAC,IAAjC,GAAsC,GAAtC,GAAyC,CAAC,CAAC,OAAO,CAAC,cADzE;;IAEA,OAAO,CAAC,UAAR,GAAuB,kGAAiB,EAAE,MAAF,CAAS,CAAC,KAAV,EAAjB,IAAmC,KAAnC,GAAuC,qGAAkB,EAAE,MAAF,CAAS,CAAC,MAAV,EAAlB;WAC9D,OAAO,CAAC,aAAR,GAAwB,IAAC;EAJN;;8BAMrB,eAAc;IACZ,IAAG,IAAC,MAAK,CAAC,QAAP,OAAqB,EAAE,CAAC,EAA3B;AACE,aAAO,KADT;;AAEA,WAAO;EAHK;;;;GAnCiC","file":"public/javascripts/app/views/editor/level/modals/ArtisanGuideModal.js","sourcesContent":["ModalView = require 'views/core/ModalView'\r\ntemplate = require 'templates/editor/level/modal/artisan-guide-modal'\r\n\r\nforms = require 'core/forms'\r\n{sendContactMessage} = require 'core/contact'\r\n\r\ncontactSchema =\r\n  additionalProperties: false\r\n  required: ['creditName', 'levelPurpose', 'levelInspiration', 'levelLocation']\r\n  properties:\r\n    creditName:\r\n      type: 'string'\r\n    levelPurpose:\r\n      type: 'string'\r\n    levelInspiration:\r\n      type: 'string'\r\n    levelLocation:\r\n      type: 'string'\r\n\r\nmodule.exports = class ArtisanGuideModal extends ModalView\r\n  id: 'artisan-guide-modal'\r\n  template: template\r\n  events:\r\n    'click #level-submit': 'levelSubmit'\r\n\r\n  initialize: (options) ->\r\n    @level = options.level\r\n    @options = \r\n      level:@level.get('name')\r\n      levelSlug:@level.get('slug')\r\n\r\n  levelSubmit: ->\r\n    @playSound 'menu-button-click'\r\n    forms.clearFormAlerts @$el\r\n    results = forms.formToObject @$el\r\n    res = tv4.validateMultiple results, contactSchema\r\n    return forms.applyErrorsToForm @$el, res.errors unless res.valid\r\n    contactMessage = {message:\"\"\"User Name: #{results.creditName}\r\n      Level: <a href=\"http://codecombat.com/editor/level/#{@options.levelSlug}\">#{@options.level}</a>\r\n      Purpose: #{results.levelPurpose}\r\n      Inspiration: #{results.levelInspiration}\r\n      Location: #{results.levelLocation}\"\"\"}\r\n    @populateBrowserData contactMessage\r\n    contactMessage = _.merge contactMessage, @options\r\n    contactMessage.country = me.get('country')\r\n    sendContactMessage contactMessage, @$el\r\n    $.post \"/db/user/#{me.id}/track/contact_codecombat\"\r\n\r\n  populateBrowserData: (context) ->\r\n    if $.browser\r\n      context.browser = \"#{$.browser.platform} #{$.browser.name} #{$.browser.versionNumber}\"\r\n    context.screenSize = \"#{screen?.width ? $(window).width()} x #{screen?.height ? $(window).height()}\"\r\n    context.screenshotURL = @screenshotURL\r\n\r\n  hasOwnership: ->\r\n    if @level.getOwner() is me.id\r\n      return true\r\n    return false"]}