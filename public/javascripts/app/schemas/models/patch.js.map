{"version":3,"sources":["app/schemas/models/patch.coffee"],"names":[],"mappings":";AAAA;;AAAA,IAAI,QAAQ,cAAR;;AAEJ,aAAa,CACX,aADW,EAEX,SAFW,EAGX,UAHW,EAIX,QAJW,EAKX,OALW,EAMX,iBANW,EAOX,cAPW,EAQX,MARW,EASX,YATW;;AAYb,cAAc,CAAC,CAAC,MAAF,CAAS;EAAC,OAAO,OAAR;EAAiB,UAAU,CAAC,QAAD,EAAW,OAAX,EAAoB,eAApB,CAA3B;CAAT,EAA2E;EACvF,OAAO;IAAC,OAAO,OAAR;IAAiB,MAAM,CAAC,OAAD,EAAU,QAAV,CAAvB;GADgF;EAEvF,eAAe,CAAC,CAAC,WAAF,CAAc;IAAC,WAAW,GAAZ;IAAiB,WAAW,CAA5B;GAAd,CAFwE;EAGvF,SAAS,CAAC,CAAC,QAAF,CAAW;IAAA,OAAO;MAAC;QAAC,KAAK,OAAN;QAAe,MAAM,gBAArB;OAAD;KAAP;GAAX,CAH8E;EAIvF,UAAU,CAAC,CAAC,QAAF,CAAW;IAAA,OAAO;MAAC;QAAC,KAAK,OAAN;QAAe,MAAM,gBAArB;OAAD;KAAP;GAAX,CAJ6E;EAKvF,SAAS,CAAC,CAAC,IAAF,CAAO;IAAC,OAAO,SAAR;IAAmB,UAAU,IAA7B;GAAP,CAL8E;EAMvF,QAAQ;IAAC,QAAM,CAAC,SAAD,EAAY,UAAZ,EAAwB,UAAxB,EAAoC,WAApC,CAAP;GAN+E;EAQvF,QAAQ,CAAC,CAAC,MAAF,CAAS;IAAC,OAAO,QAAR;IAAkB,UAAU,CAAC,YAAD,EAAe,IAAf,CAA5B;GAAT,EAA4D;IAClE,YAAY;MAAC,QAAM,UAAP;KADsD;IAElE,IAAI,CAAC,CAAC,QAAF,CAAW;MAAA,OAAO,WAAP;KAAX,CAF8D;IAKlE,UAAU,CAAC,CAAC,QAAF,CAAW;MAAA,OAAO,iBAAP;KAAX,CALwD;IAMlE,SACE;MAAA,YACE;QAAA,OAAO;UAAC,MAAM,QAAP;UAAiB,SAAS,CAA1B;SAAP;QACA,OAAO;UAAC,MAAM,QAAP;UAAiB,SAAS,CAA1B;SADP;OADF;KAPgE;GAA5D,CAR+E;EAoBvF,YAAY;IAAA,MAAM,SAAN;GApB2E;EAqBvF,eAAe;IAAA,MAAM,SAAN;GArBwE;EAsBvF,uBAAuB;IAAE,MAAM,QAAR;GAtBgE;CAA3E;;AAyBd,CAAC,CAAC,qBAAF,CAAwB,WAAxB,EAAqC,OAArC;;AAEA,MAAM,CAAC,OAAP,GAAiB","file":"public/javascripts/app/schemas/models/patch.js","sourcesContent":["c = require './../schemas'\r\n\r\npatchables = [\r\n  'achievement'\r\n  'article'\r\n  'campaign'\r\n  'course'\r\n  'level'\r\n  'level_component'\r\n  'level_system' \r\n  'poll'\r\n  'thang_type'\r\n]\r\n\r\nPatchSchema = c.object({title: 'Patch', required: ['target', 'delta', 'commitMessage']}, {\r\n  delta: {title: 'Delta', type: ['array', 'object']}\r\n  commitMessage: c.shortString({maxLength: 500, minLength: 1})\r\n  creator: c.objectId(links: [{rel: 'extra', href: '/db/user/{($)}'}])\r\n  acceptor: c.objectId(links: [{rel: 'extra', href: '/db/user/{($)}'}])\r\n  created: c.date({title: 'Created', readOnly: true})\r\n  status: {enum: ['pending', 'accepted', 'rejected', 'withdrawn']}\r\n\r\n  target: c.object({title: 'Target', required: ['collection', 'id']}, {\r\n    collection: {enum: patchables}\r\n    id: c.objectId(title: 'Target ID') # search by this if not versioned\r\n\r\n  # if target is versioned, want to know that info too\r\n    original: c.objectId(title: 'Target Original') # search by this if versioned\r\n    version:\r\n      properties:\r\n        major: {type: 'number', minimum: 0}\r\n        minor: {type: 'number', minimum: 0}\r\n  })\r\n\r\n  wasPending: type: 'boolean'\r\n  newlyAccepted: type: 'boolean'\r\n  reasonNotAutoAccepted: { type: 'string' }\r\n})\r\n\r\nc.extendBasicProperties(PatchSchema, 'patch')\r\n\r\nmodule.exports = PatchSchema\r\n"]}