{"version":3,"sources":["app/schemas/models/level_system.coffee"],"names":[],"mappings":";AAAA;;AAAA,IAAI,QAAQ,cAAR;;AACJ,aAAa,QAAQ,iBAAR;;AAEb,mBAAmB;;AAiBnB,mBAAmB,CAAC,CAAC,MAAF,CAAS;EAC1B,OAAO,mBADmB;EAE1B,aAAa,0CAFa;EAG1B,UAAU,CAAC,UAAD,EAAa,cAAb,CAHgB;EAI1B,QAAQ,0BAJkB;EAK1B,OAAO;IAAC;MAAC,KAAK,IAAN;MAAY,MAAM,wDAAlB;KAAD;GALmB;CAAT,EAOjB;EAAA,UAAU,CAAC,CAAC,QAAF,CAAW;IAAA,OAAO,UAAP;IAAmB,aAAa,+DAAhC;GAAX,CAAV;EACA,cACE;IAAA,OAAO,eAAP;IACA,aAAa,sDADb;IAEA,MAAM,SAFN;IAGA,SAAS,CAHT;GAFF;CAPiB;;AAcnB,oBAAoB,CAAC,CAAC,MAAF,CAAS;EAC3B,OAAO,QADoB;EAE3B,aAAa,2CAFc;EAG3B,UAAU,CAAC,MAAD,EAAS,MAAT,CAHiB;EAI3B,WACE;IAAA,MAAM,cAAN;IACA,aAAa,2DADb;IAEA,MAAM,gBAFN;IAGA,cAAc,cAHd;IAIA,cAAc,EAJd;IAKA,cAAc,EALd;GALyB;CAAT;;AAYpB,CAAC,CAAC,qBAAF,CAAwB,iBAAxB;;AACA,iBAAiB,CAAC,UAAU,CAAC,IAAI,CAAC,OAAlC,GAA4C,CAAC,CAAC;;AAC9C,CAAC,CAAC,MAAF,CAAS,iBAAiB,CAAC,UAA3B,EACE;EAAA,aACE;IAAA,OAAO,aAAP;IACA,aAAa,+CADb;IAEA,MAAM,QAFN;IAGA,WAAW,IAHX;GADF;EAKA,cACE;IAAA,MAAM,QAAN;IACA,OAAO,UADP;IAEA,aAAa,uDAFb;IAGA,QAAQ,CAAC,cAAD,CAHR;GANF;EAUA,MACE;IAAA,OAAO,MAAP;IACA,aAAa,4GADb;IAEA,MAAM,QAFN;IAGA,QAAQ,QAHR;GAXF;EAeA,IACE;IAAA,OAAO,YAAP;IACA,aAAa,gDADb;IAEA,MAAM,QAFN;IAGA,QAAQ,QAHR;GAhBF;EAoBA,cAAc,CAAC,CAAC,KAAF,CAAQ;IAAC,OAAO,cAAR;IAAwB,aAAa,qDAArC;IAA4F,aAAa,IAAzG;GAAR,EAAwH,gBAAxH,CApBd;EAqBA,cAAc,CAAC,CAAC,MAAF,CAAS,UAAT,EAAqB;IAAC,OAAO,sBAAR;IAAgC,aAAa,2FAA7C;IAA0I,WAAS;MAAC,MAAM,QAAP;MAAiB,sBAAsB,KAAvC;KAAnJ;GAArB,CArBd;EAsBA,UACE;IAAA,MAAM,SAAN;IACA,OAAO,UADP;IAEA,aAAa,gDAFb;GAvBF;CADF;;AA4BA,CAAC,CAAC,qBAAF,CAAwB,iBAAxB,EAA2C,cAA3C;;AACA,CAAC,CAAC,0BAAF,CAA6B,iBAA7B;;AACA,CAAC,CAAC,yBAAF,CAA4B,iBAA5B,EAA+C,cAA/C;;AACA,CAAC,CAAC,2BAAF,CAA8B,iBAA9B;;AACA,CAAC,CAAC,yBAAF,CAA4B,iBAA5B;;AAEA,MAAM,CAAC,OAAP,GAAiB","file":"public/javascripts/app/schemas/models/level_system.js","sourcesContent":["c = require './../schemas'\r\nmetaschema = require './../metaschema'\r\n\r\njitterSystemCode = \"\"\"\r\nclass Jitter extends System\r\n  constructor: (world, config) ->\r\n    super world, config\r\n    @idlers = @addRegistry (thang) -> thang.exists and thang.acts and thang.moves and thang.action is 'idle'\r\n\r\n  update: ->\r\n    # We return a simple numeric hash that will combine to a frame hash\r\n    # help us determine whether this frame has changed in resimulations.\r\n    hash = 0\r\n    for thang in @idlers\r\n      hash += thang.pos.x += 0.5 - Math.random()\r\n      hash += thang.pos.y += 0.5 - Math.random()\r\n      thang.hasMoved = true\r\n    return hash\r\n\"\"\"\r\n\r\nDependencySchema = c.object {\r\n  title: 'System Dependency'\r\n  description: 'A System upon which this System depends.'\r\n  required: ['original', 'majorVersion']\r\n  format: 'latest-version-reference'\r\n  links: [{rel: 'db', href: '/db/level.system/{(original)}/version/{(majorVersion)}'}]\r\n},\r\n  original: c.objectId(title: 'Original', description: 'A reference to another System upon which this System depends.')\r\n  majorVersion:\r\n    title: 'Major Version'\r\n    description: 'Which major version of the System this System needs.'\r\n    type: 'integer'\r\n    minimum: 0\r\n\r\nLevelSystemSchema = c.object {\r\n  title: 'System'\r\n  description: 'A System which can affect Level behavior.'\r\n  required: ['name', 'code']\r\n  default:\r\n    name: 'JitterSystem'\r\n    description: 'This System makes all idle, movable Thangs jitter around.'\r\n    code: jitterSystemCode\r\n    codeLanguage: 'coffeescript'\r\n    dependencies: []  # TODO: should depend on something by default\r\n    configSchema: {}\r\n}\r\nc.extendNamedProperties LevelSystemSchema  # let's have the name be the first property\r\nLevelSystemSchema.properties.name.pattern = c.classNamePattern\r\n_.extend LevelSystemSchema.properties,\r\n  description:\r\n    title: 'Description'\r\n    description: 'A short explanation of what this System does.'\r\n    type: 'string'\r\n    maxLength: 2000\r\n  codeLanguage:\r\n    type: 'string'\r\n    title: 'Language'\r\n    description: 'Which programming language this System is written in.'\r\n    'enum': ['coffeescript']\r\n  code:\r\n    title: 'Code'\r\n    description: 'The code for this System, as a CoffeeScript class. TODO: add link to documentation for how to write these.'\r\n    type: 'string'\r\n    format: 'coffee'\r\n  js:\r\n    title: 'JavaScript'\r\n    description: 'The transpiled JavaScript code for this System'\r\n    type: 'string'\r\n    format: 'hidden'\r\n  dependencies: c.array {title: 'Dependencies', description: 'An array of Systems upon which this System depends.', uniqueItems: true}, DependencySchema\r\n  configSchema: _.extend metaschema, {title: 'Configuration Schema', description: 'A schema for validating the arguments that can be passed to this System as configuration.', default: {type: 'object', additionalProperties: false}}\r\n  official:\r\n    type: 'boolean'\r\n    title: 'Official'\r\n    description: 'Whether this is an official CodeCombat System.'\r\n\r\nc.extendBasicProperties LevelSystemSchema, 'level.system'\r\nc.extendSearchableProperties LevelSystemSchema\r\nc.extendVersionedProperties LevelSystemSchema, 'level.system'\r\nc.extendPermissionsProperties LevelSystemSchema\r\nc.extendPatchableProperties LevelSystemSchema\r\n\r\nmodule.exports = LevelSystemSchema\r\n"]}